"use strict";(self.webpackChunktradingview=self.webpackChunktradingview||[]).push([[97610],{304986:(e,t,o)=>{o.d(t,{getThemeFromUserSettings:()=>r,saveThemeInUserSettings:()=>a});var n=o(62802),i=o(278855);function r(){return(0,i.getThemeFromCookie)()||(0,n.getValue)("current_theme.name")||null}function a(e){(0,i.setThemeToCookie)(e),(0,n.setValue)("current_theme.name",e,{forceFlush:!0})}},429874:(e,t,o)=>{o.r(t),o.d(t,{DEFAULT_THEME:()=>s.DEFAULT_THEME,extractThemeFromModel:()=>P,getCurrentTheme:()=>h,getStdTheme:()=>A,getStdThemeNames:()=>f,getStdThemedValue:()=>T,getTheme:()=>y,getThemeNames:()=>b,getThemedColor:()=>p,isPublicTheme:()=>d,isStdTheme:()=>N,isStdThemeName:()=>w,isStdThemedDefaultValue:()=>M,isThemeExist:()=>C,loadTheme:()=>m,removeTheme:()=>E,restoreTheme:()=>g,saveTheme:()=>_,savedThemeName:()=>v,syncTheme:()=>S,themes:()=>u.themes,translateStdThemeName:()=>k});var n=o(724377),i=o(42292),r=o(304986);const a=o(787703);var l=o(919346),c=o(331633),s=o(484400),u=o(750285);function d(e){return!e.isPrivate}function h(){return u.themes[c.watchedTheme.value()]||u.themes[s.DEFAULT_THEME]}function p(e){return h().getThemedColor(e)}async function m(e,t){const{themeName:o,standardTheme:n,syncState:r=!0,noUndo:a=!1,applyOverrides:l=!1,onlyActiveChart:c=!1}=t,s=await(n?Promise.resolve(A(o)):y(o)),u=!n;if(void 0!==s.content){const t=!n||c;l&&(void 0!==(d=s.content).chartProperties&&(0,i.applyDefaultsOverrides)(d.chartProperties),void 0!==d.mainSourceProperties&&(0,i.applyDefaultsOverrides)(d.mainSourceProperties,void 0,!0,"mainSeriesProperties")),await e.applyTheme({theme:s.content,onlyActiveChart:t,restoreNonThemeDefaults:u,themeName:o,standardTheme:n,syncState:r,noUndo:a})}var d;return s}function g(){(0,c.setTheme)((0,r.getThemeFromUserSettings)()||s.DEFAULT_THEME)}function v(){return(0,r.getThemeFromUserSettings)()}function S(){(0,r.saveThemeInUserSettings)(h().name)}function y(e){return a.loadTheme(e)}function b(){return a.loadThemes()}function f(){return l.getStdThemeNames()}function w(e){return f().includes(e)}function A(e){return l.getStdChartTheme(e)||{content:void 0}}function T(e,t){const o=t||h().name,n=l.getStdChartTheme(o),i=0!==e.length&&e.split(".");return n&&n.content&&i?i.reduce(((e,t)=>e[t]),n.content):null}function M(e,t,o){const i=T(e,o);return null!==i&&(0,n.areEqualRgba)((0,n.parseRgba)(i),(0,n.parseRgba)(String(t)))}function _(e,t){return a.saveTheme(e,t)}function E(e){return a.removeTheme(e)}function C(e){return a.isThemeExist(e)}function k(e){return l.translateThemeName(e)}function N(e){return l.isStdTheme(e)}function P(e){return{content:{chartProperties:{paneProperties:e.model().properties().childs().paneProperties.state(),scalesProperties:e.model().properties().childs().scalesProperties.state()},sessions:e.model().sessions().properties().state(),mainSourceProperties:e.model().mainSeries().properties().state(),version:e.model().version()}}}},72368:(e,t,o)=>{o.d(t,{canShowNewSymbolSearch:()=>c,getCurrentLocaleInfoCountry:()=>s,isMobile:()=>a,isPlatformMobile:()=>l})
;var n=o(314802),i=o(244842),r=o(638456);function a(){const e=window.matchMedia("(min-width: 602px) and (min-height: 445px)").matches;return r.CheckMobile.any()&&!e}function l(){return!(0,n.isOnMobileAppPage)("any")&&a()}function c(){return!i.enabled("widget")&&!(0,n.isOnMobileAppPage)("any")}function s(){var e,t;return null===(t=null===(e=window.initData)||void 0===e?void 0:e.currentLocaleInfo)||void 0===t?void 0:t.flag.toUpperCase()}},515828:(e,t,o)=>{o.d(t,{MINDS_GROUP_PATH_PATTERN:()=>n,mindsPathToGroup:()=>i});const n="/minds/groups/:symbol/";function i(e){return n.replace(":symbol",encodeURIComponent(e))}},951713:(e,t,o)=>{o.d(t,{getHideOptions:()=>u,getSavedHideMode:()=>h,toggleHideMode:()=>d});var n=o(650151),i=o(444372),r=o(62802),a=o(439016),l=o(885482),c=o(597101);let s=null;function u(){if(null!==s)return s;const e=(0,a.tradingService)();return s=new Map([["drawings",{label:i.t(null,void 0,o(413277)),dataName:"hide-drawing-tools",tooltip:{active:i.t(null,void 0,o(998116)),inactive:i.t(null,void 0,o(895551))},getBoxedValue:()=>(0,l.hideAllDrawings)(),trackLabel:"hide drawings"}],["indicators",{label:i.t(null,void 0,o(44177)),dataName:"hide-indicators",tooltip:{active:i.t(null,void 0,o(249982)),inactive:i.t(null,void 0,o(986306))},getBoxedValue:()=>(0,l.hideAllIndicators)(),trackLabel:"hide indicators"}],["positions",{label:i.t(null,void 0,o(190540)),dataName:"hide-positions-and-orders",tooltip:{active:i.t(null,void 0,o(262632)),inactive:i.t(null,void 0,o(770803))},getBoxedValue:()=>(0,n.ensureNotNull)(e).showTradedSources,inverted:!0,trackLabel:"hide positions"}],["all",{label:i.t(null,void 0,o(133911)),dataName:"hide-all",tooltip:{active:e?i.t(null,void 0,o(538293)):i.t(null,void 0,o(839046)),inactive:e?i.t(null,void 0,o(67927)):i.t(null,void 0,o(44312))},trackLabel:"hide all"}]]),e||s.delete("positions"),s}function d(e){e?r.setValue("ChartToolsHideMode",e):e=h();const t=p();let o=!t;return"all"===e?(m(((e,t,n)=>{e.setValue(n?!o:o)})),c.hideStateChange.fire({hideMode:e,isActive:o}),o):(m(((n,i,r)=>{if(i===e){const e=t?!r:!n.value();n.setValue(e),o=r?!e:e}else n.setValue(Boolean(r))})),c.hideStateChange.fire({hideMode:e,isActive:o}),o)}function h(){const e=r.getValue("ChartToolsHideMode","drawings");return u().has(e)?e:"drawings"}function p(){let e=!0;return m(((t,o,n)=>{const i=t.value();e=e&&(n?!i:i)})),e}function m(e){u().forEach(((t,o)=>{var n;const i=null===(n=t.getBoxedValue)||void 0===n?void 0:n.call(t);i&&e(i,o,t.inverted)}))}},738600:(e,t,o)=>{o.d(t,{logger:()=>n});const n=(0,o(201089).getLogger)("Platform.Model.Watchlist")},621618:(e,t,o)=>{o.d(t,{ActionsProvider:()=>jo,createActionAddAlert:()=>Wo,createActionCopyPrice:()=>Uo,createActionTrade:()=>Do,createChangeIntervalsVisibilitiesAction:()=>Oo,createLinesAction:()=>Vo,createMTPredictorActions:()=>Ro,createPasteAction:()=>Fo,createSyncDrawingActions:()=>Ho,createVisualOrderAction:()=>Go,defaultContextMenuOptions:()=>Lo})
;var n=o(650151),i=o(201089),r=o(960521),a=o(389137),l=o(444372),c=o(244842),s=o(373571),u=o(608415),d=o(175070),h=o(982217),p=o(161488),m=o(794349),g=o(345848),v=o(939243),S=o(429589),y=o(167222),b=o(158566),f=o(772466),w=o(827710),A=o(439016),T=o(406849),M=o(454984),_=o(778737),E=o(674053),C=o(161608),k=o(516684),N=o(922850),P=o(985139),I=o(91849),L=o(606271),x=o(702236),W=o(381554),D=o(108218),F=o(726778),G=o(709081),O=o(711496),U=o(834075),R=o(125226),V=o(526075),H=o(860037),B=o(500521),j=o(263955),K=o(921692),Y=o(454373),z=o(314802),q=o(638456),Z=o(453817),$=o(470316),J=o(104436),X=o(7195),Q=o(943855),ee=o(519073),te=o(27005),oe=o(568247),ne=o(356893),ie=o(713473),re=o(981107),ae=o(167975),le=o(809796),ce=o(885482),se=o(223699),ue=o(395098),de=o(793993),he=o(62745),pe=o(354950),me=o.n(pe);const ge=(0,
i.getLogger)("Chart.ActionsProvider"),ve=new le.TranslatedString("change visibility",l.t(null,void 0,o(521511))),Se=new le.TranslatedString("pin to scale {label}",l.t(null,void 0,o(156015))),ye=new le.TranslatedString("pin to right scale",l.t(null,void 0,o(22615))),be=new le.TranslatedString("pin to left scale",l.t(null,void 0,o(84018))),fe=new le.TranslatedString("change earnings visibility",l.t(null,void 0,o(88217))),we=new le.TranslatedString("change dividends visibility",l.t(null,void 0,o(184944))),Ae=new le.TranslatedString("change splits visibility",l.t(null,void 0,o(374488))),Te=new le.TranslatedString("change continuous contract switch visibility",l.t(null,void 0,o(407017))),Me=new le.TranslatedString("change futures contract expiration visibility",l.t(null,void 0,o(628288))),_e=new le.TranslatedString("change latest news and Minds visibility",l.t(null,void 0,o(819839))),Ee=new le.TranslatedString("show all ideas",l.t(null,void 0,o(813622))),Ce=new le.TranslatedString("show ideas of followed users",l.t(null,void 0,o(826267))),ke=new le.TranslatedString("show my ideas only",l.t(null,void 0,o(740061))),Ne=new le.TranslatedString("change events visibility on chart",l.t(null,void 0,o(979574))),Pe=new le.TranslatedString("add this symbol to entire layout",l.t(null,void 0,o(527982))),Ie=new le.TranslatedString("add this indicator to entire layout",l.t(null,void 0,o(182388))),Le=new le.TranslatedString("add this strategy to entire layout",l.t(null,void 0,o(894292))),xe=new le.TranslatedString("add this financial metric to entire layout",l.t(null,void 0,o(422856))),We=new le.TranslatedString("apply drawing template",l.t(null,void 0,o(349037))),De=new le.TranslatedString("lock objects",l.t(null,void 0,o(168163))),Fe=new le.TranslatedString("unlock objects",l.t(null,void 0,o(766824))),Ge=new le.TranslatedString("change visibility at current interval and above",l.t(null,void 0,o(678422))),Oe=new le.TranslatedString("change visibility at current interval and below",l.t(null,void 0,o(249529))),Ue=new le.TranslatedString("change visibility at current interval",l.t(null,void 0,o(416698))),Re=new le.TranslatedString("change visibility at all intervals",l.t(null,void 0,o(666927))),Ve=l.t(null,void 0,o(108700)),He=l.t(null,void 0,o(764615)),Be=l.t(null,void 0,o(107005)),je=(0,ae.appendEllipsis)(l.t(null,void 0,o(893512))),Ke=l.t(null,void 0,o(287085)),Ye=(0,
ae.appendEllipsis)(l.t(null,void 0,o(952302))),ze=l.t(null,void 0,o(581428)),qe=l.t(null,void 0,o(831971)),Ze=l.t(null,void 0,o(311156)),$e=l.t(null,void 0,o(615682)),Je=l.t(null,void 0,o(266631)),Xe=l.t(null,void 0,o(737422)),Qe=l.t(null,void 0,o(805716)),et=l.t(null,void 0,o(650352)),tt=l.t(null,void 0,o(819263)),ot=l.t(null,void 0,o(615818)),nt=l.t(null,void 0,o(705897)),it=l.t(null,void 0,o(958976)),rt=l.t(null,void 0,o(611661)),at=l.t(null,void 0,o(466560)),lt=l.t(null,void 0,o(953958)),ct=l.t(null,void 0,o(734150)),st=l.t(null,void 0,o(783927)),ut=l.t(null,void 0,o(315644)),dt=l.t(null,void 0,o(442660)),ht=l.t(null,void 0,o(844788)),pt=l.t(null,void 0,o(770437)),mt=l.t(null,void 0,o(571263)),gt=l.t(null,void 0,o(370573)),vt=l.t(null,void 0,o(259560)),St=l.t(null,void 0,o(514125)),yt=l.t(null,void 0,o(444538)),bt=l.t(null,void 0,o(556948)),ft=l.t(null,void 0,o(920207)),wt=l.t(null,void 0,o(665810)),At=l.t(null,void 0,o(603822)),Tt=l.t(null,void 0,o(697324)),Mt=l.t(null,void 0,o(500764)),_t=l.t(null,void 0,o(708128)),Et=l.t(null,void 0,o(361201)),Ct=l.t(null,void 0,o(832156)),kt=l.t(null,void 0,o(591130)),Nt=l.t(null,void 0,o(737680)),Pt=l.t(null,void 0,o(243707)),It=l.t(null,void 0,o(739065)),Lt=l.t(null,void 0,o(454727)),xt=l.t(null,void 0,o(366156)),Wt=l.t(null,void 0,o(976598)),Dt=l.t(null,void 0,o(203485)),Ft=l.t(null,void 0,o(745828)),Gt=l.t(null,void 0,o(702899)),Ot=l.t(null,void 0,o(640887)),Ut=l.t(null,void 0,o(753387)),Rt=l.t(null,void 0,o(796712)),Vt=l.t(null,void 0,o(126354)),Ht=l.t(null,void 0,o(219796)),Bt=l.t(null,void 0,o(559901)),jt=l.t(null,void 0,o(223221)),Kt=l.t(null,void 0,o(422198)),Yt=l.t(null,void 0,o(127557)),zt=l.t(null,void 0,o(598486)),qt=l.t(null,void 0,o(973106)),Zt=l.t(null,void 0,o(85964)),$t=l.t(null,void 0,o(559192)),Jt=l.t(null,void 0,o(583182)),Xt=(0,ae.appendEllipsis)(l.t(null,void 0,o(592206))),Qt=(0,ae.appendEllipsis)(l.t(null,void 0,o(303612))),eo=(0,ae.appendEllipsis)(l.t(null,void 0,o(389517))),to=l.t(null,void 0,o(813345)),oo=(0,ae.appendEllipsis)(l.t(null,void 0,o(309908))),no=l.t(null,void 0,o(35216)),io=l.t(null,void 0,o(552977)),ro=l.t(null,void 0,o(419611)),ao=l.t(null,void 0,o(738342)),lo=l.t(null,void 0,o(715101)),co=l.t(null,void 0,o(642284)),so=l.t(null,void 0,o(246771)),uo=l.t(null,void 0,o(966263)),ho=l.t(null,void 0,o(830816)),po=l.t(null,void 0,o(124620)),mo=l.t(null,void 0,o(484813)),go=l.t(null,void 0,o(772973)),vo=l.t(null,void 0,o(748284)),So=l.t(null,void 0,o(487933)),yo=l.t(null,void 0,o(258669)),bo=(0,ae.appendEllipsis)(l.t(null,void 0,o(389517))),fo=l.t(null,void 0,o(308251)),wo=l.t(null,void 0,o(34059)),Ao=l.t(null,void 0,o(364288)),To=l.t(null,void 0,o(777920)),Mo=l.t(null,void 0,o(575669)),_o=l.t(null,void 0,o(608886)),Eo=l.t(null,void 0,o(618008)),Co=l.t(null,void 0,o(733606)),ko=(0,ae.appendEllipsis)(l.t(null,void 0,o(665986))),No=(0,ae.appendEllipsis)(l.t(null,void 0,o(218001))),Po=l.t(null,void 0,o(729682)),Io=l.t(null,void 0,o(28851)),Lo={general:!0,mainSeries:!0,mainSeriesTrade:!1,esdStudies:!0,studies:!0,fundamentals:!0,lineTools:!0,
publishedCharts:!0,ordersAndPositions:!0,alerts:!0,chartEvents:!0,objectTree:!0,gotoLineTool:!1};function xo(e){return(0,re.isActingAsSymbolSource)(e)?e.symbolTitle(h.TitleDisplayTarget.StatusLine,!0,!0):e.title(h.TitleDisplayTarget.StatusLine,!0)}function Wo(e,t){var o,i;const r=e.model().model();if(r.isInReplay())return null;if(r.mainSeries().isConvertedToOtherCurrency()||r.mainSeries().isConvertedToOtherUnit())return null;let a={},l=Ve,c=null,s=null;const u=null!==(o=t.series)&&void 0!==o?o:null===(i=t.pane)||void 0===i?void 0:i.mainDataSource();return u?s=function(e,t,o){const n=e.symbolSource();if(n&&(n.isConvertedToOtherCurrency()||n.isConvertedToOtherUnit()))return null;let i,r;const a=(0,p.isStudy)(e)?"ContextMenuStudy":e===t?"ContextMenuSeries":null,l=e.priceScale()||t.priceScale(),c=e.firstValue(),s=l.isPercentage()?e:l;if(void 0!==o&&null!==c)i=l.coordinateToPrice(o,c);else if(e===t)i=t.lastValueData(4,!0,!0).price;else if((0,p.isStudy)(e)){const t=e.defaultPlotIdForAlert();i=null===t?void 0:e.lastValueData(t,!0,!0).price}r=void 0!==i&&(0,L.isFirstAlertPlotUsual)(e)?Be.format({title:xo(e),price:s.formatter().format(i)}):He.format({title:xo(e)});return{label:r,trackEventLabel:a,alertEditorOptions:{series:e,value:i}}}(u,r.mainSeries(),t.localY):t.drawing&&(s=function(e){const t=(0,n.ensureNotNull)(e.ownerSource());if(!t.alertCreationAvailable().value())return null;const o=t.symbolSource();if(o&&(o.isConvertedToOtherCurrency()||o.isConvertedToOtherUnit()))return null;return{label:He.format({title:e.title(h.TitleDisplayTarget.StatusLine)}),trackEventLabel:"ContextMenuDrawing",alertEditorOptions:{drawing:e}}}(t.drawing)),!s&&t.drawing?null:(s&&(a=s.alertEditorOptions,l=s.label,c=s.trackEventLabel),l=(0,ae.appendEllipsis)(l),new b.TVActionAsync((()=>(a.series?(0,F.hasUserAccessToDataSource)(a.series):Promise.resolve(!0)).then((e=>{const t={label:l,icon:W,statName:"AddAlert"};return e?{...t,shortcutHint:(0,$.humanReadableHash)($.Modifiers.Alt+65),onExecute:()=>{null!==c&&((0,g.trackEvent)("GUI","CreateAlert",c),c=null),(0,y.runOrSigninWithFeature)((()=>{(0,S.invokeAlertEditorWithOnlineSeries)({...a,dataSourceHub:r,actionSource:"pane_context_menu_add_alert"})}),{source:"Alert add from pane context menu",sourceMeta:"Chart",feature:"alert"})}}:{...t,disabled:!0}})))))}function Do(e,t,o){if(e.model().isInReplay())return null;const n=e.model().mainSeries();return n.isConvertedToOtherCurrency()||n.isConvertedToOtherUnit()?null:new s.ActionAsync("Trading.TradeFromChart",(()=>{const t=new Promise(((t,n)=>{const i=(0,A.tradingService)();if(null===i||0===i.brokersList().length)return void t({label:Ke,disabled:!0});const r=e.model().mainSeries();let a;o&&(a=o.localY),(0,T.createTradeContext)(r,a).then((e=>{try{return i.chartContextMenuActions(e,{hideNotExecutableAction:!0})}catch(e){return ge.logError(e.message),[]}})).then((e=>{0!==e.length?t({name:"trade",label:Ke,subItems:e,statName:"Trading"}):t({label:Ke,disabled:!0})})).catch((()=>{n("Unable to get Trade Context")}))}));return(0,
M.makeTimeLimited)(t,5e3,"Action trade not received")}))}function Fo(e,t){return!t.isEmpty()&&c.enabled("datasource_copypaste")?new s.Action({actionId:"Chart.Clipboard.PasteSource",label:Po.trim(),shortcutHint:(0,$.humanReadableHash)($.Modifiers.Mod+86),statName:"Paste",onExecute:()=>e.chartWidgetCollection().clipboard.uiRequestPaste(t)}):null}function Go(e,t){const n=e.model(),i=n.availableZOrderOperations(t),r=[new s.Action({actionId:"Chart.Source.VisualOrder.BringToFront",label:Vt,statName:"BringToFront",disabled:!i.bringToFrontEnabled,onExecute:()=>n.bringToFront(t)}),new s.Action({actionId:"Chart.Source.VisualOrder.SendToBack",label:Ht,statName:"SendToBack",disabled:!i.sendToBackEnabled,onExecute:()=>n.sendToBack(t)}),new s.Action({actionId:"Chart.Source.VisualOrder.BringForward",label:Bt,statName:"BringForward",disabled:!i.bringForwardEnabled,onExecute:()=>n.bringForward(t)}),new s.Action({actionId:"Chart.Source.VisualOrder.SendBackward",label:jt,statName:"SendBackward",disabled:!i.sendBackwardEnabled,onExecute:()=>n.sendBackward(t)})];return new s.Action({actionId:"Chart.Source.VisualOrder",label:Kt,icon:o(677067),statName:"VisualOrder",subItems:r})}function Oo(e,t){const o=e.model(),n=(e,n)=>{const i=se.Interval.parse(o.mainSeries().interval()),r=(0,ue.getIntervalsVisibilitiesForMode)(i,e),a=[],l=[];t.forEach((e=>{const t=e.properties().intervalsVisibilities.childs();a.push(t.ticks),l.push(r.ticks),a.push(t.seconds),l.push(r.seconds),a.push(t.secondsFrom),l.push(r.secondsFrom),a.push(t.secondsTo),l.push(r.secondsTo),a.push(t.minutes),l.push(r.minutes),a.push(t.minutesFrom),l.push(r.minutesFrom),a.push(t.minutesTo),l.push(r.minutesTo),a.push(t.hours),l.push(r.hours),a.push(t.hoursFrom),l.push(r.hoursFrom),a.push(t.hoursTo),l.push(r.hoursTo),a.push(t.days),l.push(r.days),a.push(t.daysFrom),l.push(r.daysFrom),a.push(t.daysTo),l.push(r.daysTo),a.push(t.weeks),l.push(r.weeks),a.push(t.weeksFrom),l.push(r.weeksFrom),a.push(t.weeksTo),l.push(r.weeksTo),a.push(t.months),l.push(r.months),a.push(t.monthsFrom),l.push(r.monthsFrom),a.push(t.monthsTo),l.push(r.monthsTo),a.push(t.ranges),l.push(r.ranges)})),o.setProperties(a,l,n)},i=[new s.Action({actionId:"Chart.Source.IntervalsVisibility.CurrentAndAbove",label:zt,statName:"currentAndAboveIntervals",onExecute:()=>n(3,Ge)}),new s.Action({actionId:"Chart.Source.IntervalsVisibility.CurrentAndBelow",label:qt,statName:"currentAndBelowIntervals",onExecute:()=>n(2,Oe)}),new s.Action({actionId:"Chart.Source.IntervalsVisibility.Current",label:Zt,statName:"currentInterval",onExecute:()=>n(1,Ue)}),new s.Action({actionId:"Chart.Source.IntervalsVisibility.All",label:$t,statName:"allIntervals",onExecute:()=>n(0,Re)})];return new s.Action({actionId:"Chart.Source.IntervalsVisibility",label:Yt,statName:"IntervalsVisibility",subItems:i})}function Uo(e,t){var o,n,i
;const r=e.defaultPriceScale(),a=void 0!==t?r.coordinateToPrice(t,null!==(n=null===(o=e.mainDataSource())||void 0===o?void 0:o.firstValue())&&void 0!==n?n:0):e.model().mainSeries().lastValueData(4,!0,!0).price,l=null===(i=e.mainDataSource())||void 0===i?void 0:i.formatter();if(void 0===a||!l)return null;const c=l.format(a);return new s.Action({actionId:"Chart.Clipboard.CopyPrice",label:`${Io} ${c}`,statName:"CopyPrice",onExecute:()=>(0,de.getClipboard)().writeText(c)})}function Ro(e,t,o,i){const r=(r,a,l)=>new b.TVAction({label:r,onExecute:()=>{const r=e.model(),c=r.model().timeScale(),s=t.defaultPriceScale();if(!c.isEmpty()&&!s.isEmpty())if(l&&void 0!==o&&void 0!==i){const e=(0,n.ensureNotNull)((0,n.ensureNotNull)(t.mainDataSource()).firstValue()),l=s.coordinateToPrice(o,e),u=Math.round(c.coordinateToIndex(i));r.createLineTool({pane:t,point:{index:u,price:l},linetool:a})}else ce.tool.setValue(a)}});return new b.TVAction({label:Ze,subItems:[r($e,"LineStudyMtpRiskReward",!1),r(Je,"LineStudyMtpDecisionPoint",!0),r(Xe,"LineStudyMtpAnalysis",!0),new b.TVAction({label:Qe,subItems:[r(et,"LineStudyMtpElliotWaveMain",!0),r(tt,"LineStudyMtpElliotWaveMajor",!0),r(ot,"LineStudyMtpElliotWaveMinor",!0)]}),new b.TVAction({label:nt,subItems:[r(it,"LineStudyMtpUpWave1OrA",!1),r(rt,"LineStudyMtpUpWave2OrB",!1),r(at,"LineStudyMtpUpWaveC",!1),r(lt,"LineStudyMtpUpWave3",!1),r(ct,"LineStudyMtpUpWave4",!1),r(st,"LineStudyMtpUpWave5",!1)]}),new b.TVAction({label:ut,subItems:[r(dt,"LineStudyMtpDownWave1OrA",!1),r(ht,"LineStudyMtpDownWave2OrB",!1),r(pt,"LineStudyMtpDownWaveC",!1),r(mt,"LineStudyMtpDownWave3",!1),r(gt,"LineStudyMtpDownWave4",!1),r(vt,"LineStudyMtpDownWave5",!1)]})]})}function Vo(e){const t=e.actions(),o=[t.showPriceLine];return o.push(t.showSeriesPrevCloseLine),o.push(t.showPrePostMarketPriceLine),o.push(t.showHighLowPriceLines),e.model().model().hasCustomSource("bidask")&&o.push(t.showBidAskLines),new s.Action({actionId:"Chart.Lines",label:Jt,statName:"Lines",subItems:o})}function Ho(e,t){const o=[];{if(ce.isToolCreatingNow.value())return o;const n=()=>{var t;return null!==(t=e.chartWidgetCollection().activeChartWidget.value())&&void 0!==t?t:e},i=()=>t.some((e=>e.isSynchronizable()));if((0,R.isFeatureEnabled)("save_shared_line_tools")){if(!window.user.is_pro)return o;if(!i())return o;let n=t[0].sharingMode().value();n=t.every((e=>e.sharingMode().value()===n))?n:null;const r=e.model();o.push(new s.Separator,new b.TVAction({label:_o,statName:"NoSyncDrawing",checkable:!0,checked:0===n,onExecute:e=>{e.isChecked()&&r.shareLineTools(t,0)}}),new b.TVAction({label:Eo,statName:"SyncDrawingInLayout",checkable:!0,checked:1===n,onExecute:e=>{e.isChecked()&&r.shareLineTools(t,1)}}),new b.TVAction({label:Co,statName:"SyncDrawingGlobally",checkable:!0,checked:2===n,onExecute:e=>{e.isChecked()&&r.shareLineTools(t,2)}}))}else if(c.enabled("support_multicharts")&&e.isMultipleLayout().value()){if(!i())return o;const e=t.every((e=>!!e.linkKey().value()));o.push(new s.Separator,new s.Action({actionId:"Chart.LineTool.NoSync",label:_o,
statName:"NoSyncDrawing",checkable:!0,checked:!e,onExecute:e=>{e.isChecked()&&n().unlinkSelectedLine()}}),new s.Action({actionId:"Chart.LineTool.SyncInLayout",label:Eo,statName:"SyncDrawingInLayout",checkable:!0,checked:e,onExecute:e=>{e.isChecked()&&n().copyLineToOtherCharts()}}))}}return o}function Bo(){var e,t;return!(0,q.onWidget)()&&!(0,z.isOnMobileAppPage)("any")&&!!(null===(t=null===(e=window.widgetbar)||void 0===e?void 0:e.layout)||void 0===t?void 0:t.canOpen())}class jo{constructor(e,t){this._chartWidget=e,this._options=(0,a.merge)((0,a.clone)(Lo),t||{})}async contextMenuActionsForSources(e,t,o){const n=e[0],i=this._options;if(n===this._chartWidget.model().mainSeries()&&i.mainSeries)return this._contextMenuActionsForSeries(n,t);if((0,p.isESDStudy)(n)&&i.esdStudies)return this._contextMenuActionsForESD();if((0,p.isRollDatesStudy)(n))return this._contextMenuActionsForRollDates();if((0,K.isFuturesContractExpiration)(n))return this._contextMenuActionsForFuturesContractExpiration();if((0,Y.isLatestUpdatesSource)(n))return this._contextMenuActionsForisLatestUpdates();if((0,p.isStudy)(n)&&i.studies)return this._contextMenuActionsForStudy(n,t);if(n instanceof N.PublishedChartsTimeline&&i.publishedCharts)return this._contextMenuActionsForPublishedTimeline(n);if((n instanceof _.LineToolOrder||n instanceof E.LineToolPosition)&&i.ordersAndPositions)return this._contextMenuActionsForTradingDrawings(n);if((0,I.isAlertLabel)(n)&&n.alert().id().value()&&i.alerts)return this._contextMenuActionsForAlertLabel(n.alert(),o);if((0,ie.isLineTool)(n)&&i.lineTools){const t=e.filter(ie.isLineTool);return this._contextMenuActionsForLineTool(t)}return n instanceof x.ChartEventsSource&&i.chartEvents?this._contextMenuActionsForChartEvents(n):[]}_isReadOnly(){return this._chartWidget.readOnly()}_createActionHide(e){return new s.Action({actionId:"Chart.SelectedObject.Hide",label:qe,icon:o(484959),statName:"HideSelectedObject",onExecute:this._chartWidget.hideDataSources.bind(this._chartWidget,[e])})}_createActionShow(e){const t=new s.Action({actionId:"Chart.SelectedObject.Show",checkable:!0,label:ze,icon:o(416911),statName:"ToggleShow"}),n=new u.ActionBinder(t,e.properties().visible,this._chartWidget.model(),ve);return t.setBinding(n),n.setValue(e.properties().visible.value()),t}_createActionScale(e){const t=(0,n.ensureNotNull)(e.priceScale()),i=this._chartWidget.model().model(),r=(0,n.ensureNotNull)(i.paneForSource(e)),a=r.priceScalePosition(t),l=("left"===a?r.leftPriceScales():r.rightPriceScales()).indexOf(t),c=i.priceScaleSlotsCount().totallySlots<2?"dontneedname":"needname",u="overlay"===a?"":(0,d.getPriceAxisNameInfo)(a,l).label,h=It.format({label:u}),p={"left-needname":h,"left-dontneedname":xt,"right-needname":h,"right-dontneedname":Wt,"overlay-needname":Lt,"overlay-dontneedname":Lt}[a+"-"+c];return new s.Action({actionId:"Chart.Source.ChangePriceScale",label:p,icon:o(225191),subItems:this._createActionScaleItems(e)})}_createActionResetInputPoints(e){const t=e.metaInfo(),n=t.inputs.filter(he.isTimeOrPriceNotHiddenInput)
;return 0===n.length?null:new s.Action({actionId:"Chart.Source.ResetInputPoints",label:No,onExecute:async()=>{let i;try{const r=e.properties().childs().inputs.state();for(const e of Object.keys(r))n.find((t=>t.id===e))||delete r[e];const a=new(me())({inputs:r}),l=await Promise.all([o.e(70166),o.e(44636),o.e(88601),o.e(58337),o.e(22666),o.e(62253),o.e(92108),o.e(5993),o.e(9817),o.e(4015),o.e(92191),o.e(53842),o.e(34465),o.e(69121),o.e(66639),o.e(38669),o.e(35649),o.e(5145),o.e(88194),o.e(89842),o.e(30006),o.e(25190),o.e(93502),o.e(72639),o.e(32109),o.e(36884),o.e(68992),o.e(87845),o.e(26855),o.e(58056),o.e(13152),o.e(21625),o.e(84281),o.e(91033),o.e(61631),o.e(90684),o.e(40866),o.e(99916),o.e(43610),o.e(73954),o.e(36956),o.e(96899),o.e(56388),o.e(9227),o.e(77807),o.e(89434),o.e(8740),o.e(58289),o.e(24215),o.e(43445),o.e(18511),o.e(21895),o.e(22333),o.e(54474),o.e(15886),o.e(36740),o.e(73606),o.e(71762),o.e(50690),o.e(30979),o.e(26300),o.e(31142),o.e(37457),o.e(68985),o.e(15277),o.e(37070),o.e(50186),o.e(46491),o.e(44111),o.e(85871),o.e(53030)]).then(o.bind(o,280881));i=(await l.selectInputValuesOnChart(this._chartWidget,n,a,t.shortDescription,t.inputs)).customSourceId,e.properties().mergeAndFire(a.state())}finally{void 0!==i&&this._chartWidget.model().model().removeCustomSource(i)}}})}_createActionLayoutChartsSync(){return new Z.LayoutChartsSyncContextMenuAction(this._chartWidget.linkingGroupIndex().readonly(),(e=>this._chartWidget.model().setLinkingGroupIndex(e)))}_createActionScaleDetach(e,t,o,i){const r=this._chartWidget.model().model(),a=(0,n.ensureNotNull)(r.paneForSource(e));if(!a.canCreateNewPriceScale())return null;const l=(0,n.ensureNotNull)(e.priceScale()),c=l.canDetachSource(e),u=a.priceScalePosition(l),h=c||u!==t;if(!h)return null;const p=r.priceScaleSlotsCount(),m={left:{labelled:Tt,sided:Nt},right:{labelled:Tt,sided:Pt}},g="left"===t?a.leftPriceScales().length:a.rightPriceScales().length,v=p[t]>g?"labelled":"sided",S=(0,d.getPriceAxisNameInfo)(t,g).label,y=m[t][v].format({label:S});return new s.Action({actionId:"Chart.Source.ChangePriceScale",checkable:!1,disabled:!h,label:y,statName:i,payload:e,onExecute:o})}_onDetachLeft(e){const t=e.getPayload(),o=this._chartWidget.model().model(),i=(0,n.ensureNotNull)(o.paneForSource(t));this._chartWidget.model().detachToLeft(t,i)}_onDetachRight(e){const t=e.getPayload(),o=this._chartWidget.model().model(),i=(0,n.ensureNotNull)(o.paneForSource(t));this._chartWidget.model().detachToRight(t,i)}_createActionScaleDetachLeft(e){return this._createActionScaleDetach(e,"left",this._onDetachLeft.bind(this),"ToggleScaleLeft")}_createActionScaleDetachRight(e){return this._createActionScaleDetach(e,"right",this._onDetachRight.bind(this),"ToggleScaleRight")}_onMoveToScale(e){const t=e.getPayload();if(t.datasource.priceScale()===t.priceScale)return;const o=this._chartWidget.model().model(),i=(0,n.ensureNotNull)(o.paneForSource(t.datasource));this._chartWidget.model().moveToScale(t.datasource,i,t.priceScale,t.undoText)}_createMoveToScaleAction(e,t,o,n){const i=e.priceScale()===t
;return new s.Action({actionId:"Chart.Source.MoveToOtherScale",checkable:!0,checked:i,label:o,statName:"ToggleScale",payload:{datasource:e,priceScale:t,undoText:n},onExecute:this._onMoveToScale.bind(this)})}_onNoScale(e){const t=e.getPayload().datasource,o=this._chartWidget.model().model(),i=(0,n.ensureNotNull)(o.paneForSource(t));i.isOverlay(t)||this._chartWidget.model().detachNoScale(t,i)}_createActionNoScale(e){const t=this._chartWidget.model().model(),o=(0,n.ensureNotNull)(t.paneForSource(e)),i=o.actionNoScaleIsEnabled(e);return new s.Action({actionId:"Chart.Source.MoveToNoScale",checkable:!0,checked:o.isOverlay(e),label:Dt,disabled:!i,statName:"ToggleNoScale",payload:{datasource:e},onExecute:this._onNoScale.bind(this)})}_createActionScaleItems(e){const t=[],o=this._chartWidget.model().model(),i=(0,n.ensureNotNull)(o.paneForSource(e)),r=o.priceScaleSlotsCount().totallySlots>1,a=i.rightPriceScales(),l=i.leftPriceScales(),c=this._createActionScaleDetachRight(e),u=this._createActionScaleDetachLeft(e),h=a.length+l.length+(null===c?0:1)+(null===u?0:1)>2,p={right:{hidden:{checked:{labelled:St,sided:yt},unchecked:{labelled:bt,sided:ft}},visible:{checked:{labelled:wt,sided:At},unchecked:{labelled:Tt,sided:Mt}}},left:{hidden:{checked:{labelled:St,sided:_t},unchecked:{labelled:bt,sided:Et}},visible:{checked:{labelled:wt,sided:Ct},unchecked:{labelled:Tt,sided:kt}}}},m={right:ye,left:be},g={left:i.visibleLeftPriceScales(),right:i.visibleRightPriceScales()},v=(t,o)=>{const n=("right"===o?a:l)[t],i=g[o].includes(n)?"visible":"hidden",c=e.priceScale()===n?"checked":"unchecked",s=r?"labelled":"sided",u=p[o],h=(0,d.getPriceAxisNameInfo)(o,t).label;return{actionText:u[i][c][s].format({label:h}),undoText:r?Se.format({label:h}):m[o]}};t.push(...a.map(((t,o)=>{const n=v(o,"right");return this._createMoveToScaleAction(e,t,n.actionText,n.undoText)}))),null!==c&&t.push(c);h&&(a.length>0||null!==c)&&t.push(new s.Separator);t.push(...l.map(((t,o)=>{const n=v(o,"left");return this._createMoveToScaleAction(e,t,n.actionText,n.undoText)}))),null!==u&&t.push(u);h&&(l.length>0||null!==u)&&t.push(new s.Separator);return t.push(this._createActionNoScale(e)),t}_createActionMergeUp(e){const t=this._chartWidget.model();return t.model().isMergeUpAvailableForSource(e)?new s.Action({actionId:"Chart.Source.MergeUp",label:Gt,statName:"MergeUp",onExecute:()=>t.mergeSourceUp(e)}):null}_createActionUnmergeUp(e){const t=this._chartWidget.model();return t.model().isUnmergeAvailableForSource(e)?new s.Action({actionId:"Chart.Source.UnmergeUp",label:Ot,statName:"UnmergeUp",onExecute:()=>t.unmergeSourceUp(e)}):null}_createActionMergeDown(e){const t=this._chartWidget.model();return t.model().isMergeDownAvailableForSource(e)?new s.Action({actionId:"Chart.Source.MergeDown",label:Ut,statName:"MergeDown",onExecute:()=>t.mergeSourceDown(e)}):null}_createActionUnmergeDown(e){const t=this._chartWidget.model();return t.model().isUnmergeAvailableForSource(e)?new s.Action({actionId:"Chart.Source.UnmergeDown",label:Rt,statName:"UnmergeDown",
onExecute:()=>t.unmergeSourceDown(e)}):null}_mergeContentMenuItems(e){return[this._createActionMergeUp(e),this._createActionUnmergeUp(e),this._createActionMergeDown(e),this._createActionUnmergeDown(e)].filter(a.notNull)}_createActionMove(e){const t=this._mergeContentMenuItems(e);return t.length>0?new s.Action({actionId:"Chart.Source.MoveToPane",label:Ft,icon:o(854190),subItems:t}):null}_contextMenuActionsForSeries(e,t){var o;const i=[],r=e.properties().childs().visible.value(),a=this._chartWidget.model().model(),l=(0,n.ensureNotNull)(a.paneForSource(e)),u=this._chartWidget.actions(),d=t&&"localY"in t?t.localY:void 0;if(this._isReadOnly())i.push(r?this._createActionHide(e):this._createActionShow(e)),i.push(new s.Separator),i.push(this._createActionScale(e));else{if(e.alertCreationAvailable().value()){const t=Wo(this._chartWidget,{series:e,localY:d});null!==t&&i.push(t)}if(i.push(this._createActionAddChildStudy(e)),this._options.fundamentals){const t=this._createActionAddFundamentals(e);null!==t&&i.push(t)}if(this._options.mainSeriesTrade){const e=Do(this._chartWidget);null!==e&&i.push(e)}i.length>0&&!(i[i.length-1]instanceof s.Separator)&&i.push(new s.Separator),c.enabled("symbol_info")&&i.push(u.showSymbolInfoDialog),Bo()&&i.push(this._chartWidget.actions().showDataWindow);const t=a.mainSeries().symbolInfo();if(u.showFinancials&&null!==t&&(0,O.hasFinancialsByTypespecs)(t.type,t.typespecs)&&i.push(u.showFinancials),i.length>0&&!(i[i.length-1]instanceof s.Separator)&&i.push(new s.Separator),!l.isEmpty()&&c.enabled("datasource_copypaste")){const e=Uo(l,d),t=Fo(this._chartWidget,l);(e||t)&&(e&&i.push(e),t&&i.push(t),i.push(new s.Separator))}i.push(Go(this._chartWidget,[e]));const h=this._createActionMove(e);null!==h&&i.push(h),i.push(this._createActionScale(e)),this._chartWidget.isMultipleLayout().value()&&(this._chartWidget.chartWidgetCollection().lock.symbol.value()||this._chartWidget.chartWidgetCollection().lock.interval.value())&&i.push(this._createActionLayoutChartsSync()),i.push(r?this._createActionHide(e):this._createActionShow(e)),i.push(new s.Separator);Boolean(null===(o=window.widgetbar)||void 0===o?void 0:o.widget("watchlist"))&&u.addToWatchlist&&i.push(u.addToWatchlist),c.enabled("text_notes")&&i.push(u.addToTextNotes),i[i.length-1]instanceof s.Separator||i.push(new s.Separator),window.pro&&window.pro.hasPackage("mtp-mtpredictor")&&i.push((0,n.ensureNotNull)(Ro(this._chartWidget,l)),new s.Separator),c.enabled("show_chart_property_page")&&!this._chartWidget.onWidget()&&i.push(u.mainSeriesPropertiesAction),i[i.length-1]instanceof s.Separator&&i.pop()}return i}_createActionAddChildStudy(e){const t=this._chartWidget.model().model();return new b.TVAction({label:Xt.format({studyTitle:xo(e)}),icon:o(706862),statName:"ApplyIndicator",onExecute:()=>{const o=this._chartWidget.showIndicators((0,p.isStudy)(e)?[e]:[]);if(o&&(0,p.isStudy)(e)){const e=()=>{(0,g.trackEvent)("SOS","Apply SOS","Apply by RC menu")},n=t.studyInserted();n.subscribe(this,e),o.visible().subscribe((t=>{t||n.unsubscribe(this,e)}),{once:!0})}}})}
_createActionAddFundamentals(e){{const t=e.symbolInfo();if(null!==t&&"forex"!==t.type&&!(0,ee.hasCryptoTypespec)(t.typespecs||[]))return new b.TVAction({label:Qt.format({instrumentName:xo(e)}),icon:o(428026),statName:"ApplyFundamental",onExecute:()=>{this._chartWidget.showFundamentals(e!==this._chartWidget.model().mainSeries()?e:void 0)}})}return null}_createActionShowSymbolInfoDialog(e,t){const n=this._chartWidget.model().model();return new s.Action({actionId:"Chart.Dialogs.ShowSymbolInfo",label:ko,icon:o(437924),checkable:!1,statName:"SymbolInfo",onExecute:()=>{const o=e.symbol(),i={symbolInfo:e.symbolInfo(),unitDescription:e=>t.description(e),dateFormatter:n.dateFormatter()};(0,oe.showSymbolInfoDialog)(o,i)}})}_createActionShowProperties(e){return new s.Action({actionId:"Chart.Indicator.ShowSettingsDialog",label:eo,icon:o(951983),statName:"EditSelectedObject",onExecute:()=>this._chartWidget.showSourceProperties(e)})}async _contextMenuActionsForStudy(e,t){const n=this._chartWidget.actions(),i=e.properties().childs().visible.value(),r=t&&"localY"in t?t.localY:void 0,a=[];if(!e.userEditEnabled())return a;if(this._chartWidget.readOnly())a.push(i?this._createActionHide(e):this._createActionShow(e)),a.push(new s.Separator),(0,f.isNonSeriesStudy)(e)||a.push(this._createActionScale(e));else{if(e.alertCreationAvailable().value()){const t=Wo(this._chartWidget,{series:e,localY:r});null!==t&&a.push(t)}if(c.enabled("study_on_study")&&e.canHaveChildren()&&a.push(this._createActionAddChildStudy(e)),(e instanceof Q.StudyCompare||e instanceof X.study_Overlay)&&this._options.fundamentals){const t=this._createActionAddFundamentals(e);null!==t&&a.push(t)}const t=this._createApplyToEntireLayoutCommand(e);if(null!==t&&a.push(t),a.length>0&&!(a[a.length-1]instanceof s.Separator)&&a.push(new s.Separator),c.enabled("symbol_info")&&(e instanceof Q.StudyCompare||e instanceof X.study_Overlay)&&null!==e.symbolInfo()&&(a.push(this._createActionShowSymbolInfoDialog(e,this._chartWidget.model().model().availableUnits())),a.push(new s.Separator)),a.push(Go(this._chartWidget,[e])),a.push(Oo(this._chartWidget,[e])),!(0,f.isNonSeriesStudy)(e)){const t=this._createActionMove(e);null!==t&&a.push(t),a.push(this._createActionScale(e))}a.push(new s.Separator);const u=e.metaInfo();if(!(0,p.isFundamentalStudy)(e)&&u.pine&&n.viewSourceCode){const{scriptIdPart:t,pine:{version:i}}=u;let r;if(V.StudyMetaInfo.hasStdSuffix(t)){const{default:e}=await o.e(95937).then(o.t.bind(o,676006,19));t in e&&(r=()=>(0,H.showSupportDialog)({solutionId:e[t]}))}else V.StudyMetaInfo.hasPubSuffix(t)&&(r=async()=>{try{const{chartImageUrl:o}=await(0,k.requestScriptInfo)(t);(0,B.pushChartPage)({chartId:o,chartName:e.title(h.TitleDisplayTarget.StatusLine)})}catch(e){(0,j.showScriptInfoErrorNoticeDialog)()}});void 0!==r&&a.push(new b.TVAction({label:(0,ae.appendEllipsis)(l.t(null,void 0,o(907859))),statName:"OpenSelectedObjectAbout",onExecute:r})),a.push(n.viewSourceCode);const c=this._createActionResetInputPoints(e);c&&a.push(c),a.push(new s.Separator),n.viewSourceCode.update({
disabled:!1}),(0,k.isAuthToGetPineSourceCode)(t,i).done((e=>{e||n.viewSourceCode.update({disabled:!0})})).fail((e=>{ge.logError("Failed isAuthToGetPineSourceCode, reason: "+e)}))}if((0,R.isFeatureEnabled)("enable_pine_logs")&&window.is_authenticated&&(0,te.isUserStudyWithLogs)(e)&&(a.push(new b.TVAction({label:l.t(null,void 0,o(249313)),statName:"PineLogs",onExecute:()=>{(0,te.openPineLogsInRightPanel)(e)}})),a.push(new s.Separator)),e.copiable()){const t=new s.Action({actionId:"Chart.Clipboard.CopySource",label:no,shortcutHint:(0,$.humanReadableHash)($.Modifiers.Mod+67),statName:"Copy",onExecute:()=>{this._chartWidget.chartWidgetCollection().clipboard.uiRequestCopy([e])}});a.push(t)}a.push(i?this._createActionHide(e):this._createActionShow(e)),a.push(n.studyRemove);const d=!this._chartWidget.onWidget()&&this._options.objectTree&&n.paneObjectTree,m=Bo();(d||m)&&(a.push(new s.Separator),d&&a.push(n.paneObjectTree),m&&a.push(this._chartWidget.actions().showDataWindow)),a.push(new s.Separator),c.enabled("property_pages")&&new w.MetaInfoHelper(u).hasUserEditableOptions()&&a.push(this._createActionShowProperties(e)),a[a.length-1]instanceof s.Separator&&a.pop()}return a}_createEditAlertDrawingAction(e){return new b.TVAction({label:je.format({title:e.title(h.TitleDisplayTarget.StatusLine)}),icon:D,statName:"EditAlert",onExecute:()=>{window.runOrSignIn((()=>{e.editAlert("pane_context_menu_edit_alert")}),{source:"Alert edit from pane context menu"})}})}_createLineToolTemplateAction(e){{const t=this._chartWidget.model(),n=o=>{t.applyLineToolTemplate(e,o,We)};return new s.ActionAsync("Chart.LineTool.Templates",(async()=>{const{LinetoolTemplatesList:i}=await Promise.all([o.e(29594),o.e(91622),o.e(3177)]).then(o.bind(o,998777)),r=new i(e.toolname,n),a=[],l=new s.Action({actionId:"Chart.LineTool.Templates.SaveAs",label:oo,statName:"SaveAs",onExecute:()=>{r.showSaveDialog((t=>{const o=JSON.stringify(e.template());r.saveTemplate(t,o)}))}});a.push(l);const c=new s.Action({actionId:"Chart.LineTool.Templates.ApplyDefaults",label:to,statName:"ApplyDefault",onExecute:()=>{t.restorePropertiesForSource(e),window.lineToolPropertiesToolbar.onSourceChanged([e])}});return a.push(c),new Promise((e=>{r.templatesLoaded().then((()=>{var e;const t=null!==(e=r.getData())&&void 0!==e?e:[];t.length>0&&a.push(new s.Separator),t.forEach(((e,t)=>{const o=new s.Action({actionId:"Chart.LineTool.Templates.Apply",label:e,statName:"ApplyTemplate",onExecute:()=>r.loadTemplate(e),toolbox:{type:J.ToolboxType.Delete,action:()=>{r.deleteAction(e)}},showToolboxOnHover:!0});a.push(o)}))}),(e=>{ge.logWarn(e)})).then((()=>{e({label:ro,statName:"Template",subItems:a})}))}))}))}}_createActionToggleLockLineTools(e){const t=e[0].properties().frozen.value(),n=t?lo:co;return new s.Action({actionId:"Chart.SelectedObject.ToggleLocked",label:n,statName:"ToggleLockSelectedObject",checkable:!0,icon:o(t?397874:902872),onExecute:()=>{if(1===e.length)this._chartWidget.toggleLockSelectedObject();else{const o=t?Fe:De,n=this._chartWidget.model();n.withMacro(o,(()=>{e.forEach((e=>{
n.setProperty(e.properties().frozen,!t,o)}))}))}}})}async _contextMenuActionsForLineTool(e){const t=[],i=this._chartWidget.actions(),a=this._chartWidget.model().model(),l=()=>{t.push(Go(this._chartWidget,e))},u=()=>{t.push(Oo(this._chartWidget,e))},d=()=>{const n=e.filter((e=>e.cloneable()));if(n.length>0){const e=new s.Action({actionId:"Chart.LineTool.Clone",label:io,icon:o(201457),shortcutHint:(0,$.humanReadableModifiers)($.Modifiers.Mod)+"Drag",statName:"Clone",onExecute:()=>this._chartWidget.model().cloneLineTools(n,!1)},"Clone");t.push(e)}return!!n.length},p=()=>{const o=e.filter((e=>e.copiable()));if(o.length>0){const e=new s.Action({actionId:"Chart.Clipboard.CopyLineTools",label:no,shortcutHint:(0,$.humanReadableHash)($.Modifiers.Mod+67),statName:"Copy",onExecute:()=>this._chartWidget.chartWidgetCollection().clipboard.uiRequestCopy(o)},"Copy");t.push(e)}return!!o.length},m=()=>{const o=Ho(this._chartWidget,e);return t.push(...o),o.length>0},g=async e=>{if(this._chartWidget.model().isInReplay())return;const o=e.getOrderTemplate();if(null===o)return;const i=(0,A.tradingService)();if(null!==i){const e=i.activeBroker();if(e&&1===e.connectionStatus()&&e.metainfo().configFlags.supportLimitOrders){const l=a.mainSeries(),{symbol:c}=await i.getActualSymbol(l.proSymbol()),{tradable:u}=await e.isTradable(c);if(u){const{qty:{step:i}}=await e.symbolInfo(c);o.symbol=c,o.qty=function(e,t){return(0,r.Big)(e).div(t).round(void 0,0).mul(t).toNumber()}(o.qty,i),t.push(new s.Separator),t.push(function(e){const t=(0,n.ensureNotNull)((0,A.tradingService)());return new s.Action({actionId:"Chart.LineTool.CreateLimitOrderFromState",label:Ye,statName:"CreateLimitOrder",onExecute:()=>{t.trackEvent("Chart Context Menu","RiskRewardCreateLimitOrder"),(0,n.ensureNotNull)(t.brokerCommandsUI()).placeOrder(e)}})}(o))}}else null===e&&(t.push(new s.Separator),t.push((0,n.ensureNotNull)(function(){const e=(0,n.ensureNotNull)((0,A.tradingService)());return new b.TVAction({label:Ye,statName:"ShowSelectBrokerNotification",onExecute:()=>{var t;(0,U.isMobileTradingAvailable)()&&!(null===(t=window.TradingView.bottomWidgetBar)||void 0===t?void 0:t.isVisible().value())?e.toggleTradingPanelPopup():e.toggleTradingWidget(),e.onNeedSelectBroker.fire()}})}())))}},v=e=>{const o=new s.Action({actionId:"Chart.ScrollToLineTool",label:ao.format({lineToolName:e.title(h.TitleDisplayTarget.StatusLine)}),statName:"GoToLineTool",checkable:!1,onExecute:async()=>this._chartWidget.model().scrollToLineTool(e)});t.push(o)},S=e=>{const t=this._chartWidget.model().model().lineToolsGroupModel(),o=e.map((e=>t.groupForLineTool(e)));return new Set(o).size<=1};if(1===e.length){const o=e[0];if(this._chartWidget.readOnly())t.push(i.lineHide);else if(o.userEditEnabled()){if(c.enabled("alerts")&&!this._chartWidget.onWidget())if(o.hasAlert&&o.hasAlert.value())t.push(this._createEditAlertDrawingAction(o)),t.push(new s.Separator);else if(o.canHasAlert()&&o.alertCreationAvailable().value()){const e=Wo(this._chartWidget,{drawing:o});null!==e&&(t.push(e),t.push(new s.Separator))}{
const e=this._createLineToolTemplateAction(o);null!==e&&t.push(e)}l(),u(),this._options.objectTree&&i.paneObjectTree&&t.push(i.paneObjectTree),await g(o),t.push(new s.Separator);let e=d();e=p()||e,e=m()||e,e&&t.push(new s.Separator),t.push(this._createActionToggleLockLineTools([o])),t.push(i.lineHide),t.push(i.lineRemove),o.points().length>0&&this._options.gotoLineTool&&(t.push(new s.Separator),v(o));const n=await this._chartWidget.propertiesDefinitionsForSource(o);if(c.enabled("property_pages")&&null!==n&&(t.push(new s.Separator),t.push(i.format)),o.additionalActions){t.push(new s.Separator);const e=o.additionalActions(this._chartWidget.model());t.push(...e)}}}else this._options.objectTree&&i.paneObjectTree&&t.push(i.paneObjectTree),S(e)&&l(),u(),t.length>0&&t.push(new s.Separator),d(),p(),m(),t.push(new s.Separator),t.push(this._createActionToggleLockLineTools(e)),t.push(i.lineHide),t.push(i.lineRemove),c.enabled("property_pages")&&(t.push(new s.Separator),t.push(i.format));return t}_createEarningsShow(){const e=this._chartWidget.model().mainSeries().properties().childs().esdShowEarnings;return new b.TVAction({label:so,checkable:!0,checked:e.value(),name:"ToggleShowEarnings",statName:"ToggleShowEarnings",onExecute:t=>this._chartWidget.model().setProperty(e,t.isChecked(),fe)})}_createDividendsShow(){const e=this._chartWidget.model().mainSeries().properties().childs().esdShowDividends;return new b.TVAction({label:uo,checkable:!0,checked:e.value(),name:"ToggleShowDividends",statName:"ToggleShowDividends",onExecute:t=>this._chartWidget.model().setProperty(e,t.isChecked(),we)})}_createSplitsShow(){const e=this._chartWidget.model().mainSeries().properties().childs().esdShowSplits;return new b.TVAction({checkable:!0,label:ho,checked:e.value(),name:"ToggleShowSplits",statName:"ToggleShowSplits",onExecute:t=>this._chartWidget.model().setProperty(e,t.isChecked(),Ae)})}_contextMenuActionsForESD(){const e=[];return this._chartWidget.readOnly()||e.push((0,n.ensureNotNull)(this._createDividendsShow()),(0,n.ensureNotNull)(this._createSplitsShow()),(0,n.ensureNotNull)(this._createEarningsShow())),e}_contextMenuActionsForRollDates(){const e=[];if(!this._chartWidget.readOnly()){const t=this._chartWidget.model().mainSeries().properties().childs().showContinuousContractSwitches;e.push(new b.TVAction({label:po,checkable:!0,checked:t.value(),name:"ToggleShowContractSwitches",statName:"ToggleShowContractSwitches",onExecute:e=>this._chartWidget.model().setProperty(t,e.isChecked(),Te)}))}return e}_contextMenuActionsForFuturesContractExpiration(){const e=[];if(!this._chartWidget.readOnly()){const t=this._chartWidget.model().mainSeries().properties().childs().showFuturesContractExpiration;e.push(new b.TVAction({label:mo,checkable:!0,checked:t.value(),name:"ToggleShowFuturesContractExpirations",statName:"ToggleShowFuturesContractExpirations",onExecute:e=>this._chartWidget.model().setProperty(t,e.isChecked(),Me)}))}return e}_contextMenuActionsForisLatestUpdates(){const e=[];if(!this._chartWidget.readOnly()){
const t=this._chartWidget.model().mainSeries().properties().childs().showLastNews;e.push(new b.TVAction({label:go,checkable:!0,checked:t.value(),name:"ToggleShowLatestUpdates",statName:"ToggleShowLatestUpdates",onExecute:e=>this._chartWidget.model().setProperty(t,e.isChecked(),_e)}))}return e}_contextMenuActionsForPublishedTimeline(e){const t=this._chartWidget.actions(),o=[];if(o.push(t.lineHide),window.is_authenticated){const t=e.properties().childs().filter,n=new b.TVAction({checked:t.value()===P.PublishedChartsFilter.None,checkable:!0,label:vo,name:"ToggleAllIdeas",statName:"ToggleAllIdeas",onExecute:()=>this._chartWidget.model().setProperty(t,P.PublishedChartsFilter.None,Ee)}),i=new b.TVAction({checked:t.value()===P.PublishedChartsFilter.Following,checkable:!0,label:So,name:"ToggleIdeasOfPeopleAndUser",statName:"ToggleIdeasOfPeopleAndUser",onExecute:()=>this._chartWidget.model().setProperty(t,P.PublishedChartsFilter.Following,Ce)}),r=new b.TVAction({checked:t.value()===P.PublishedChartsFilter.Private,checkable:!0,label:yo,name:"ToggleUserIdeas",statName:"ToggleUserIdeas",onExecute:()=>this._chartWidget.model().setProperty(t,P.PublishedChartsFilter.Private,ke)});o.push(new s.Separator,n,i,r)}return o}_contextMenuActionsForTradingDrawings(e){return e.contextMenuItems()}async _contextMenuActionsForAlertLabel(e,t){if(!c.enabled("alerts")||this._chartWidget.onWidget())return[];const o=(0,v.getSettingsProperty)().childs().line.childs().visible,n=`chart_alert_context_menu_${null!=t?t:"line"}`;return(0,C.getAlertLabelContextMenuActions)({alert:e,chartWidget:this._chartWidget,labelExtendProperty:o,analytics:{actionLabel:n,actionSource:"chart_alert"}})}_contextMenuActionsForChartEvents(e){const t=[];if(c.enabled("property_pages")){const e=new b.TVAction({label:bo,statName:"Format",onExecute:()=>this._chartWidget.showGeneralChartProperties(m.TabNames.eventsAndAlerts)});t.push(e)}const o=new b.TVAction({label:fo,name:"HideEvents",statName:"HideEvents",onExecute:()=>this._chartWidget.model().setProperty(e.properties().childs().visible,!1,Ne)});return t.push(o),t}_createApplyToEntireLayoutCommand(e){if(!this._chartWidget.chartWidgetCollection().applyIndicatorsToAllChartsAvailable())return null;const t=this._chartWidget.model().model();if(e.parentSources().length>0)return null;const o=(0,n.ensureNotNull)(t.paneForSource(e)),i=t.paneForSource(t.mainSeries())===o,r=e instanceof Q.StudyCompare&&e.priceScale()===t.mainSeries().priceScale()&&(0,n.ensureNotNull)(e.priceScale()).isPercentage(),a=i?void 0:t.panes().indexOf(o);let l=Ao,c=Ie,u="AddStudyToEntireLayout";return(0,re.isActingAsSymbolSource)(e)&&(l=wo,c=Pe,u="AddSymbolToEntireLayout"),(0,p.isStudyStrategy)(e)&&(l=To,c=Le,u="AddStrategyToEntireLayout"),e instanceof G.Fundamental&&(l=Mo,c=xe,u="AddFundamentalToEntireLayout"),new s.Action({actionId:"Chart.AddIndicatorToAllCharts",label:l,statName:u,onExecute:()=>{const o=(0,n.ensureNotNull)((0,ne.clipboardDataForSources)(t.id(),[e])),l=this._chartWidget.chartWidgetCollection(),s={isOnMainPane:i,asCompare:r,paneIndex:a}
;l.applyIndicatorToAllCharts(this._chartWidget,o,s,c)}},"applyStudyToEntireLayout")}}},483307:(e,t,o)=>{o.d(t,{ERL_COUNTRY_CODE:()=>l,EU_COUNTRY_CODE:()=>a,convertCurrenciesToCountryCodes:()=>m,countries:()=>c,countriesToMarketsArray:()=>u,countriesToMarketsMap:()=>s,currenciesByCountryCodes:()=>h,defaultMarkets:()=>p});var n=o(444372),i=o(143517),r=o(244098);const a="eu",l="ERL",c=[{name:n.t(null,void 0,o(476342)),code:"ao",group:i.MarketGroup.MiddleEastAfrica,currency:"AON"},{name:n.t(null,void 0,o(834742)),code:"ar",group:i.MarketGroup.MexicoSouthAmerica,currency:"ARS"},{name:n.t(null,void 0,o(50132)),code:"au",group:i.MarketGroup.AsiaPacific,currency:"AUD"},{name:n.t(null,void 0,o(226505)),code:"at",group:i.MarketGroup.Europe,currency:"ATS"},{name:n.t(null,void 0,o(53260)),code:"bh",group:i.MarketGroup.MiddleEastAfrica,currency:"BHD"},{name:n.t(null,void 0,o(61587)),code:"bd",group:i.MarketGroup.AsiaPacific,currency:"BDT"},{name:n.t(null,void 0,o(637653)),code:"be",group:i.MarketGroup.Europe,currency:"BEF"},{name:n.t(null,void 0,o(746406)),code:"bw",group:i.MarketGroup.MiddleEastAfrica,currency:"BWP"},{name:n.t(null,void 0,o(228867)),code:"br",group:i.MarketGroup.MexicoSouthAmerica,currency:"BRL"},{name:n.t(null,void 0,o(411176)),code:"us",group:i.MarketGroup.NorthAmerica,currency:"USD"},{name:n.t(null,void 0,o(280206)),code:"ca",group:i.MarketGroup.NorthAmerica,currency:"CAD"},{name:n.t(null,void 0,o(141840)),code:"cl",group:i.MarketGroup.MexicoSouthAmerica,currency:"CLP"},{name:n.t(null,void 0,o(420844)),code:"cn",group:i.MarketGroup.AsiaPacific,currency:"CNY"},{name:n.t(null,void 0,o(731144)),code:"co",group:i.MarketGroup.MexicoSouthAmerica,currency:"COP"},{name:n.t(null,void 0,o(551017)),code:"cy",group:i.MarketGroup.Europe,currency:"EUR"},{name:n.t(null,void 0,o(342054)),code:"cz",group:i.MarketGroup.Europe,currency:"CZK"},{name:n.t(null,void 0,o(64901)),code:"dk",group:i.MarketGroup.Europe,currency:"DKK"},{name:n.t(null,void 0,o(205390)),code:"eg",group:i.MarketGroup.MiddleEastAfrica,currency:"EGP"},{name:n.t(null,void 0,o(959823)),code:"ee",group:i.MarketGroup.Europe,currency:"EEK"},{name:n.t(null,void 0,o(698440)),code:"et",group:i.MarketGroup.MiddleEastAfrica,currency:"ETB"},{name:n.t(null,void 0,o(600442)),code:a,group:i.MarketGroup.Europe,currency:r.EUR_CURRENCY},{name:n.t(null,void 0,o(936693)),code:"fi",group:i.MarketGroup.Europe,currency:"FIM"},{name:n.t(null,void 0,o(696013)),code:"fr",group:i.MarketGroup.Europe,currency:"FRF"},{name:n.t(null,void 0,o(159985)),code:"de",group:i.MarketGroup.Europe,currency:"DEM"},{name:n.t(null,void 0,o(848856)),code:"gh",group:i.MarketGroup.MiddleEastAfrica,currency:"GHC"},{name:n.t(null,void 0,o(480411)),code:"gr",group:i.MarketGroup.Europe,currency:"GRD"},{name:n.t(null,void 0,o(532918)),code:"hk",group:i.MarketGroup.AsiaPacific,currency:"HKD"},{name:n.t(null,void 0,o(930646)),code:"hu",group:i.MarketGroup.Europe,currency:"HUF"},{name:n.t(null,void 0,o(664150)),code:"is",group:i.MarketGroup.Europe,currency:"ISK"},{name:n.t(null,void 0,o(16207)),code:"in",
group:i.MarketGroup.AsiaPacific,currency:"INR"},{name:n.t(null,void 0,o(609759)),code:"id",group:i.MarketGroup.AsiaPacific,currency:"IDR"},{name:n.t(null,void 0,o(328408)),code:"ie",group:i.MarketGroup.Europe,currency:"IRP"},{name:n.t(null,void 0,o(261935)),code:"il",group:i.MarketGroup.MiddleEastAfrica,currency:"ILS"},{name:n.t(null,void 0,o(43246)),code:"it",group:i.MarketGroup.Europe,currency:"ITL"},{name:n.t(null,void 0,o(692443)),code:"jp",group:i.MarketGroup.AsiaPacific,currency:"JPY"},{name:n.t(null,void 0,o(89080)),code:"ke",group:i.MarketGroup.MiddleEastAfrica,currency:"KES"},{name:n.t(null,void 0,o(173160)),code:"kr",group:i.MarketGroup.AsiaPacific,currency:"KRW"},{name:n.t(null,void 0,o(872374)),code:"kw",group:i.MarketGroup.MiddleEastAfrica,currency:"KWD"},{name:n.t(null,void 0,o(484045)),code:"lv",group:i.MarketGroup.Europe,currency:"LVR"},{name:n.t(null,void 0,o(529113)),code:"lt",group:i.MarketGroup.Europe,currency:"LTL"},{name:n.t(null,void 0,o(567835)),code:"lk",group:i.MarketGroup.AsiaPacific,currency:"LKR"},{name:n.t(null,void 0,o(652371)),code:"mw",group:i.MarketGroup.AsiaPacific,currency:"MWK"},{name:n.t(null,void 0,o(622622)),code:"my",group:i.MarketGroup.AsiaPacific,currency:"MYR"},{name:n.t(null,void 0,o(902616)),code:"mu",group:i.MarketGroup.MiddleEastAfrica,currency:"MUR"},{name:n.t(null,void 0,o(555087)),code:"mx",group:i.MarketGroup.MexicoSouthAmerica,currency:"MXN"},{name:n.t(null,void 0,o(216641)),code:"ma",group:i.MarketGroup.MiddleEastAfrica,currency:"MAD"},{name:n.t(null,void 0,o(158266)),code:"mz",group:i.MarketGroup.MiddleEastAfrica,currency:"MZM"},{name:n.t(null,void 0,o(714417)),code:"na",group:i.MarketGroup.MiddleEastAfrica,currency:"NAD"},{name:n.t(null,void 0,o(353770)),code:"nl",group:i.MarketGroup.Europe,currency:"NLG"},{name:n.t(null,void 0,o(824143)),code:"nz",group:i.MarketGroup.AsiaPacific,currency:"NZD"},{name:n.t(null,void 0,o(62410)),code:"ng",group:i.MarketGroup.MiddleEastAfrica,currency:"NGN"},{name:n.t(null,void 0,o(145075)),code:"no",group:i.MarketGroup.Europe,currency:"NOK"},{name:n.t(null,void 0,o(552456)),code:"om",group:i.MarketGroup.MiddleEastAfrica,currency:"OMR"},{name:n.t(null,void 0,o(49145)),code:"pk",group:i.MarketGroup.AsiaPacific,currency:"PKR"},{name:n.t(null,void 0,o(622979)),code:"pe",group:i.MarketGroup.MexicoSouthAmerica,currency:"PEN"},{name:n.t(null,void 0,o(226813)),code:"ph",group:i.MarketGroup.AsiaPacific,currency:"PHP"},{name:n.t(null,void 0,o(210119)),code:"pl",group:i.MarketGroup.Europe,currency:"PLZ"},{name:n.t(null,void 0,o(123496)),code:"pt",group:i.MarketGroup.Europe,currency:"PTE"},{name:n.t(null,void 0,o(619056)),code:"qa",group:i.MarketGroup.MiddleEastAfrica,currency:"QAR"},{name:n.t(null,void 0,o(385646)),code:"ro",group:i.MarketGroup.Europe,currency:"RON"},{name:n.t(null,void 0,o(238201)),code:"ru",group:i.MarketGroup.Europe,currency:"RUR"},{name:n.t(null,void 0,o(242890)),code:"rw",group:i.MarketGroup.MiddleEastAfrica,currency:"RWF"},{name:n.t(null,void 0,o(936261)),code:"sa",group:i.MarketGroup.MiddleEastAfrica,currency:"SAR"},{
name:n.t(null,void 0,o(896573)),code:"rs",group:i.MarketGroup.Europe,currency:"RSD"},{name:n.t(null,void 0,o(959609)),code:"sc",group:i.MarketGroup.MiddleEastAfrica,currency:"SCR"},{name:n.t(null,void 0,o(156683)),code:"sg",group:i.MarketGroup.AsiaPacific,currency:"SGD"},{name:n.t(null,void 0,o(506262)),code:"sk",group:i.MarketGroup.Europe,currency:"SKK"},{name:n.t(null,void 0,o(528900)),code:"za",group:i.MarketGroup.MiddleEastAfrica,currency:"ZAR"},{name:n.t(null,void 0,o(792334)),code:"es",group:i.MarketGroup.Europe,currency:"ESP"},{name:n.t(null,void 0,o(182404)),code:"se",group:i.MarketGroup.Europe,currency:"SEK"},{name:n.t(null,void 0,o(440414)),code:"ch",group:i.MarketGroup.Europe,currency:"CHF"},{name:n.t(null,void 0,o(889563)),code:"tw",group:i.MarketGroup.AsiaPacific,currency:"TWD"},{name:n.t(null,void 0,o(185494)),code:"tz",group:i.MarketGroup.MiddleEastAfrica,currency:"TZS"},{name:n.t(null,void 0,o(433138)),code:"th",group:i.MarketGroup.AsiaPacific,currency:"THB"},{name:n.t(null,void 0,o(420638)),code:"tn",group:i.MarketGroup.MiddleEastAfrica,currency:"TND"},{name:n.t(null,void 0,o(694398)),code:"tr",group:i.MarketGroup.MiddleEastAfrica,currency:"TRL"},{name:n.t(null,void 0,o(308395)),code:"ug",group:i.MarketGroup.MiddleEastAfrica,currency:"UGX"},{name:n.t(null,void 0,o(263018)),code:"ua",group:i.MarketGroup.Europe,currency:"UAK"},{name:n.t(null,void 0,o(287916)),code:"ae",group:i.MarketGroup.MiddleEastAfrica,currency:"AED"},{name:n.t(null,void 0,o(606994)),code:"gb",group:i.MarketGroup.Europe,currency:"GBP"},{name:n.t(null,void 0,o(739055)),code:"ve",group:i.MarketGroup.MexicoSouthAmerica,currency:"VEF"},{name:n.t(null,void 0,o(450049)),code:"vn",group:i.MarketGroup.AsiaPacific,currency:"VND"},{name:n.t(null,void 0,o(239478)),code:"zm",group:i.MarketGroup.MiddleEastAfrica,currency:"ZMK"},{name:n.t(null,void 0,o(58309)),code:"zw",group:i.MarketGroup.MiddleEastAfrica,currency:"ZWD"}],s=new Map;for(const e of c)s.set(e.code,{...e,desc:"",value:e.code,country:e.code});const u=Array.from(s.values()),d=new Map,h=new Map;for(const e of c)d.set(e.currency,e.code),h.set(e.code,e.currency);const p=m(r.defaultCurrencies,!1);function m(e,t){const o=[];for(const n of e){const e=n===r.EUR_CURRENCY&&t?l:d.get(n);e&&o.push(e)}return o}},451798:(e,t,o)=>{o.d(t,{magnetEnabled:()=>m,magnetMode:()=>g,setIsMagnetEnabled:()=>v,setMagnetMode:()=>S});var n=o(853965),i=o(401580),r=o(80646),a=o(885482),l=o(616117),c=o(237872);const s=new i.WatchedValue(!1),u=new i.WatchedValue(r.MagnetMode.WeakMagnet),d=(0,c.modifierPressed)(),h=(0,c.shiftPressed)();function p(){const e=d.value();if(h.value()&&(a.isToolEditingNow.value()||a.isToolCreatingNow.value()))return void s.setValue(!1);let t,o;if(a.activePointSelectionMode.value()===a.SelectPointMode.Replay)t=o=!1;else{const n=a.tool.value(),i=a.isStudyEditingNow.value()||a.activePointSelectionMode.value()===a.SelectPointMode.Study;t=e&&((0,l.isLineToolName)(n)||a.isToolEditingNow.value()||(0,a.toolIsMeasure)(n)||i),o=(0,a.properties)().childs().magnet.value()}
u.setValue(!o&&t?r.MagnetMode.StrongMagnet:(0,a.properties)().childs().magnetMode.value()),s.setValue(t?!o:o)}function m(){return s}function g(){return u}function v(e){(0,n.saveDefaultProperties)(!0),(0,a.properties)().childs().magnet.setValue(e),(0,n.saveDefaultProperties)(!1)}function S(e){(0,n.saveDefaultProperties)(!0),(0,a.properties)().childs().magnetMode.setValue(e),(0,a.properties)().childs().magnet.setValue(!0),(0,n.saveDefaultProperties)(!1)}(0,a.runOnDrawingStateReady)((()=>{(0,a.properties)().childs().magnet.subscribe(null,p),(0,a.properties)().childs().magnetMode.subscribe(null,p),d.subscribe(p),h.subscribe(p),a.tool.subscribe(p),a.isToolEditingNow.subscribe(p),p()}))},151519:(e,t,o)=>{o.d(t,{getAlertEditorSource:()=>s});var n=o(624444),i=o(440617),r=o(161488),a=o(982217),l=o(62745),c=o(223284);function s(e){return e?(0,i.isSeries)(e)?u(e):(0,r.isStudyStrategy)(e)?{type:2,...p(e)}:(0,r.isStudy)(e)?d(e):null:null}function u(e){return{type:0,...h(e),isLogScale:()=>e.priceScale().isLog(),symbolInfo:()=>e.symbolInfo()}}function d(e){return{type:1,...p(e),isPine:()=>e.isPine()}}function h(e){return{getSymbolString:()=>e.getSymbolString(),interval:()=>e.interval(),isSpread:()=>e.isSpread(),isCryptoCap:()=>{var t;return"CRYPTOCAP"===(null===(t=e.symbolInfo())||void 0===t?void 0:t.exchange)},formatter:()=>function(e){if(!(e instanceof n.PriceFormatter))throw new Error(`Unsupported formatter type: ${e.constructor.name}`);if(e.isFractional())throw new Error(`Unsupported format of ${e.constructor.name}: fractional`);return e}(e.formatter()),title:()=>e.title(a.TitleDisplayTarget.StatusLine)}}function p(e){return{...h(e.series()),title:()=>e.title(a.TitleDisplayTarget.StatusLine),series:()=>u(e.series()),metaInfo:()=>e.metaInfo(),inputs:()=>function(e){const t=["pineId","pineVersion","text"],o=["price","time","bar_time","color","text_area"],n={};for(const[i,r]of Object.entries(e)){if((0,l.isExtendedInput)(r)&&o.includes(r.t))throw new Error(`Unsupported input type ${r.t}`);t.includes(i)||(n[i]=(0,l.getInputValue)(r))}return n}(e.inputs()),plots:()=>(0,c.plotsForAlert)(e.metaInfo(),e.offset.bind(e)),properties:()=>e.properties(),resolvedSymbolInfoBySymbol:t=>e.resolvedSymbolInfoBySymbol(t),isChildStudy:()=>e.isChildStudy(),ownerSource:()=>s(e.ownerSource()),parentSources:()=>e.parentSources().map(d)}}}}]);