(self.webpackChunktradingview=self.webpackChunktradingview||[]).push([[48774,58566,45840,79274],{130551:(e,t)=>{"use strict";t.hasProperty=t.isObject=void 0,t.isObject=function(e){var t=typeof e;return null!==e&&("object"===t||"function"===t)},t.hasProperty=function(e,t){return t in e}},77046:(e,t,i)=>{"use strict";i.d(t,{default:()=>s});const s=function(e){return function(t){return null==t?void 0:t[e]}}},277973:(e,t,i)=>{"use strict";i.d(t,{default:()=>s});const s=function(e){return null===e}},895171:(e,t,i)=>{"use strict";i.d(t,{default:()=>n});var s=i(745582);const r=function(e,t){var i;if("function"!=typeof t)throw new TypeError("Expected a function");return e=(0,s.default)(e),function(){return--e>0&&(i=t.apply(this,arguments)),e<=1&&(t=void 0),i}};const n=function(e){return r(2,e)}},745582:(e,t,i)=>{"use strict";i.d(t,{default:()=>o});var s=i(968877),r=1/0;const n=function(e){return e?(e=(0,s.default)(e))===r||e===-1/0?17976931348623157e292*(e<0?-1:1):e==e?e:0:0===e?e:0};const o=function(e){var t=n(e),i=t%1;return t==t?i?t-i:t:0}},683135:e=>{e.exports={"tv-spinner__container-rotate":"tv-spinner__container-rotate-aLqboHuu"}},129592:(e,t,i)=>{"use strict";i.d(t,{createGroup:()=>l,keyboardPressedKeysState:()=>a,pressedKeys:()=>o,registerWindow:()=>u,unregisterWindow:()=>d});var s=i(163586),r=i(764250);i(591800);const n=new s.ActionManager,o=n.pressedKeys(),a=n.keyboardPressedKeysState();function l(e){return new r.ActionGroup(n,e)}function u(e){n.listen(e)}function d(e){n.unlisten(e)}},685023:(e,t,i)=>{"use strict";i.d(t,{DEFAULT_SIZE:()=>s,spinnerSizeMap:()=>r});const s="large",r={mini:"xsmall",xsmall:"xsmall",small:"small",medium:"medium",large:"large"}},500521:(e,t,i)=>{"use strict";e.exports.pushChartPage=async function(e){const{default:t}=await Promise.all([i.e(76592),i.e(58755),i.e(36088),i.e(39843),i.e(34873),i.e(33371),i.e(54712),i.e(54765),i.e(25977),i.e(78905),i.e(11595),i.e(34629)]).then(i.t.bind(i,55244,23)),s=new t.ChartPage(e);TradingView.historyManager.push(s)}},607436:(e,t,i)=>{"use strict";i.d(t,{DEFAULT_SIZE:()=>s.DEFAULT_SIZE,spinnerSizeMap:()=>s.spinnerSizeMap});var s=i(685023)},412304:(e,t,i)=>{"use strict";i.d(t,{solutionIds:()=>s});const s=i(162998)},207678:(e,t,i)=>{"use strict";i.d(t,{breakpoints:()=>s,mobileFirstBreakpoints:()=>r,mobileFirstLegacyBreakpoints:()=>n});const s={desktop:1/0,desktopHd:1919,phone:767,"phone-vertical":479,tablet:1019},r={base:0,"media-mf-phone-vertical":320,"media-mf-phone-landscape":568,"media-mf-tablet-vertical":768,"media-mf-tablet-landscape":1024,"media-mf-laptop":1280,"media-mf-desktop-medium":1440,"media-mf-desktop-large":1920,"media-mf-desktop-extra-large":2560},n={"media-mf-legacy-phone-vertical":330,"media-mf-legacy-phone":480,"media-mf-legacy-notebook":1020,"media-mf-legacy-desktop-medium":1480,"media-mf-legacy-desktop":1531}},76107:(e,t,i)=>{"use strict";i.d(t,{getCSSProperty:()=>a,getCSSPropertyNumericValue:()=>l,getContentWidth:()=>n,getScrollbarWidth:()=>s,matchMediaMinMax:()=>r,setStyle:()=>o});const s=(()=>{let e;return()=>{var t;if(void 0===e){
const i=document.createElement("div"),s=i.style;s.visibility="hidden",s.width="100px",s.msOverflowStyle="scrollbar",document.body.appendChild(i);const r=i.offsetWidth;i.style.overflow="scroll";const n=document.createElement("div");n.style.width="100%",i.appendChild(n);const o=n.offsetWidth;null===(t=i.parentNode)||void 0===t||t.removeChild(i),e=r-o}return e}})();function r(e,t){return t===1/0?window.matchMedia(`(min-width: ${e}px)`):window.matchMedia(`(min-width: ${e}px) and (max-width: ${t}px)`)}function n(e){return l(e,"width")-l(e,"padding-left")-l(e,"padding-right")}function o(e,t,i){null!==e&&e.style.setProperty(t,i)}function a(e,t){return getComputedStyle(e,null).getPropertyValue(t)}function l(e,t){return parseInt(a(e,t))}},850775:(e,t,i)=>{"use strict";i.d(t,{mediaState:()=>u});var s=i(685459),r=i.n(s),n=i(49336),o=i(207678),a=i(76107);class l extends(r()){constructor(){super(),this.width=0,this.height=0,this.device=null,this.breakpoints=o.breakpoints,this._checkDevice(),window.addEventListener("resize",this._checkDevice),Object.entries(o.breakpoints).sort((([e,t],[i,s])=>t-s)).forEach((([e,t],i,s)=>{let r;if(0!==i){const[,e]=s[i-1];r=e+1}else r=0;const n=(0,a.matchMediaMinMax)(r,t);n.matches&&this._setNewDevice(e),n.addListener((t=>{t.matches&&(this._checkDevice(),this._setNewDevice(e))}))})),(0,n.whenDocumentReady)(this._checkDevice.bind(this)),this.isPhoneSizeDevice.bind(this)}isPhoneSizeDevice(){return"phone"===this.device||"phone-vertical"===this.device}_checkDevice(){this.width=window.innerWidth,this.height=window.innerHeight}_setNewDevice(e){const t=this.device;this.device=e,this.trigger("changeDevice",[e,t])}}const u=new l},638456:(e,t,i)=>{"use strict";i.r(t),i.d(t,{CheckMobile:()=>c,appVersion:()=>d,checkPageType:()=>_,className:()=>g,desktopAppVersion:()=>u,isChrome:()=>m,isDesktopApp:()=>l,isEdge:()=>v,isFF:()=>f,isLinux:()=>a,isMac:()=>n,isSafari:()=>y,isWindows:()=>o,onGoPro:()=>S,onMainPage:()=>b,onWidget:()=>h,supportTouch:()=>p});var s=i(167175);const r=window.TradingView=window.TradingView||{};function n(){return s.isMac}function o(){return s.isWindows}function a(){return s.isLinux}function l(){return/TVDesktop/i.test(navigator.userAgent)}function u(){const e=navigator.userAgent.match(/TVDesktop\/([^\s]+)/);return e&&e[1]}function d(){const e=navigator.userAgent.match(/TradingView\/([^\s]+)/);return e&&e[1]}const c={Android:()=>s.isAndroid,BlackBerry:()=>s.isBlackBerry,iOS:()=>s.isIOS,Opera:()=>s.isOperaMini,isIPad:()=>s.isIPad,any:()=>s.isAnyMobile};function h(){
const e=["^widgetembed/?$","^cmewidgetembed/?$","^([0-9a-zA-Z-]+)/widgetembed/?$","^([0-9a-zA-Z-]+)/widgetstatic/?$","^([0-9a-zA-Z-]+)?/?mediumwidgetembed/?$","^twitter-chart/?$","^embed/([0-9a-zA-Z]{8})/?$","^widgetpopup/?$","^extension/?$","^idea-popup/?$","^hotlistswidgetembed/?$","^([0-9a-zA-Z-]+)/hotlistswidgetembed/?$","^marketoverviewwidgetembed/?$","^([0-9a-zA-Z-]+)/marketoverviewwidgetembed/?$","^eventswidgetembed/?$","^tickerswidgetembed/?$","^forexcrossrateswidgetembed/?$","^forexheatmapwidgetembed/?$","^marketquoteswidgetembed/?$","^screenerwidget/?$","^cryptomktscreenerwidget/?$","^([0-9a-zA-Z-]+)/cryptomktscreenerwidget/?$","^([0-9a-zA-Z-]+)/marketquoteswidgetembed/?$","^technical-analysis-widget-embed/$","^singlequotewidgetembed/?$","^([0-9a-zA-Z-]+)/singlequotewidgetembed/?$","^embed-widget/([0-9a-zA-Z-]+)/(([0-9a-zA-Z-]+)/)?$"],t=window.location.pathname.replace(/^\//,"");let i;for(let s=e.length-1;s>=0;s--)if(i=new RegExp(e[s]),i.test(t))return!0;return!1}function p(){return s.mobiletouch||s.touch||s.isAnyMobile}function _(e){return new URLSearchParams(window.location.search).get("page_type")===e}r.isMobile=c,r.onWidget=h;const m=s.isChrome,f=s.isFF,v=s.isEdge,y=s.isSafari;function g(e){for(const[t,i]of Object.entries(r))if(i===e)return t;return null}function S(){return"/gopro/"===window.location.pathname}function b(){return"/"===window.location.pathname}r.className=g},39654:(e,t,i)=>{"use strict";i.r(t),i.d(t,{getIsoLanguageCodeFromLanguage:()=>r});const s={ar_AE:"ar",br:"pt",de_DE:"de",ca_ES:"ca",he_IL:"he",id_ID:"id",in:"en",kr:"ko",ms_MY:"ms",sv_SE:"sv",th_TH:"th",uk:"en",vi_VN:"vi",zh_CN:"zh-Hans",zh_TW:"zh-Hant",zh:"zh-Hans"};function r(e){return s[e]||e}},440498:(e,t,i)=>{"use strict";i.d(t,{DELETED_SYMBOLS_LIST_ID:()=>s,isDeletedSymbolsList:()=>r});i(49437),i(738600);const s="deleted_symbols_list_id",r=e=>e===s},279274:(e,t,i)=>{e.exports=[{value:"",name:"All Exchanges",desc:i.tf(null,void 0,i(18383)),flag:"",country:"",group:"AllExchanges",providerId:""},{value:"BISWAP",name:"Biswap (BNB chain)",desc:i.tf(null,void 0,i(612392)),flag:"bitcoin",group:"Cryptocurrency",country:"",providerId:"biswap"},{value:"BITHUMB",name:"Bithumb",desc:i.tf(null,void 0,i(906984)),flag:"bitcoin",group:"Cryptocurrency",country:"",providerId:"bithumb"},{value:"BITKUB",name:"BITKUB",desc:i.tf(null,void 0,i(973073)),flag:"bitcoin",group:"Cryptocurrency",country:"",providerId:"bitkub"},{value:"BITRUE",name:"Bitrue",desc:i.tf(null,void 0,i(921076)),flag:"bitcoin",group:"Cryptocurrency",country:"",providerId:"bitrue"},{value:"COINMETRICS",name:"Coin Metrics",desc:i.tf(null,void 0,i(476804)),flag:"bitcoin",group:"Cryptocurrency",country:"",providerId:"coinmetrics"},{value:"MEXC",name:"MEXC Global",desc:i.tf(null,void 0,i(42257)),flag:"bitcoin",group:"Cryptocurrency",country:"",providerId:"mexc"},{value:"GATEIO",name:"Gate.io",desc:i.tf(null,void 0,i(434055)),flag:"bitcoin",group:"Cryptocurrency",country:"",providerId:"gateio"},{value:"796",name:"796",desc:i.tf(null,void 0,i(883762)),flag:"bitcoin",
group:"Cryptocurrency",hideInSymbolSearch:!0,country:"",providerId:""},{value:"DERIBIT",name:"Deribit",desc:i.tf(null,void 0,i(864518)),flag:"bitcoin",group:"Cryptocurrency",country:"",providerId:"deribit"},{value:"DEFILLAMA",name:"Defi Llama",desc:i.tf(null,void 0,i(70240)),flag:"bitcoin",group:"Cryptocurrency",country:"",providerId:"defillama"},{value:"GLASSNODE",name:"Glassnode",desc:i.tf(null,void 0,i(934859)),flag:"bitcoin",group:"Cryptocurrency",country:"",providerId:"glassnode"},{value:"OKX",name:"OKX",desc:i.tf(null,void 0,i(308995)),flag:"bitcoin",group:"Cryptocurrency",country:"",providerId:"okx"},{value:"OSMOSIS",name:"Osmosis",desc:i.tf(null,void 0,i(220606)),flag:"bitcoin",group:"Cryptocurrency",country:"",providerId:"osmosis"},{value:"PANGOLIN",name:"Pangolin (Avalanche)",desc:i.tf(null,void 0,i(880397)),flag:"bitcoin",group:"Cryptocurrency",country:"",providerId:"pangolin"},{value:"PANCAKESWAP",name:"PancakeSwap (BNB chain)",desc:i.tf(null,void 0,i(672300)),flag:"bitcoin",group:"Cryptocurrency",country:"",providerId:"pancakeswap"},{value:"PYTH",name:"Pyth",desc:i.tf(null,void 0,i(403221)),flag:"bitcoin",group:"Cryptocurrency",country:"",providerId:"pyth"},{value:"SPOOKYSWAP",name:"SpookySwap (Fantom)",desc:i.tf(null,void 0,i(746542)),flag:"bitcoin",group:"Cryptocurrency",country:"",providerId:"spookyswap"},{value:"WAGYUSWAP",name:"Wagyuswap (Velas)",desc:i.tf(null,void 0,i(105845)),flag:"bitcoin",group:"Cryptocurrency",country:"",providerId:"wagyuswap"},{value:"WHITEBIT",name:"WhiteBIT",desc:i.tf(null,void 0,i(592774)),flag:"bitcoin",group:"Cryptocurrency",country:"",providerId:"whitebit"},{value:"WOONETWORK",name:"WOO",desc:i.tf(null,void 0,i(839751)),flag:"bitcoin",group:"Cryptocurrency",country:"",providerId:"woonetwork"},{value:"DYDX",name:"dYdX",desc:i.tf(null,void 0,i(105453)),flag:"bitcoin",group:"Cryptocurrency",country:"",providerId:"dydx"},{value:"VERSEETH",name:"Verse (Ethereum)",desc:i.tf(null,void 0,i(173335)),flag:"bitcoin",group:"Cryptocurrency",country:"",providerId:"verseeth"},{value:"VOLMEX",name:"Volmex",desc:i.tf(null,void 0,i(620656)),flag:"bitcoin",group:"Cryptocurrency",country:"",providerId:"volmex"},{value:"ADX",name:"ADX",desc:i.tf(null,void 0,i(936934)),flag:"ae",group:"Middle East / Africa",country:"ae",providerId:"",searchTerms:[i.tf(null,void 0,i(975308)),i.tf(null,void 0,i(287916))]},{value:"DFM",name:"DFM",desc:i.tf(null,void 0,i(535232)),flag:"ae",group:"Middle East / Africa",country:"ae",providerId:"",searchTerms:[i.tf(null,void 0,i(975308)),i.tf(null,void 0,i(287916))]},{value:"NASDAQDUBAI",name:"NASDAQ",desc:i.tf(null,void 0,i(229359)),flag:"ae",group:"Middle East / Africa",country:"ae",priorityInGroup:1,providerId:"",searchTerms:[i.tf(null,void 0,i(975308)),i.tf(null,void 0,i(287916))]},{value:"LSE",name:"LSE",desc:i.tf(null,void 0,i(454623)),flag:"uk",group:"Europe",country:"uk",providerId:"",searchTerms:[i.tf(null,void 0,i(846792)),i.tf(null,void 0,i(606994))]},{value:"LSIN",name:"LSIN",desc:i.tf(null,void 0,i(249934)),flag:"uk",group:"Europe",country:"uk",
providerId:"",searchTerms:[i.tf(null,void 0,i(846792)),i.tf(null,void 0,i(606994))]},{value:"TURQUOISE",name:"Turquoise",desc:i.tf(null,void 0,i(258419)),flag:"uk",group:"Europe",country:"uk",providerId:"",searchTerms:[i.tf(null,void 0,i(846792)),i.tf(null,void 0,i(606994))]},{value:"FTSE",name:"FTSE",desc:i.tf(null,void 0,i(749711)),flag:"uk",group:"Europe",country:"uk",providerId:"",searchTerms:[i.tf(null,void 0,i(846792)),i.tf(null,void 0,i(606994))]},{value:"EUREX",name:"EUREX",desc:i.tf(null,void 0,i(376029)),flag:"europe",group:"Europe",country:"eu",providerId:""},{value:"MGEX",name:"MGEX",desc:i.tf(null,void 0,i(14406)),flag:"usa",hideInSymbolSearch:!0,group:"North America",country:"us",providerId:"",searchTerms:[i.tf(null,void 0,i(787935)),i.tf(null,void 0,i(216977))]},{value:"NASDAQ",name:"NASDAQ",desc:i.tf(null,void 0,i(227691)),flag:"usa",group:"North America",country:"us",priorityInGroup:1,providerId:"",searchTerms:[i.tf(null,void 0,i(787935)),i.tf(null,void 0,i(216977))]},{value:"NYSE",name:"NYSE",desc:i.tf(null,void 0,i(872667)),flag:"usa",group:"North America",country:"us",priorityInGroup:2,providerId:"",searchTerms:[i.tf(null,void 0,i(787935)),i.tf(null,void 0,i(216977))]},{value:"AMEX",name:"Arca",desc:i.tf(null,void 0,i(468841)),flag:"usa",group:"North America",country:"us",priorityInGroup:3,providerId:"",searchTerms:[i.tf(null,void 0,i(787935)),i.tf(null,void 0,i(216977))]},{value:"OTC",name:"OTC",desc:i.tf(null,void 0,i(448920)),flag:"usa",group:"North America",country:"us",priorityInGroup:4,providerId:"",searchTerms:[i.tf(null,void 0,i(787935)),i.tf(null,void 0,i(216977))]},{value:"DJ",name:"DJ",desc:i.tf(null,void 0,i(623778)),flag:"usa",group:"North America",country:"us",priorityInGroup:5,providerId:"",searchTerms:[i.tf(null,void 0,i(787935)),i.tf(null,void 0,i(216977))]},{value:"SP",name:"SP",desc:i.tf(null,void 0,i(662397)),flag:"usa",group:"North America",country:"us",priorityInGroup:6,providerId:"",searchTerms:[i.tf(null,void 0,i(787935)),i.tf(null,void 0,i(216977))]},{value:"CBOE",name:"CBOE",desc:i.tf(null,void 0,i(1596)),flag:"usa",group:"North America",country:"us",priorityInGroup:7,providerId:"",searchTerms:[i.tf(null,void 0,i(787935)),i.tf(null,void 0,i(216977))]},{value:"CBOEEU",name:"CBOE EU",desc:i.tf(null,void 0,i(975674)),flag:"europe",group:"Europe",country:"eu",providerId:""},{value:"CBOT",name:"CBOT",desc:i.tf(null,void 0,i(581563)),flag:"usa",group:"North America",country:"us",priorityInGroup:8,providerId:"",searchTerms:[i.tf(null,void 0,i(787935)),i.tf(null,void 0,i(216977))]},{value:"CME",name:"CME GLOBEX",desc:i.tf(null,void 0,i(425193)),flag:"usa",group:"North America",country:"us",priorityInGroup:9,providerId:"",searchTerms:[i.tf(null,void 0,i(787935)),i.tf(null,void 0,i(216977))]},{value:"COMEX",name:"COMEX",desc:i.tf(null,void 0,i(584533)),flag:"usa",group:"North America",country:"us",priorityInGroup:10,providerId:"",searchTerms:[i.tf(null,void 0,i(787935)),i.tf(null,void 0,i(216977))]},{value:"NYMEX",name:"NYMEX",desc:i.tf(null,void 0,i(336499)),flag:"usa",
group:"North America",country:"us",priorityInGroup:11,providerId:"",searchTerms:[i.tf(null,void 0,i(787935)),i.tf(null,void 0,i(216977))]},{value:"ICEUS",name:"ICEUS",desc:i.tf(null,void 0,i(403509)),flag:"usa",group:"North America",country:"us",priorityInGroup:12,providerId:"",searchTerms:[i.tf(null,void 0,i(787935)),i.tf(null,void 0,i(216977))]},{value:"FAIRX",name:"FairX",desc:i.tf(null,void 0,i(187464)),flag:"usa",group:"North America",country:"us",priorityInGroup:13,providerId:"",searchTerms:[i.tf(null,void 0,i(787935)),i.tf(null,void 0,i(216977))]},{value:"CSE",name:"CSE",desc:i.tf(null,void 0,i(465782)),flag:"canada",group:"North America",country:"ca",priorityInGroup:13,providerId:"",searchTerms:[i.tf(null,void 0,i(280206))]},{value:"NEO",name:"NEO",desc:i.tf(null,void 0,i(278436)),flag:"canada",group:"North America",country:"ca",priorityInGroup:14,providerId:"",searchTerms:[i.tf(null,void 0,i(280206))]},{value:"TSX",name:"TSX",desc:i.tf(null,void 0,i(949042)),flag:"canada",group:"North America",country:"ca",priorityInGroup:15,providerId:"",searchTerms:[i.tf(null,void 0,i(280206))]},{value:"TSXV",name:"TSXV",desc:i.tf(null,void 0,i(12815)),flag:"canada",group:"North America",country:"ca",priorityInGroup:16,providerId:"",searchTerms:[i.tf(null,void 0,i(280206))]},{value:"MOEX",name:"MOEX",desc:i.tf(null,void 0,i(73467)),flag:"russia",group:"Europe",country:"ru",providerId:"",searchTerms:[i.tf(null,void 0,i(238201))]},{value:"MYX",name:"MYX",desc:i.tf(null,void 0,i(887964)),flag:"malaysia",group:"Asia / Pacific",country:"my",providerId:"",searchTerms:[i.tf(null,void 0,i(622622))]},{value:"FTSEMYX",name:"FTSE",desc:i.tf(null,void 0,i(40698)),flag:"malaysia",group:"Asia / Pacific",country:"my",providerId:"",searchTerms:[i.tf(null,void 0,i(622622))]},{value:"HOSE",name:"HOSE",desc:i.tf(null,void 0,i(34416)),flag:"vietnam",group:"Asia / Pacific",country:"vn",providerId:"",searchTerms:[i.tf(null,void 0,i(450049))]},{value:"HNX",name:"HNX",desc:i.tf(null,void 0,i(653194)),flag:"vietnam",group:"Asia / Pacific",country:"vn",providerId:"",searchTerms:[i.tf(null,void 0,i(450049))]},{value:"UPCOM",name:"HNX UPCoM",desc:i.tf(null,void 0,i(696591)),flag:"vietnam",group:"Asia / Pacific",country:"vn",providerId:"",searchTerms:[i.tf(null,void 0,i(450049))]},{value:"CSELK",name:"CSE",desc:i.tf(null,void 0,i(429971)),flag:"sri_lanka",group:"Asia / Pacific",country:"lk",providerId:"",searchTerms:[i.tf(null,void 0,i(567835))]},{value:"BITSTAMP",name:"Bitstamp",desc:i.tf(null,void 0,i(42285)),flag:"bitcoin",group:"Cryptocurrency",country:"",providerId:"bitstamp"},{value:"ACTIVTRADES",name:"ActivTrades",desc:i.tf(null,void 0,i(34342)),flag:"forex",group:"Forex",country:"",providerId:"activtrades"},{value:"BLACKBULL",name:"BlackBull Markets",desc:i.tf(null,void 0,i(802620)),flag:"forex",group:"Forex",country:"",providerId:"blackbullmarkets"},{value:"VANTAGE",name:"Vantage",desc:i.tf(null,void 0,i(606582)),flag:"forex",group:"Forex",country:"",providerId:"vantagefx"},{value:"VELOCITY",name:"Velocity Trade",
desc:i.tf(null,void 0,i(650469)),flag:"forex",group:"Forex",country:"",providerId:"velocitytrade"},{value:"FX",name:"FXCM",desc:i.tf(null,void 0,i(592901)),flag:"forex",group:"Forex",country:"",providerId:"fxcm"},{value:"FXOPEN",name:"FXOpen",desc:i.tf(null,void 0,i(638398)),flag:"forex",group:"Forex",country:"",providerId:"fxopen"},{value:"EIGHTCAP",name:"Eightcap",desc:i.tf(null,void 0,i(910807)),flag:"forex",group:"Forex",country:"",providerId:"eightcap"},{value:"BTCE",name:"BTC-e",desc:i.tf(null,void 0,i(675334)),flag:"bitcoin",group:"Cryptocurrency",hideInSymbolSearch:!0,country:"",providerId:""},{value:"HONEYSWAP",name:"Honeyswap (xDai)",desc:i.tf(null,void 0,i(499767)),flag:"bitcoin",group:"Cryptocurrency",country:"",providerId:"honeyswap"},{value:"HONEYSWAPPOLYGON",name:"Honeyswap (Polygon)",desc:i.tf(null,void 0,i(880739)),flag:"bitcoin",group:"Cryptocurrency",country:"",providerId:"honeyswap"},{value:"BSE",name:"BSE",desc:i.tf(null,void 0,i(799931)),flag:"india",group:"Asia / Pacific",country:"in",providerId:"",searchTerms:[i.tf(null,void 0,i(16207))]},{value:"NYMEX_MINI",name:"NYMEX E-mini",desc:i.tf(null,void 0,i(232852)),flag:"usa",group:"North America",hideInSymbolSearch:!0,country:"us",providerId:"",searchTerms:[i.tf(null,void 0,i(787935)),i.tf(null,void 0,i(216977))]},{value:"COMEX_MINI",name:"COMEX E-mini",desc:i.tf(null,void 0,i(695270)),flag:"usa",group:"North America",hideInSymbolSearch:!0,country:"us",providerId:"",searchTerms:[i.tf(null,void 0,i(787935)),i.tf(null,void 0,i(216977))]},{value:"ICEEUR",name:"ICEEUR",desc:i.tf(null,void 0,i(947701)),flag:"europe",group:"Europe",country:"eu",providerId:""},{value:"NSE",name:"NSE",desc:i.tf(null,void 0,i(803867)),flag:"india",group:"Asia / Pacific",country:"in",providerId:"",searchTerms:[i.tf(null,void 0,i(16207))]},{value:"MCX",name:"MCX",desc:i.tf(null,void 0,i(753577)),flag:"india",group:"Asia / Pacific",country:"in",providerId:"",searchTerms:[i.tf(null,void 0,i(16207))]},{value:"NCDEX",name:"NCDEX",desc:i.tf(null,void 0,i(915091)),flag:"india",group:"Asia / Pacific",country:"in",providerId:"",searchTerms:[i.tf(null,void 0,i(16207))]},{value:"KCBT",name:"KCBT",desc:i.tf(null,void 0,i(610871)),flag:"usa",hideInSymbolSearch:!0,group:"North America",country:"us",providerId:"",searchTerms:[i.tf(null,void 0,i(787935)),i.tf(null,void 0,i(216977))]},{value:"OKCOIN",name:"OKCoin",desc:i.tf(null,void 0,i(798361)),flag:"bitcoin",group:"Cryptocurrency",country:"",providerId:"okcoin"},{value:"CBOT_MINI",name:"CBOT E-mini",desc:i.tf(null,void 0,i(123780)),flag:"usa",group:"North America",hideInSymbolSearch:!0,country:"us",providerId:"",searchTerms:[i.tf(null,void 0,i(787935)),i.tf(null,void 0,i(216977))]},{value:"KRAKEN",name:"Kraken",desc:i.tf(null,void 0,i(961932)),flag:"bitcoin",group:"Cryptocurrency",country:"",providerId:"kraken"},{value:"KUCOIN",name:"KuCoin",desc:i.tf(null,void 0,i(850627)),flag:"bitcoin",group:"Cryptocurrency",country:"",providerId:"kucoin"},{value:"XEXCHANGE",name:"xExchange",desc:i.tf(null,void 0,i(734830)),flag:"bitcoin",
group:"Cryptocurrency",country:"",providerId:"xexchange"},{value:"CME_MINI",name:"CME E-mini",desc:i.tf(null,void 0,i(378106)),flag:"usa",group:"North America",hideInSymbolSearch:!0,country:"us",providerId:"",searchTerms:[i.tf(null,void 0,i(787935)),i.tf(null,void 0,i(216977))]},{value:"DJ",name:"DJ",desc:i.tf(null,void 0,i(973151)),flag:"usa",hideInSymbolSearch:!0,group:"North America",country:"us",providerId:"",searchTerms:[i.tf(null,void 0,i(787935)),i.tf(null,void 0,i(216977))]},{value:"SP",name:"SP",desc:i.tf(null,void 0,i(869919)),flag:"usa",hideInSymbolSearch:!0,group:"North America",country:"us",providerId:"",searchTerms:[i.tf(null,void 0,i(787935)),i.tf(null,void 0,i(216977))]},{value:"BTCCHINA",name:"BTC China",desc:i.tf(null,void 0,i(599193)),flag:"bitcoin",group:"Cryptocurrency",hideInSymbolSearch:!0,country:"",providerId:""},{value:"TIMEX",name:"TimeX",desc:i.tf(null,void 0,i(773557)),flag:"bitcoin",group:"Cryptocurrency",country:"",providerId:"timex"},{value:"ANX",name:"ANX",desc:i.tf(null,void 0,i(198372)),flag:"bitcoin",group:"Cryptocurrency",hideInSymbolSearch:!0,country:"",providerId:""},{value:"MEXBT",name:"meXBT",desc:i.tf(null,void 0,i(668490)),flag:"bitcoin",group:"Cryptocurrency",hideInSymbolSearch:!0,country:"",providerId:""},{value:"GEMINI",name:"Gemini",desc:i.tf(null,void 0,i(201367)),flag:"bitcoin",group:"Cryptocurrency",country:"",providerId:"gemini"},{value:"BITVC",name:"BitVC",desc:i.tf(null,void 0,i(357531)),flag:"bitcoin",group:"Cryptocurrency",hideInSymbolSearch:!0,country:"",providerId:""},{value:"BITYES",name:"BitYes",desc:i.tf(null,void 0,i(945663)),flag:"bitcoin",group:"Cryptocurrency",hideInSymbolSearch:!0,country:"",providerId:""},{value:"BNC",name:"BNC",desc:i.tf(null,void 0,i(364180)),flag:"bitcoin",group:"Cryptocurrency",hideInSymbolSearch:!0,country:"",providerId:""},{value:"BITFLYER",name:"bitFlyer",desc:i.tf(null,void 0,i(704862)),flag:"bitcoin",group:"Cryptocurrency",country:"",providerId:"bitflyer"},{value:"BITBNS",name:"Bitbns",desc:i.tf(null,void 0,i(26649)),flag:"bitcoin",group:"Cryptocurrency",country:"",providerId:"bitbns"},{value:"BYBIT",name:"Bybit",desc:i.tf(null,void 0,i(801800)),flag:"bitcoin",group:"Cryptocurrency",country:"",providerId:"bybit"},{value:"BITMEX",name:"BitMEX",desc:i.tf(null,void 0,i(890561)),flag:"bitcoin",group:"Cryptocurrency",country:"",providerId:"bitmex"},{value:"BITPANDAPRO",name:"Bitpanda Pro",desc:i.tf(null,void 0,i(555437)),flag:"bitcoin",group:"Cryptocurrency",country:"",providerId:"bitpanda"},{value:"CAPITALCOM",name:"Capital.com",desc:i.tf(null,void 0,i(148674)),flag:"forex",group:"Forex",country:"",providerId:"capitalcom"},{value:"COINEX",name:"CoinEx",desc:i.tf(null,void 0,i(328681)),flag:"bitcoin",group:"Cryptocurrency",country:"",providerId:"coinex"},{value:"INTOTHEBLOCK",name:"IntoTheBlock",desc:i.tf(null,void 0,i(830996)),flag:"bitcoin",group:"Cryptocurrency",country:"",providerId:"intotheblock"},{value:"EASYMARKETS",name:"easyMarkets",desc:i.tf(null,void 0,i(339210)),flag:"forex",group:"Forex",country:"",
providerId:"easymarkets"},{value:"FOREXCOM",name:"FOREX.com",desc:i.tf(null,void 0,i(395068)),flag:"forex",group:"Forex",country:"",providerId:"gain"},{value:"FX_IDC",name:"ICE",desc:i.tf(null,void 0,i(89446)),flag:"forex",group:"Forex",country:"",providerId:"ice"},{value:"IBKR",name:"Interactive Brokers",desc:i.tf(null,void 0,i(508662)),flag:"forex",group:"Forex",country:"",providerId:"ibkr"},{value:"IBROKER",name:"iBroker",desc:i.tf(null,void 0,i(51966)),flag:"forex",group:"Forex",country:"",providerId:"ibroker"},{value:"BITFINEX",name:"Bitfinex",desc:i.tf(null,void 0,i(572762)),flag:"bitcoin",group:"Cryptocurrency",country:"",providerId:"bitfinex"},{value:"MTGOX",name:"Mt.Gox",desc:i.tf(null,void 0,i(808754)),flag:"bitcoin",group:"Cryptocurrency",hideInSymbolSearch:!0,country:"",providerId:"mtgox"},{value:"PHEMEX",name:"Phemex",desc:i.tf(null,void 0,i(972718)),flag:"bitcoin",group:"Cryptocurrency",country:"",providerId:"phemex"},{value:"POLONIEX",name:"Poloniex",desc:i.tf(null,void 0,i(311014)),flag:"bitcoin",group:"Cryptocurrency",country:"",providerId:"poloniex"},{value:"QUICKSWAP",name:"QuickSwap (Polygon)",desc:i.tf(null,void 0,i(478675)),flag:"bitcoin",group:"Cryptocurrency",country:"",providerId:"quickswap"},{value:"SUSHISWAP",name:"SushiSwap (Ethereum)",desc:i.tf(null,void 0,i(656920)),flag:"bitcoin",group:"Cryptocurrency",country:"",providerId:"sushiswap"},{value:"SUSHISWAPPOLYGON",name:"SushiSwap (Polygon)",desc:i.tf(null,void 0,i(568905)),flag:"bitcoin",group:"Cryptocurrency",country:"",providerId:"sushiswap"},{value:"TRADERJOE",name:"Trader Joe (Avalanche)",desc:i.tf(null,void 0,i(319746)),flag:"bitcoin",group:"Cryptocurrency",country:"",providerId:"traderjoe"},{value:"TRADESTATION",name:"TradeStation",desc:i.tf(null,void 0,i(437523)),flag:"bitcoin",group:"Cryptocurrency",country:"",providerId:"tradestation"},{value:"UNISWAP",name:"Uniswap v2 (Ethereum)",desc:i.tf(null,void 0,i(725990)),flag:"bitcoin",group:"Cryptocurrency",country:"",providerId:"uniswap"},{value:"UNISWAP3ETH",name:"Uniswap v3 (Ethereum)",desc:i.tf(null,void 0,i(670485)),flag:"bitcoin",group:"Cryptocurrency",country:"",providerId:"uniswap3"},{value:"UNISWAP3POLYGON",name:"Uniswap v3 (Polygon)",desc:i.tf(null,void 0,i(506595)),flag:"bitcoin",group:"Cryptocurrency",country:"",providerId:"uniswap3"},{value:"UNISWAP3ARBITRUM",name:"Uniswap v3 (Arbitrum)",desc:i.tf(null,void 0,i(419861)),flag:"bitcoin",group:"Cryptocurrency",country:"",providerId:"uniswap3"},{value:"UNISWAP3OPTIMISM",name:"Uniswap v3 (Optimism)",desc:i.tf(null,void 0,i(754635)),flag:"bitcoin",group:"Cryptocurrency",country:"",providerId:"uniswap3"},{value:"UPBIT",name:"UpBit",desc:i.tf(null,void 0,i(310430)),flag:"bitcoin",group:"Cryptocurrency",country:"",providerId:"upbit"},{value:"BINGX",name:"BingX",desc:i.tf(null,void 0,i(932032)),flag:"bitcoin",group:"Cryptocurrency",country:"",providerId:"bingx"},{value:"BTSE",name:"BTSE",desc:i.tf(null,void 0,i(621363)),flag:"bitcoin",group:"Cryptocurrency",country:"",providerId:"btse"},{value:"BITTREX",name:"Bittrex",
desc:i.tf(null,void 0,i(611622)),flag:"bitcoin",group:"Cryptocurrency",country:"",providerId:"bittrex"},{value:"BINANCE",name:"Binance",desc:i.tf(null,void 0,i(778260)),flag:"bitcoin",group:"Cryptocurrency",country:"",providerId:"binance"},{value:"BITGET",name:"Bitget",desc:i.tf(null,void 0,i(151805)),flag:"bitcoin",group:"Cryptocurrency",country:"",providerId:"bitget"},{value:"BINANCEUS",name:"Binance US",desc:i.tf(null,void 0,i(376868)),flag:"bitcoin",group:"Cryptocurrency",country:"",providerId:"binance"},{value:"DELTA",name:"Delta",desc:i.tf(null,void 0,i(527223)),flag:"bitcoin",group:"Cryptocurrency",country:"",providerId:"delta"},{value:"BCBA",name:"BYMA",desc:i.tf(null,void 0,i(731613)),flag:"argentina",group:"Mexico and South America",country:"ar",providerId:"",searchTerms:[i.tf(null,void 0,i(834742))]},{value:"MATBAROFEX",name:"ROFEX",desc:i.tf(null,void 0,i(477911)),flag:"argentina",group:"Mexico and South America",country:"ar",providerId:"",searchTerms:[i.tf(null,void 0,i(834742))]},{value:"BMFBOVESPA",name:"B3",desc:i.tf(null,void 0,i(866247)),flag:"brasil",group:"Mexico and South America",country:"br",providerId:"",searchTerms:[i.tf(null,void 0,i(228867))]},{value:"BMV",name:"BMV",desc:i.tf(null,void 0,i(203947)),flag:"mexico",group:"Mexico and South America",country:"mx",providerId:"",searchTerms:[i.tf(null,void 0,i(555087))]},{value:"BVL",name:"BVL",desc:i.tf(null,void 0,i(505138)),flag:"peru",group:"Mexico and South America",country:"pe",providerId:"",searchTerms:[i.tf(null,void 0,i(622979))]},{value:"BCS",name:"SSE",desc:i.tf(null,void 0,i(949722)),flag:"chile",group:"Mexico and South America",country:"cl",providerId:"",searchTerms:[i.tf(null,void 0,i(141840))]},{value:"BVC",name:"BVC",desc:i.tf(null,void 0,i(388142)),flag:"colombia",group:"Mexico and South America",country:"co",providerId:"",searchTerms:[i.tf(null,void 0,i(731144))]},{value:"BVCV",name:"BVC",desc:i.tf(null,void 0,i(478271)),flag:"venezuela",group:"Mexico and South America",country:"ve",providerId:"",searchTerms:[i.tf(null,void 0,i(739055))]},{value:"NAG",name:"NSE",desc:i.tf(null,void 0,i(862549)),flag:"japan",group:"Asia / Pacific",country:"jp",providerId:"",searchTerms:[i.tf(null,void 0,i(692443))]},{value:"TSE",name:"TSE",desc:i.tf(null,void 0,i(453617)),flag:"japan",group:"Asia / Pacific",country:"jp",providerId:"",searchTerms:[i.tf(null,void 0,i(692443))]},{value:"TFEX",name:"TFEX",desc:i.tf(null,void 0,i(197400)),flag:"thailand",group:"Asia / Pacific",country:"th",providerId:"",searchTerms:[i.tf(null,void 0,i(433138))]},{value:"TFX",name:"TFX",desc:i.tf(null,void 0,i(753572)),flag:"japan",group:"Asia / Pacific",country:"jp",providerId:"",searchTerms:[i.tf(null,void 0,i(692443))]},{value:"TOCOM",name:"TOCOM",desc:i.tf(null,void 0,i(30453)),flag:"japan",group:"Asia / Pacific",country:"jp",providerId:"",searchTerms:[i.tf(null,void 0,i(692443))]},{value:"OSE",name:"OSE",desc:i.tf(null,void 0,i(517199)),flag:"japan",group:"Asia / Pacific",country:"jp",providerId:"",searchTerms:[i.tf(null,void 0,i(692443))]},{value:"SGX",name:"SGX",
desc:i.tf(null,void 0,i(919973)),flag:"singapore",group:"Asia / Pacific",country:"sg",providerId:"",searchTerms:[i.tf(null,void 0,i(156683))]},{value:"ICESG",name:"ICE Futures Singapore",desc:i.tf(null,void 0,i(448044)),flag:"singapore",group:"Asia / Pacific",country:"sg",providerId:"",searchTerms:[i.tf(null,void 0,i(156683))]},{value:"FTSEST",name:"FTSE ST",desc:i.tf(null,void 0,i(582927)),flag:"singapore",group:"Asia / Pacific",country:"sg",providerId:"",searchTerms:[i.tf(null,void 0,i(156683))]},{value:"SAPSE",name:"SSE",desc:i.tf(null,void 0,i(253961)),flag:"japan",group:"Asia / Pacific",country:"jp",providerId:"",searchTerms:[i.tf(null,void 0,i(692443))]},{value:"FSE",name:"FSE",desc:i.tf(null,void 0,i(461659)),flag:"japan",group:"Asia / Pacific",country:"jp",providerId:"",searchTerms:[i.tf(null,void 0,i(692443))]},{value:"TPEX",name:"TPEx",desc:i.tf(null,void 0,i(215751)),flag:"taiwan",group:"Asia / Pacific",country:"tw",providerId:"",searchTerms:[i.tf(null,void 0,i(460919))]},{value:"TAIFEX",name:"TAIFEX",desc:i.tf(null,void 0,i(686094)),flag:"taiwan",group:"Asia / Pacific",country:"tw",providerId:"",searchTerms:[i.tf(null,void 0,i(460919))]},{value:"TWSE",name:"TWSE",desc:i.tf(null,void 0,i(974013)),flag:"taiwan",group:"Asia / Pacific",country:"tw",providerId:"",searchTerms:[i.tf(null,void 0,i(460919))]},{value:"SET",name:"SET",desc:i.tf(null,void 0,i(905107)),flag:"thailand",group:"Asia / Pacific",country:"th",providerId:"",searchTerms:[i.tf(null,void 0,i(433138))]},{value:"KRX",name:"KRX",desc:i.tf(null,void 0,i(116699)),flag:"south_korea",group:"Asia / Pacific",country:"kr",providerId:"",searchTerms:[i.tf(null,void 0,i(173160))]},{value:"BAHRAIN",name:"BHB",desc:i.tf(null,void 0,i(98343)),flag:"bahrain",group:"Middle East / Africa",country:"bh",providerId:"",searchTerms:[i.tf(null,void 0,i(53260))]},{value:"KSE",name:"KSE",desc:i.tf(null,void 0,i(542319)),flag:"kuwait",group:"Middle East / Africa",country:"kw",providerId:"",searchTerms:[i.tf(null,void 0,i(872374))]},{value:"CSECY",name:"CSE",desc:i.tf(null,void 0,i(4287)),flag:"cyprus",group:"Europe",country:"cy",providerId:"",searchTerms:[i.tf(null,void 0,i(551017))]},{value:"BVMT",name:"BVMT",desc:i.tf(null,void 0,i(923628)),flag:"tunisia",group:"Middle East / Africa",country:"tn",providerId:"",searchTerms:[i.tf(null,void 0,i(420638))]},{value:"ATHEX",name:"ATHEX",desc:i.tf(null,void 0,i(852002)),flag:"greece",group:"Europe",country:"gr",providerId:""},{value:"BELEX",name:"BELEX",desc:i.tf(null,void 0,i(525246)),flag:"serbia",group:"Europe",country:"rs",providerId:"",searchTerms:[i.tf(null,void 0,i(896573))]},{value:"EGX",name:"EGX",desc:i.tf(null,void 0,i(493792)),flag:"egypt",group:"Middle East / Africa",country:"eg",providerId:"",searchTerms:[i.tf(null,void 0,i(205390))]},{value:"TADAWUL",name:"Tadawul",desc:i.tf(null,void 0,i(807722)),flag:"saudi_arabia",group:"Middle East / Africa",country:"sa",providerId:"",searchTerms:[i.tf(null,void 0,i(936261))]},{value:"CSEMA",name:"CSE",desc:i.tf(null,void 0,i(88329)),flag:"morocco",
group:"Middle East / Africa",country:"ma",providerId:"",searchTerms:[i.tf(null,void 0,i(216641))]},{value:"IDX",name:"IDX",desc:i.tf(null,void 0,i(75088)),flag:"indonesia",group:"Asia / Pacific",country:"id",providerId:"",searchTerms:[i.tf(null,void 0,i(609759))]},{value:"HSI",name:"HSI",desc:i.tf(null,void 0,i(259952)),flag:"hong_kong",group:"Asia / Pacific",country:"hk",providerId:"",searchTerms:[i.tf(null,void 0,i(532918))]},{value:"QSE",name:"QSE",desc:i.tf(null,void 0,i(844449)),flag:"qatar",group:"Middle East / Africa",country:"qa",providerId:"",searchTerms:[i.tf(null,void 0,i(619056))]},{value:"OANDA",name:"OANDA",desc:i.tf(null,void 0,i(398585)),flag:"forex",group:"Forex",country:"",providerId:"oanda"},{value:"SAXO",name:"Saxo",desc:i.tf(null,void 0,i(780276)),flag:"forex",group:"Forex",country:"",providerId:"saxobank"},{value:"PEPPERSTONE",name:"Pepperstone",desc:i.tf(null,void 0,i(341557)),flag:"forex",group:"Forex",country:"",providerId:"pepperstone"},{value:"PHILLIPNOVA",name:"Phillip Nova",desc:i.tf(null,void 0,i(574893)),flag:"forex",group:"Forex",country:"",providerId:"phillipnova"},{value:"SKILLING",name:"SKILLING",desc:i.tf(null,void 0,i(434119)),flag:"forex",group:"Forex",country:"",providerId:"skilling"},{value:"SPREADEX",name:"Spreadex",desc:i.tf(null,void 0,i(822963)),flag:"forex",group:"Forex",country:"",providerId:"spreadex"},{value:"EURONEXT",name:"Euronext",desc:i.tf(null,void 0,i(70082)),flag:"europe",group:"Europe",country:"eu",providerId:""},{value:"EURONEXTAMS",name:"EURONEXTAMS",desc:i.tf(null,void 0,i(841444)),flag:"netherlands",group:"Europe",country:"nl",providerId:"",searchTerms:[i.tf(null,void 0,i(353770))]},{value:"EURONEXTBRU",name:"EURONEXTBRU",desc:i.tf(null,void 0,i(166201)),flag:"belgium",group:"Europe",country:"be",providerId:"",searchTerms:[i.tf(null,void 0,i(637653))]},{value:"EURONEXTLIS",name:"EURONEXTLIS",desc:i.tf(null,void 0,i(232729)),flag:"portugal",group:"Europe",country:"pt",providerId:"",searchTerms:[i.tf(null,void 0,i(123496))]},{value:"EURONEXTPAR",name:"EURONEXTPAR",desc:i.tf(null,void 0,i(515894)),flag:"france",group:"Europe",country:"fr",providerId:"",searchTerms:[i.tf(null,void 0,i(696013))]},{value:"OSL",name:"EURONEXTOSE",desc:i.tf(null,void 0,i(255361)),flag:"norway",group:"Europe",country:"no",providerId:"",searchTerms:[i.tf(null,void 0,i(145075))]},{value:"OMX",name:"OMX",desc:i.tf(null,void 0,i(74125)),flag:"europe",group:"Europe",country:"eu",providerId:""},{value:"FWB",name:"FWB",desc:i.tf(null,void 0,i(670183)),flag:"germany",group:"Europe",country:"de",providerId:"",searchTerms:[i.tf(null,void 0,i(159985))]},{value:"FRA",name:"FRA",desc:i.tf(null,void 0,i(551785)),flag:"germany",hideInSymbolSearch:!0,group:"Europe",country:"de",providerId:"",searchTerms:[i.tf(null,void 0,i(159985))]},{value:"SWB",name:"SWB",desc:i.tf(null,void 0,i(17644)),flag:"germany",group:"Europe",country:"de",providerId:"",searchTerms:[i.tf(null,void 0,i(159985))]},{value:"XETR",name:"XETR",desc:i.tf(null,void 0,i(141173)),flag:"germany",group:"Europe",country:"de",
providerId:"",searchTerms:[i.tf(null,void 0,i(159985))]},{value:"BME",name:"BME",desc:i.tf(null,void 0,i(889143)),flag:"spain",group:"Europe",country:"es",providerId:"",searchTerms:[i.tf(null,void 0,i(792334))]},{value:"BSSE",name:"BSSE",desc:i.tf(null,void 0,i(433137)),flag:"slovakia",group:"Europe",country:"sk",providerId:"",searchTerms:[i.tf(null,void 0,i(506262))]},{value:"BVB",name:"BVB",desc:i.tf(null,void 0,i(273573)),flag:"romania",group:"Europe",country:"ro",providerId:"",searchTerms:[i.tf(null,void 0,i(385646))]},{value:"BET",name:"BET",desc:i.tf(null,void 0,i(386479)),flag:"hungary",group:"Europe",country:"hu",providerId:"",searchTerms:[i.tf(null,void 0,i(930646))]},{value:"GPW",name:"GPW",desc:i.tf(null,void 0,i(128008)),flag:"poland",group:"Europe",country:"pl",providerId:"",searchTerms:[i.tf(null,void 0,i(210119))]},{value:"NEWCONNECT",name:"GPW — NewConnect",desc:i.tf(null,void 0,i(253127)),flag:"poland",group:"Europe",country:"pl",providerId:"",searchTerms:[i.tf(null,void 0,i(210119))]},{value:"LUXSE",name:"LUXSE",desc:i.tf(null,void 0,i(299724)),flag:"luxembourg",group:"Europe",country:"lu",providerId:"",searchTerms:[i.tf(null,void 0,i(164352))]},{value:"MIL",name:"MIL",desc:i.tf(null,void 0,i(16930)),flag:"italy",group:"Europe",country:"it",providerId:"",searchTerms:[i.tf(null,void 0,i(43246))]},{value:"NGM",name:"NGM",desc:i.tf(null,void 0,i(414327)),flag:"sweden",group:"Europe",country:"se",providerId:"",searchTerms:[i.tf(null,void 0,i(182404))]},{value:"BER",name:"BER",desc:i.tf(null,void 0,i(320197)),flag:"germany",group:"Europe",country:"de",providerId:"",searchTerms:[i.tf(null,void 0,i(159985))]},{value:"DUS",name:"DUS",desc:i.tf(null,void 0,i(803884)),flag:"germany",group:"Europe",country:"de",providerId:"",searchTerms:[i.tf(null,void 0,i(159985))]},{value:"HAM",name:"HAM",desc:i.tf(null,void 0,i(373414)),flag:"germany",group:"Europe",country:"de",providerId:"",searchTerms:[i.tf(null,void 0,i(159985))]},{value:"HAN",name:"HAN",desc:i.tf(null,void 0,i(726147)),flag:"germany",group:"Europe",country:"de",providerId:"",searchTerms:[i.tf(null,void 0,i(159985))]},{value:"MUN",name:"MUN",desc:i.tf(null,void 0,i(186042)),flag:"germany",group:"Europe",country:"de",providerId:"",searchTerms:[i.tf(null,void 0,i(159985))]},{value:"TRADEGATE",name:"TRADEGATE",desc:i.tf(null,void 0,i(280394)),flag:"germany",group:"Europe",country:"de",providerId:"",searchTerms:[i.tf(null,void 0,i(159985))]},{value:"GETTEX",name:"GETTEX",desc:i.tf(null,void 0,i(881365)),flag:"germany",group:"Europe",country:"de",providerId:"finanzen",searchTerms:[i.tf(null,void 0,i(159985))]},{value:"MILSEDEX",name:"MILSEDEX",desc:i.tf(null,void 0,i(948741)),flag:"italy",group:"Europe",hideInSymbolSearch:!0,country:"it",providerId:"",searchTerms:[i.tf(null,void 0,i(43246))]},{value:"IST",name:"IST",desc:i.tf(null,void 0,i(757451)),flag:"turkey",hideInSymbolSearch:!0,group:"Europe",country:"tr",providerId:"",searchTerms:[i.tf(null,void 0,i(694398))]},{value:"BIST",name:"BIST",desc:i.tf(null,void 0,i(833187)),flag:"turkey",group:"Europe",
country:"tr",providerId:"",searchTerms:[i.tf(null,void 0,i(694398))]},{value:"TASE",name:"TASE",desc:i.tf(null,void 0,i(932457)),flag:"israel",group:"Middle East / Africa",country:"il",providerId:"",searchTerms:[i.tf(null,void 0,i(261935))]},{value:"SIX",name:"SIX",desc:i.tf(null,void 0,i(460854)),flag:"switzerland",group:"Europe",country:"ch",providerId:"",searchTerms:[i.tf(null,void 0,i(440414))]},{value:"BX",name:"BX",desc:i.tf(null,void 0,i(283300)),flag:"switzerland",group:"Europe",country:"ch",providerId:"",searchTerms:[i.tf(null,void 0,i(440414))]},{value:"PSECZ",name:"PSE",desc:i.tf(null,void 0,i(475511)),flag:"czech",group:"Europe",country:"cz",providerId:"",searchTerms:[i.tf(null,void 0,i(342054))]},{value:"ASX",name:"ASX",desc:i.tf(null,void 0,i(252673)),flag:"australia",group:"Asia / Pacific",country:"au",providerId:"",searchTerms:[i.tf(null,void 0,i(50132))]},{value:"CHIXAU",name:"Cboe Australia",desc:i.tf(null,void 0,i(685147)),flag:"australia",group:"Asia / Pacific",country:"au",providerId:"",searchTerms:[i.tf(null,void 0,i(50132))]},{value:"VIE",name:"WB",desc:i.tf(null,void 0,i(791370)),flag:"austria",group:"Europe",country:"at",providerId:"",searchTerms:[i.tf(null,void 0,i(226505))]},{value:"DSEBD",name:"DSE",desc:i.tf(null,void 0,i(105736)),flag:"bangladesh",group:"Asia / Pacific",country:"bd",providerId:"",searchTerms:[i.tf(null,void 0,i(61587))]},{value:"NZX",name:"NZX",desc:i.tf(null,void 0,i(164062)),flag:"new_zealand",group:"Asia / Pacific",country:"nz",providerId:"",searchTerms:[i.tf(null,void 0,i(824143))]},{value:"SSE",name:"SSE",desc:i.tf(null,void 0,i(531385)),flag:"china",group:"Asia / Pacific",country:"cn",providerId:"",searchTerms:[i.tf(null,void 0,i(420844))]},{value:"SHFE",name:"SHFE",desc:i.tf(null,void 0,i(19261)),flag:"china",group:"Asia / Pacific",country:"cn",providerId:"",searchTerms:[i.tf(null,void 0,i(420844))]},{value:"SZSE",name:"SZSE",desc:i.tf(null,void 0,i(117992)),flag:"china",group:"Asia / Pacific",country:"cn",providerId:"",searchTerms:[i.tf(null,void 0,i(420844))]},{value:"HKEX",name:"HKEX",desc:i.tf(null,void 0,i(686471)),flag:"hong_kong",group:"Asia / Pacific",country:"hk",providerId:"",searchTerms:[i.tf(null,void 0,i(532918))]},{value:"PSE",name:"PSE",desc:i.tf(null,void 0,i(300290)),flag:"philippines",group:"Asia / Pacific",country:"ph",providerId:"",searchTerms:[i.tf(null,void 0,i(226813))]},{value:"PSX",name:"PSX",desc:i.tf(null,void 0,i(871277)),flag:"pakistan",group:"Asia / Pacific",country:"pk",providerId:"",searchTerms:[i.tf(null,void 0,i(49145))]},{value:"NSENG",name:"NSE",desc:i.tf(null,void 0,i(410100)),flag:"nigeria",group:"Middle East / Africa",country:"ng",providerId:"",searchTerms:[i.tf(null,void 0,i(62410))]},{value:"NSEKE",name:"NSE",desc:i.tf(null,void 0,i(297570)),flag:"kenya",group:"Middle East / Africa",country:"ke",providerId:"",searchTerms:[i.tf(null,void 0,i(89080))]},{value:"JSE",name:"JSE",desc:i.tf(null,void 0,i(456781)),flag:"south_africa",group:"Middle East / Africa",country:"za",providerId:"",searchTerms:[i.tf(null,void 0,i(528900))]
},{value:"COINBASE",name:"Coinbase",desc:i.tf(null,void 0,i(740182)),flag:"bitcoin",group:"Cryptocurrency",country:"",providerId:"coinbase"},{value:"CITYINDEX",name:"City Index",desc:i.tf(null,void 0,i(858746)),flag:"forex",group:"Forex",country:"",providerId:"cityindex"},{value:"USI",name:"USI",desc:i.tf(null,void 0,i(787839)),flag:"usa",hideInSymbolSearch:!0,group:"North America",country:"us",providerId:"",searchTerms:[i.tf(null,void 0,i(787935)),i.tf(null,void 0,i(216977))]},{value:"OMXHEX",name:"HEX",desc:i.tf(null,void 0,i(261969)),flag:"finland",group:"Europe",country:"fi",providerId:"",searchTerms:[i.tf(null,void 0,i(936693))]},{value:"OMXICE",name:"ICEX",desc:i.tf(null,void 0,i(443662)),flag:"iceland",group:"Europe",country:"is",providerId:"",searchTerms:[i.tf(null,void 0,i(664150))]},{value:"OMXCOP",name:"CSE",desc:i.tf(null,void 0,i(290311)),flag:"denmark",group:"Europe",country:"dk",providerId:"",searchTerms:[i.tf(null,void 0,i(64901))]},{value:"OMXSTO",name:"STO",desc:i.tf(null,void 0,i(826846)),flag:"sweden",group:"Europe",country:"se",providerId:"",searchTerms:[i.tf(null,void 0,i(182404))]},{value:"OMXVSE",name:"VSE",desc:i.tf(null,void 0,i(453525)),flag:"lithuania",group:"Europe",country:"lt",providerId:"",searchTerms:[i.tf(null,void 0,i(529113))]},{value:"OMXTSE",name:"TALSE",desc:i.tf(null,void 0,i(807486)),flag:"estonia",group:"Europe",country:"ee",providerId:"",searchTerms:[i.tf(null,void 0,i(959823))]},{value:"OMXRSE",name:"OMXR",desc:i.tf(null,void 0,i(268976)),flag:"latvia",group:"Europe",country:"lv",providerId:"",searchTerms:[i.tf(null,void 0,i(484045))]},{value:"OMXNORDIC",name:"OMXNORDIC",desc:i.tf(null,void 0,i(641835)),flag:"europe",hideInSymbolSearch:!0,group:"Europe",country:"eu",providerId:""},{value:"OMXBALTIC",name:"OMXBALTIC",desc:i.tf(null,void 0,i(220309)),flag:"europe",hideInSymbolSearch:!0,group:"Europe",country:"eu",providerId:""},{value:"FRED",name:"FRED",desc:i.tf(null,void 0,i(90661)),flag:"usa",group:"Economy",country:"",providerId:"fred2",searchTerms:[i.tf(null,void 0,i(787935)),i.tf(null,void 0,i(216977))]},{value:"ISM",name:"ISM",desc:i.tf(null,void 0,i(647511)),flag:"usa",group:"Economy",country:"",providerId:"quandl_ism",searchTerms:[i.tf(null,void 0,i(787935)),i.tf(null,void 0,i(216977))]},{value:"FRBNY",name:"FRBNY",desc:i.tf(null,void 0,i(889838)),flag:"usa",group:"Economy",country:"",providerId:"quandl_frbny",searchTerms:[i.tf(null,void 0,i(787935)),i.tf(null,void 0,i(216977))]},{value:"FRBP",name:"FRBP",desc:i.tf(null,void 0,i(343244)),flag:"usa",group:"Economy",country:"",providerId:"quandl_frbp",searchTerms:[i.tf(null,void 0,i(787935)),i.tf(null,void 0,i(216977))]},{value:"ECONOMICS",name:"Trading Economics",desc:i.tf(null,void 0,i(651425)),flag:"usa",group:"Economy",country:"",providerId:"economics",searchTerms:[i.tf(null,void 0,i(787935)),i.tf(null,void 0,i(216977))]}]},674981:(e,t,i)=>{"use strict";i.d(t,{compareTwoCollectionsByIds:()=>v,findFirst:()=>f,intersect:()=>p,join:()=>_,lowerbound:()=>o,lowerboundExt:()=>n,moveAfter:()=>c,moveBefore:()=>h,
moveToHead:()=>d,removeItemFromArray:()=>m,subtract:()=>u,upperbound:()=>l});var s=i(650151);function r(e,t){return e<t}function n(e,t,i,s,r){let n=r-s;for(;0<n;){const r=n>>1,o=s+r;i(e(o),t)?(s=o+1,n-=r+1):n=r}return s}function o(e,t,i,s=0,r=e.length){return n((t=>e[t]),t,i,s,r)}function a(e,t,i=0,s=e.length){return o(e,t,r,i,s)}function l(e,t,i,s=0,r=e.length){let n=r-s;for(;0<n;){const r=n>>1,o=s+r;i(t,e[o])?n=r:(s=o+1,n-=r+1)}return s}function u(e,t){return e.filter((e=>!t.includes(e)))}function d(e,t){const i=e.indexOf(t);return i<0?e.slice():[t].concat(e.slice(0,i)).concat(e.slice(i+1))}function c(e,t,i){const s=new Set(t),r=[],n=[],o=[];return e.forEach(((e,t)=>{s.has(e)?n.push(e):(r.push(e),o.push(t))})),i=i<e.length-1?a(o,i+1):r.length,r.splice(i,0,...n),{newItems:r,movedItemsStartIndex:i}}function h(e,t,i){const s=new Set(t),r=[],n=[],o=[];return e.forEach(((e,t)=>{s.has(e)?n.push(e):(r.push(e),o.push(t))})),i=i<=e.length-1?a(o,i):r.length,r.splice(i,0,...n),{newItems:r,movedItemsStartIndex:i}}function p(e,t){const i=new Set;return e.forEach((e=>{t.has(e)&&i.add(e)})),i}function _(e,t){const i=new Set(e);return t.forEach((e=>i.add(e))),i}function m(e,t){const i=e.indexOf(t);(0,s.assert)(-1!==i,"Item is not found"),e.splice(i,1)}function f(e,t){for(const i of e)if(t(i))return i;return null}function v(e,t){if(e.length!==t.length)return!1;for(let i=0;i<e.length;++i)if(e[i].id()!==t[i].id())return!1;return!0}},988124:(e,t,i)=>{"use strict";var s=i(414879),r=i(783433).tzData;let n;function o(e){this._name=e;var t=r[e];if(t||(t={time:[],offset:[]},this._invalid=!0),t.time.length!==t.offset.length&&(t={time:[],offset:[]},this._invalid=!0),!t.time_utc){for(var i=t.time,s=t.offset,n=i.length,o=new Array(n),a=0;a<n;a++)i[a]*=1e3,s[a]*=1e3,o[a]=i[a]-s[a];t.time_utc=o}this.tz=t}function a(e,t){var i=e.length;if(0===i)return-1;if(isNaN(t))throw Error("Key is NaN");for(var s=0,r=i-1,n=l((s+r)/2);;){if(e[n]>t){if((r=n-1)<s)return n}else if(r<(s=n+1))return n<i-1?n+1:-1;n=l((s+r)/2)}}o.prototype.offset_utc=function(e){return o._offset(this.tz.time_utc,this.tz.offset,e)},o.prototype.offset_loc=function(e){return o._offset(this.tz.time,this.tz.offset,e)},o.prototype.name=function(){return this._name},o.prototype.correction_loc=function(e){var t=this.tz.time,i=this.tz.offset,s=a(t,e);if(s<1)return 0;var r=i[s]-i[s-1];if(r>0&&e-t[s-1]<=r)return r;return 0},o.prototype.is_valid=function(){return!this._invalid},o._offset=function(e,t,i){var s=a(e,i);return-1===s?0:t[s]};var l=function(e){return 0|e},u=function(e){return 60*e*1e3},d=function(e,t){return c(e)-c(t)},c=function(e){return e<0?l(e/1e3)-(e%1e3!=0?1:0):l(e/1e3)};function h(e){return e%4==0&&(e%100!=0||e%400==0)}var p={0:0,1:31,2:59,3:90,4:120,5:151,6:181,7:212,8:243,9:273,10:304,11:334},_={...s.WeekDays,...s.Months,YEAR:1,MONTH:2,WEEK_OF_YEAR:3,DAY_OF_MONTH:5,DAY_OF_YEAR:6,DAY_OF_WEEK:7,HOUR_OF_DAY:11,MINUTE:12,SECOND:13,minutesPerDay:1440,millisecondsPerDay:u(1440),get_minutes_from_hhmm:function(e){return-1!==e.indexOf(":")&&(e=e.split(":").join("")),e%100+60*l(e/100)
},get_year:function(e){return e.getUTCFullYear()},get_month:function(e){return e.getUTCMonth()},get_hours:function(e){return e.getUTCHours()},get_minutes:function(e){return e.getUTCMinutes()},get_seconds:function(e){return e.getUTCSeconds()},get_day_of_month:function(e){return e.getUTCDate()},get_day_of_week:function(e){return e.getUTCDay()+1},get_day_of_year:function(e){var t=e.getUTCMonth(),i=p[t];return t>_.JANUARY+1&&h(e.getUTCFullYear())&&(i+=1),i+e.getUTCDate()},get_week_of_year:function(e){var t=new Date(Date.UTC(e.getUTCFullYear(),0,1)).getUTCDay(),i=0===t?1:8-t,s=_.get_day_of_year(e)-i;return Math.ceil(s/7)+1},get_minutes_from_midnight:function(e){return 60*_.get_hours(e)+_.get_minutes(e)},set_hms:function(e,t,i,s,r,n){e.setUTCHours(t),e.setUTCMinutes(i),e.setUTCSeconds(s),e.setUTCMilliseconds(r),void 0!==n&&_.correct_time(e,n)},correct_time:function(e,t){var i=e.getTime(),s=t.correction_loc(i);e.setTime(i+s)},add_days_considering_dst:function(e,t,i){var s=e.offset_utc(t),r=this.clone(t);this.add_date(r,i);var n=e.offset_utc(r);return r.setTime(r.getTime()+s-n),r},add_years_considering_dst:function(e,t,i){let s=t;for(let t=Math.abs(i);t>0;t--)s=this.add_days_considering_dst(e,s,this.get_days_per_year(s)*Math.sign(i));return s},add_date:function(e,t){e.setTime(e.getTime()+t*_.millisecondsPerDay)},add_minutes:function(e,t){e.setTime(e.getTime()+u(t))},clone:function(e){return new Date(e.getTime())},get_days_per_year:function(e){var t=e.getUTCFullYear();return this.days_per_year(t)},days_per_year:function(e){return h(e)?366:365},get_days_in_month:function(e,t){let i;switch(e){case 0:case 2:case 4:case 6:case 7:case 9:case 11:i=31;break;case 1:i=28,h(t)&&i++;break;default:i=30}return i},get_part:function(e,t){switch(t){case _.YEAR:return _.get_year(e);case _.MONTH:return _.get_month(e);case _.DAY_OF_MONTH:return _.get_day_of_month(e);case _.WEEK_OF_YEAR:return _.get_week_of_year(e);case _.DAY_OF_WEEK:return _.get_day_of_week(e);case _.HOUR_OF_DAY:return _.get_hours(e);case _.MINUTE:return _.get_minutes(e);case _.DAY_OF_YEAR:return _.get_day_of_year(e);case _.SECOND:return _.get_seconds(e);default:return e.getTime()}},time_minutes:u,time_seconds:function(e){return 1e3*e},time_minutes_diff:function(e,t){return l(d(e,t)/60)},time_seconds_diff:d,utc_to_cal:function(e,t){return new Date(_.utc_to_cal_ts(e,t))},utc_to_cal_ts:function(e,t){return t+e.offset_utc(t)},get_cal:function(e,t,i,s,r,n,o){var a=new Date(Date.UTC(t,i,s,r||0,n||0,o||0)),l=e.offset_utc(+a);return new Date(a.valueOf()-l)},get_cal_from_unix_timestamp_ms:function(e,t){return new Date(t+e.offset_utc(t))},get_cal_utc:function(e,t,i){return new Date(Date.UTC(e,t,i))},cal_to_utc:function(e,t){var i=t.getTime();return i-e.offset_loc(i)},get_timezone:function(e){return new o(e)},shift_day:function(e,t){var i=e-1;return(i+=t)>6?i%=7:i<0&&(i=(7+i%7)%7),i+1},setCustomTimezones:function(e){n=e}};e.exports=_},66732:(e,t,i)=>{"use strict";i.d(t,{combine:()=>o,combineWithFilteredUpdate:()=>n});var s=i(401580);function r(e,t,...i){
const r=(...t)=>e(...t.map((e=>e.value()))),n=new s.WatchedValue(r(...i)),o=()=>{t(...i.map((e=>e.value())))&&n.setValue(r(...i))},a=i.map((e=>e.spawn()));for(const e of a)e.subscribe(o);return n.readonly().spawn((()=>{a.forEach((e=>e.destroy())),i.forEach((e=>e.release()))}))}function n(e,t,...i){return r(e,t,...i)}function o(e,...t){return r(e,(()=>!0),...t)}},401580:(e,t,i)=>{"use strict";i.d(t,{WatchedValue:()=>l});var s=i(428123),r=i(194582),n=i(805377);const o=(0,r.getLogger)("Common.WatchedValue");function a(e){o.logError(`${e&&(e.stack||e.message)}`)}class l{constructor(...e){this._listeners=[],e.length>0&&(this._value=e[0])}destroy(){this.unsubscribe()}value(){return this._owner?this._owner._value:this._value}setValue(e,t){const i=this._owner?this._owner:this;if("function"==typeof i.hook&&(e=i.hook(e)),i.writeLock)return;const s=i._value===e||Number.isNaN(i._value)&&Number.isNaN(e);if(!t&&s&&i.hasOwnProperty("_value"))return;i._value=e;const r=i._listeners.slice();let n=0;for(let t=0;t<r.length;t++){r[t].once&&(i._listeners.splice(t-n,1),n++);try{r[t].cb(e)}catch(e){a(e)}}}deleteValue(){this.setValue(void 0)}subscribe(e,t){if("function"!=typeof e)throw new TypeError("callback must be a function");const i=!!t&&!!t.once,s=!!t&&!!t.callWithLast,r=this._owner?this._owner:this;if(s&&r.hasOwnProperty("_value")){try{e(r._value)}catch(e){a(e)}if(i)return}r._listeners.push({cb:e,owner:this,once:!!t&&!!t.once})}unsubscribe(e){const t=this._owner?this._owner:this;void 0===e&&(e=null);const i=t._listeners;for(let s=i.length;s--;)i[s].owner!==this&&t!==this||i[s].cb!==e&&null!==e||i.splice(s,1)}readonly(){if(this._readonlyInstance)return this._readonlyInstance;const e={subscribe:this.subscribe.bind(this),unsubscribe:this.unsubscribe.bind(this),value:this.value.bind(this),when:this.when.bind(this),ownership:this.ownership.bind(this),spawnOwnership:this.spawnOwnership.bind(this),weakReference:this.weakReference.bind(this),spawn:e=>this.spawn(e).readonly(),destroy:this.destroy.bind(this)};return this._readonlyInstance=e,e}spawn(e){return new u(this._owner||this,e)}when(e){(0,n.callWhen)(this,(e=>Boolean(e)),(()=>{try{e(this.value())}catch(e){a(e)}}))}assertNoSubscriptions(){0}ownership(){return(0,s.ownership)(this)}spawnOwnership(){return(0,s.ownership)(this.spawn())}weakReference(){return(0,s.weakReference)(this)}}class u extends l{constructor(e,t){super(),delete this._listeners,this._owner=e,this._onDestroy=t}destroy(){var e;try{null===(e=this._onDestroy)||void 0===e||e.call(this)}catch(e){a(e)}super.destroy()}readonly(){return super.readonly()}}},158566:(e,t,i)=>{"use strict";i.d(t,{TVAction:()=>r,TVActionAsync:()=>n,TVLoader:()=>o});var s=i(373571);class r extends s.Action{constructor(e,t){super({...e,actionId:"TVActionId"},t)}getState(){return{...super.getState(),jsxLabel:this._options.jsxLabel}}}class n extends s.ActionAsync{constructor(e){super("TVActionId",e)}}class o extends r{constructor(){super({})}isLoading(){return!0}getSize(){return"big"}}},783375:(e,t,i)=>{"use strict";i.d(t,{ContextMenuManager:()=>s})
;var s,r=i(373571),n=i(224743);!function(e){let t=null,s=null;const o=[],a={createAction:e=>new r.Action({...e,actionId:"Chart.CustomActionId"}),createAsyncAction:e=>new r.ActionAsync("Chart.CustomActionId",e),createSeparator:()=>new r.Separator};async function l(e,r={},n={menuName:""},l){let d;null!==t&&(e=await t(e,a,n));const c=()=>{const e=o.indexOf(d);-1!==e&&o.splice(e,1),void 0!==l&&l()};if(null!==s)d=await s(e,n,c),u();else{const t=await Promise.all([i.e(53842),i.e(66639),i.e(35649),i.e(93502),i.e(99916),i.e(36956),i.e(98149),i.e(36752),i.e(3982),i.e(50690),i.e(61059),i.e(91584)]).then(i.bind(i,639051));d=new t.ContextMenuRenderer(e,r,c,u)}return o.push(d),d}function u(){(0,n.globalCloseMenu)()}e.createMenu=l,e.showMenu=function(e,t,i={},s,r){return l(e,i,s,r).then((e=>e.show(t)))},e.setCustomRendererFactory=function(e){s=e},e.setCustomItemsProcessor=function(e){t=e},e.hideAll=u,e.getShown=function(){for(let e=0;e<o.length;e++)if(o[e].isShown())return o[e];return null}}(s||(s={}))},877009:(e,t,i)=>{"use strict";i.d(t,{InvalidationLevel:()=>s,InvalidationMask:()=>a,defaultInvalidationLevel:()=>o});var s,r=i(650151),n=i(522991);!function(e){e[e.None=0]="None",e[e.Cursor=1]="Cursor",e[e.Light=2]="Light",e[e.Full=3]="Full"}(s||(s={}));const o=s.None;class a{constructor(e=o){this._panesOrderChanged=!1,this._keepVisibleTimeRangeOnResize=!1,this._timeAxisInvalidationLevel=o,this._invalidatedPanes=new Map,this._additionalActions=[],this._timeScaleInvalidations=[],this._invalidationLevel=e}invalidateAll(e){this._invalidationLevel!==e&&(this._invalidationLevel=Math.max(this._invalidationLevel,e),this._invalidatedPanes.forEach((e=>{e.invalidateAll(this._invalidationLevel)})))}invalidateAllPane(e,t){this._invalidatedPanes.has(e)||this._invalidatedPanes.set(e,new n.PaneInvalidationMask(this._invalidationLevel)),(0,r.ensureDefined)(this._invalidatedPanes.get(e)).invalidateAll(t)}invalidatePriceScale(e,t,i,s){this._invalidatedPanes.has(e)||this._invalidatedPanes.set(e,new n.PaneInvalidationMask(this._invalidationLevel)),(0,r.ensureDefined)(this._invalidatedPanes.get(e)).invalidatePriceScale(t,i,s)}invalidateTimeScale(e){this._timeAxisInvalidationLevel=Math.max(this._timeAxisInvalidationLevel,e)}invalidatePanesOrder(){this._panesOrderChanged=!0}lockVisibleTimeRangeOnResize(){this._keepVisibleTimeRangeOnResize=!0}fullInvalidation(){return this._invalidationLevel}maxPaneInvalidation(){const e=[];return this._invalidatedPanes.forEach((t=>{e.push(t.fullInvalidation())})),Math.max(...e,this._invalidationLevel)}invalidateForPane(e){return this._invalidatedPanes.get(e)||new n.PaneInvalidationMask(this._invalidationLevel)}invalidateForTimeScale(){return Math.max(this._timeAxisInvalidationLevel,this._invalidationLevel)}validationActions(){return this._additionalActions}addValidationAction(e){this._additionalActions.push(e)}merge(e){this._invalidationLevel=Math.max(this._invalidationLevel,e._invalidationLevel),this._panesOrderChanged=this._panesOrderChanged||e._panesOrderChanged,
this._keepVisibleTimeRangeOnResize=this._keepVisibleTimeRangeOnResize||e._keepVisibleTimeRangeOnResize,this._invalidatedPanes.forEach((e=>{e.invalidateAll(this._invalidationLevel)})),e._invalidatedPanes.forEach(((e,t)=>{this._invalidatedPanes.has(t)||this._invalidatedPanes.set(t,new n.PaneInvalidationMask(this._invalidationLevel)),(0,r.ensureDefined)(this._invalidatedPanes.get(t)).merge(e)})),this._timeAxisInvalidationLevel=Math.max(this._timeAxisInvalidationLevel,e._timeAxisInvalidationLevel);for(let t=0;t<e._additionalActions.length;t++)this._additionalActions.push(e._additionalActions[t]);for(const t of e._timeScaleInvalidations)this._applyTimeScaleInvalidation(t)}panesOrderInvalidated(){return this._panesOrderChanged}isVisibleTimeRangeLockedOnResize(){return this._keepVisibleTimeRangeOnResize}setTimeScaleAnimation(e){this._removeTimeScaleAnimation(),this._timeScaleInvalidations.push({type:0,value:e})}stopTimeScaleAnimation(){this._removeTimeScaleAnimation(),this._timeScaleInvalidations.push({type:1})}timeScaleInvalidations(){return this._timeScaleInvalidations}static cursor(){return new a(s.Cursor)}static light(){return new a(s.Light)}static full(){return new a(s.Full)}static panesOrder(){const e=a.full();return e.invalidatePanesOrder(),e}static invalidateLegendWidgetLayout(e){var t;const i=new a;return i._invalidatedPanes.set(e,new n.PaneInvalidationMask),null===(t=i._invalidatedPanes.get(e))||void 0===t||t.invalidateLegendWidgetLayout(),i}static validateAction(e){const t=new a;return t._additionalActions.push(e),t}_applyTimeScaleInvalidation(e){switch(e.type){case 0:this.setTimeScaleAnimation(e.value);break;case 1:this._removeTimeScaleAnimation()}}_removeTimeScaleAnimation(){var e,t;const i=this._timeScaleInvalidations.findIndex((e=>0===e.type));if(-1!==i){const[s]=this._timeScaleInvalidations.splice(i,1);null===(t=(e=s.value).onFinish)||void 0===t||t.call(e,!1)}}}},27005:(e,t,i)=>{"use strict";function s(e){var t,i,s,r,n,o,a,l;const u=null===(i=null===(t=window.widgetbar)||void 0===t?void 0:t.tradingPanelAccessor)||void 0===i?void 0:i.tradingPanel,d=!(null===(r=null===(s=window.widgetbar)||void 0===s?void 0:s.layout)||void 0===r?void 0:r.canOpen());(null==u?void 0:u.isOpened)&&d&&u.close();const c=null===(n=window.widgetbar)||void 0===n?void 0:n.setPage("pine_logs");null===(l=null===(a=null===(o=window.widgetbar)||void 0===o?void 0:o.layout)||void 0===a?void 0:a.widgetBar)||void 0===l||l.saveToTVSettings();const h=null==c?void 0:c.widget("pine_logs"),p=null==h?void 0:h.widgetObject;e?null==p||p.onSelectStudyFromChart(e):null==p||p.onOpenFromEditor()}function r(e){if(null==e?void 0:e.metaInfo){const t=null==e?void 0:e.metaInfo(),i=t.graphics.logs,s=t.id.includes("USER");return!!(t.pine&&s&&i)}return!1}i.d(t,{isUserStudyWithLogs:()=>r,openPineLogsInRightPanel:()=>s})},995310:(e,t,i)=>{"use strict";i.d(t,{BarBuilderBase:()=>a,SessionInfo:()=>o});var s=i(988124),r=i(987571),n=i(44031);class o{constructor(e,t,i,s){this.init(e,t,i,s),this._state={timezone:e,spec:t,holidays:i,corrections:s}}init(e,t,i,r){
this.timezone=s.get_timezone(e),this.spec=new n.SessionSpec(e,t,i,r)}state(){return this._state}static fromState(e){return new o(e.timezone,e.spec,e.holidays,e.corrections)}}class a{alignTime(e){if(isNaN(e))return NaN;let t=this.indexOfBar(e);return t===r.SessionStage.POST_SESSION&&(this.moveTo(e),t=this.indexOfBar(e)),t<0?NaN:this.startOfBar(t)}}},547944:(e,t,i)=>{"use strict";i.d(t,{SessionInfo:()=>o.SessionInfo,getPeriodsBetweenDates:()=>S,newBarBuilder:()=>g});var s=i(988124),r=i(223699),n=i(678515),o=i(995310),a=i(987571);class l extends o.BarBuilderBase{constructor(e,t){super(),this._sessionStartMs=-Number.MAX_VALUE,this._sessionEndMs=-Number.MAX_VALUE,this._periodSec=e,this._session=t}alignTimeIfPossible(e){const t=this.alignTime(e);return isNaN(t)?e:t}indexOfBar(e){return e<this._sessionStartMs?a.SessionStage.PRE_SESSION:e>=this._sessionEndMs?a.SessionStage.POST_SESSION:(0,n.toInt)(s.time_seconds_diff(e,this._sessionStartMs)/this._periodSec)}startOfBar(e){if(e===a.SessionStage.PRE_SESSION){const e=s.get_cal_from_unix_timestamp_ms(this._session.timezone,this._sessionStartMs-1),t=this._session.spec.alignToNearestSessionEnd(e,-1);return s.cal_to_utc(this._session.timezone,t)}if(e===a.SessionStage.POST_SESSION)return this._sessionEndMs;if(e<0)throw new Error("Negative offset is not supported");return this._sessionStartMs+s.time_seconds(this._periodSec*e)}endOfBar(e){if(e<0)throw new Error("Index cannot be negative");const t=this.startOfBar(e)+1e3*this._periodSec;return t>this._sessionEndMs?this._sessionEndMs:t}isLastBar(e,t){return t>=this._sessionStartMs+s.time_seconds(this._periodSec*(e+1)-1)}moveTo(e){const t=this._session.timezone,i=s.utc_to_cal(t,e),r=this._session.spec.alignToSessionStart(i);this._sessionStartMs=s.cal_to_utc(t,i),s.add_minutes(i,r),this._sessionEndMs=s.cal_to_utc(t,i)}indexOfLastBarInSession(){return(0,n.toInt)((this._sessionEndMs-1-this._sessionStartMs)/1e3/this._periodSec)}moveNext(){this.moveTo(this._sessionEndMs)}}var u=i(476172);function d(e,t){const i=s.clone(t),r=e.businessDaysToCalendarDays(i,1);r>1&&s.add_date(i,r-1);const n=e.leftBorderOfDailyBar(i);if(null===n)throw new Error("Cannot calculate left border of daily bar");return s.cal_to_utc(s.get_timezone(e.timezone()),n)}class c extends o.BarBuilderBase{constructor(e,t,i,s,r=!1){super(),this._periodStart=-Number.MAX_VALUE,this._periodEnd=-Number.MAX_VALUE,this._periodLastBarStart=-Number.MAX_VALUE,this._periodStartDay=new u.BusinessDay(0,0,0),this._periodEndDay=new u.BusinessDay(0,0,0),this._period=i,this._sessionTgt=e,this._builder=s,this._useBusinessDays=r,this._sessionSrc=r?new o.SessionInfo("Etc/UTC","24x7"):t||e}builder(){return this._builder}alignTimeIfPossible(e){return this.tradingDayToSessionStart(e)}tradingDayToSessionStart(e){return this.moveTo(e),this.startOfBar(0)}indexOfBar(e){if(this._useBusinessDays){const t=u.BusinessDay.fromCalendar(s.get_cal_from_unix_timestamp_ms(this._sessionSrc.timezone,e))
;return t.before(this._periodStartDay)?a.SessionStage.PRE_SESSION:this._periodEndDay.before(t)?a.SessionStage.POST_SESSION:0}return e<this._periodStart?a.SessionStage.PRE_SESSION:e>=this._periodEnd?a.SessionStage.POST_SESSION:0}startOfBar(e){if(e===a.SessionStage.PRE_SESSION){const e=s.get_cal_from_unix_timestamp_ms(this._sessionTgt.timezone,this._periodStart-1),t=this._sessionTgt.spec.alignToNearestSessionEnd(e,-1);return s.cal_to_utc(this._sessionTgt.timezone,t)-1}return e===a.SessionStage.POST_SESSION||e>0?this._periodEnd:e===a.SessionStage.LASTBAR_SESSION?this._periodLastBarStart:this._periodStart}moveTo(e){const t=s.get_cal_from_unix_timestamp_ms(this._sessionSrc.timezone,e);this._sessionSrc.spec.correctTradingDay(t);const i=s.get_year(t),r=this._indexOfPeriodInYear(t),n=r+this._period,o=this._sessionTgt.spec,a=this._sessionTgt.timezone,l=this._builder.startOfPeriod(a,r,i);this._periodStart=d(o,l);const c=s.clone(l),h=o.businessDaysToCalendarDays(c,1);h>1&&s.add_date(c,h-1),this._periodStartDay=u.BusinessDay.fromCalendar(c);const p=this._builder.startOfPeriod(a,n,i);this._periodEnd=d(o,p);const _=s.clone(p);for(s.add_date(_,-1);o.isCalWeekEnd(_);)s.add_date(_,-1);this._periodEndDay=u.BusinessDay.fromCalendar(_),s.add_date(p,-1),function(e,t){for(;e.isCalWeekEnd(t);)s.add_date(t,-1)}(this._sessionTgt.spec,p),this._periodLastBarStart=d(o,p),(this._periodLastBarStart<this._periodStart||this._periodLastBarStart===this._periodEnd)&&(this._periodLastBarStart=this._periodStart)}endOfBar(e){if(0!==e)throw new Error("index should be 0");return this._periodEnd}isLastBar(e,t){if(0!==e)throw new Error("index should be 0");return t>=this._periodLastBarStart}currentRange(){return{from:this._periodStartDay,to:this._periodEndDay}}indexOfBarInYear(e){const t=s.get_cal_from_unix_timestamp_ms(this._sessionSrc.timezone,e),i=s.get_year(t),r=this._builder.indexOfPeriod(t),o=this._sessionTgt.timezone;let a=this._builder.startOfPeriod(o,r,i),l=d(this._sessionTgt.spec,a);return a=s.get_cal_from_unix_timestamp_ms(s.get_timezone("Etc/UTC"),l),i<s.get_year(a)?(a=this._builder.startOfPeriod(o,r-1,i),l=d(this._sessionTgt.spec,a),{index:(r-1)/this._period,time:l}):{index:(0,n.toInt)(r/this._period),time:l}}sessionSrc(){return this._sessionSrc}_indexOfPeriodInYear(e){const t=this._builder.indexOfPeriod(e);let i=(0,n.toInt)(t/this._period)*this._period;return-1===t&&(i=-this._period),i}}function h(e,t){const i=s.get_day_of_week(t)-e.firstDayOfWeek();return i<0?i+7:i}function p(e,t){const i=s.get_day_of_year(t)-1;let r=h(e,t)-i%7;return 0===r?(0,n.toInt)(i/7):(r>=0&&(r-=7),(0,n.toInt)((r+i)/7))}class _{indexOfPeriod(e){return s.get_day_of_year(e)-1}startOfPeriod(e,t,i){const r=s.days_per_year(i);return s.get_cal(s.get_timezone("Etc/UTC"),i,s.JANUARY,1+Math.min(t,r))}}class m extends _{constructor(e){super(),this._sessionsSpec=e}indexOfPeriod(e){return super.indexOfPeriod(e)-function(e,t){const i=p(e,t),r=s.get_cal(s.get_timezone("Etc/UTC"),s.get_year(t),s.JANUARY,1);s.add_date(r,7*i)
;const n=i*e.weekEndsCount()+e.holidaysFromYearStart(r),o=s.get_day_of_year(t)-s.get_day_of_year(r);return n+o-e.calendarDaysToBusinessDays(r,o)}(this._sessionsSpec,e)}startOfPeriod(e,t,i){const r=7-this._sessionsSpec.weekEndsCount(),o=Math.max(0,(0,n.toInt)(t/r)-1),a=s.get_cal(s.get_timezone("Etc/UTC"),i,s.JANUARY,1),l=s.get_days_per_year(a);if(s.add_date(a,7*o),(t-=r*o-this._sessionsSpec.holidaysFromYearStart(a))>0){const e=this._sessionsSpec.businessDaysToCalendarDays(a,t);s.add_date(a,e)}let u=s.get_day_of_year(a)-1;return i<s.get_year(a)&&(u+=l),super.startOfPeriod(e,u,i)}}class f{constructor(e){this._builder=null,this._initialized=!1,this._session=e}indexOfPeriod(e){return this._getBuilder().indexOfPeriod(e)}startOfPeriod(e,t,i){return this._getBuilder().startOfPeriod(e,t,i)}_getBuilder(){return null!==this._builder&&this._initialized||(this._builder=this._session.spec.hasWeekEnds()?new m(this._session.spec):new _,this._initialized=!0),this._builder}}class v{constructor(e){this._session=e}indexOfPeriod(e){let t=p(this._session.spec,e);if(0===t){const i=s.get_timezone(this._session.spec.timezone());e<this.startOfPeriod(i,0,s.get_year(e))&&(t=-1)}return t}startOfPeriod(e,t,i){if(t<0){i--;const r=s.get_cal(s.get_timezone("Etc/UTC"),i,s.DECEMBER,31,23,59,59),o=this.indexOfPeriod(r),a=-1*t,l=(0,n.toInt)(o/a)*a;return this.startOfPeriod(e,l,i)}const r=s.get_cal(s.get_timezone("Etc/UTC"),i,s.JANUARY,1),o=h(this._session.spec,r),a=0===o?7*t:7*(t+1)-o;return a>s.get_days_per_year(r)?this.startOfPeriod(e,0,i+1):(s.add_date(r,a),r)}}class y{indexOfPeriod(e){return s.get_month(e)}startOfPeriod(e,t,i){if(t<0){const e=(0,n.toInt)((11-t)/12);i-=e,t+=12*e}else t>s.DECEMBER&&(i++,t=s.JANUARY);return s.get_cal(s.get_timezone("Etc/UTC"),i,t,1)}}function g(e,t,i,s=!1){const n=r.Interval.parse(e),o=n.multiplier();return n.isMinutes()?new l(60*o,t):n.isSeconds()?new l(o,t):n.isTicks()?new l(1,t):n.isRange()?new l(60*o,t):new c(t,i,o,function(e,t){switch(e){case r.ResolutionKind.Days:return new f(t);case r.ResolutionKind.Weeks:return new v(t);case r.ResolutionKind.Months:return new y}throw new Error(`Unknown dwm resolution: ${e}`)}(n.kind(),t),s)}function S(e,t,i,s,n,a,l){const u=r.Interval.parse(n+s);if(u.isMonths()){const e=new Date(a),t=new Date(l);let i=12*(t.getUTCFullYear()-e.getUTCFullYear());return i+=t.getUTCMonth()-e.getUTCMonth(),Math.ceil(i/u.multiplier())}const d=new o.SessionInfo("Etc/UTC",e,t,i),c=u.inMilliseconds();let h;h=u.isDWM()?864e5:60*d.spec.maxTradingDayLength()*1e3;let p=0;p=u.isWeeks()?7:7-d.spec.weekEndsCount();const _=l-a,m=h/c,f=p*m;let v=_/864e5*m;v>=f&&(v=_/6048e5*f);return v%1<=Number.EPSILON*Math.ceil(v)?Math.round(v):Math.ceil(v)}},476172:(e,t,i)=>{"use strict";i.d(t,{BusinessDay:()=>r});var s=i(988124);class r{constructor(e,t,i){this.year=e,this.month=t,this.day=i}toString(){return`${this.year}-${this.month}-${this.day}`}compareTo(e){
return this.year>e.year||this.year===e.year&&this.month>e.month||this.year===e.year&&this.month===e.month&&this.day>e.day?1:this.year===e.year&&this.month===e.month&&this.day===e.day?0:-1}before(e){return-1===this.compareTo(e)}toCalendar(e){return s.get_cal(s.get_timezone("Etc/UTC"),this.year,this.month-1,this.day)}addDays(e){const t=this.toCalendar(s.get_timezone("Etc/UTC"));return s.add_date(t,e),r.fromCalendar(t)}static fromCalendar(e){return new r(s.get_year(e),s.get_month(e)+1,s.get_day_of_month(e))}}},158975:(e,t,i)=>{"use strict";var s=i(987088).getHexColorByName,r=i(488530).RangeBarStyle,n=i(534741).PlotRowSearchMode,o=i(368135).STUDYPLOTDISPLAYTARGET,a=i(151149).rgbaFromIntegerCached,l=s("color-minty-green-500"),u=s("color-ripe-red-500");function d(){this.backColorers=[]}function c(e){d.call(this),this._series=e}function h(e,t){d.call(this),this._study=e,this._plotIndex=t,this._rgbaFromInteger=a()}d.prototype.barStyle=function(e,t,i){for(var s={},r=this.backColorers.length-1;r>=0;r--)this.backColorers[r].applyBarStyle(e,t,s,i);return this.applyBarStyle(e,t,s,i),s},d.prototype.pushBackBarColorer=function(e){this.backColorers.push(e)},d.prototype.applyBarStyle=function(e,t,i){throw new Error("This function is supposed to be reimplemented in a subclass")},inherit(c,d),c.upColor=function(e,t){var i=e.style.value();switch(i){case TradingView.Series.STYLE_LINE:return e.lineStyle.color.value();case TradingView.Series.STYLE_LINE_WITH_MARKERS:return e.lineWithMarkersStyle.color.value();case TradingView.Series.STYLE_STEPLINE:return e.steplineStyle.color.value();case TradingView.Series.STYLE_AREA:return e.areaStyle.linecolor.value();case TradingView.Series.STYLE_HLC_AREA:return e.hlcAreaStyle.closeLineColor.value();case TradingView.Series.STYLE_BARS:return e.barStyle.upColor.value();case TradingView.Series.STYLE_CANDLES:return e.candleStyle.upColor.value();case TradingView.Series.STYLE_HOLLOW_CANDLES:return e.hollowCandleStyle.upColor.value();case TradingView.Series.STYLE_HEIKEN_ASHI:return e.haStyle.upColor.value();case TradingView.Series.STYLE_BASELINE:return e.baselineStyle.topLineColor.value();case TradingView.Series.STYLE_HILO:return e.hiloStyle.color.value();case TradingView.Series.STYLE_COLUMNS:return e.columnStyle.upColor.value()}switch(i){case TradingView.Series.STYLE_RENKO:return t?e.renkoStyle.upColorProjection.value():e.renkoStyle.upColor.value();case TradingView.Series.STYLE_PB:return t?e.pbStyle.upColorProjection.value():e.pbStyle.upColor.value();case TradingView.Series.STYLE_KAGI:return t?e.kagiStyle.upColorProjection.value():e.kagiStyle.upColor.value();case TradingView.Series.STYLE_PNF:return t?e.pnfStyle.upColorProjection.value():e.pnfStyle.upColor.value()}if(TradingView.Series.STYLE_RANGE===i){const i=e.rangeStyle.barStyle.value()===r.Bars;return t?e.rangeStyle.upColorProjection.value():i?e.rangeStyle.upColor.value():e.rangeStyle.candlesUpColor.value()}throw new Error("Unknown series style")},c.downColor=function(e,t){var i=e.style.value();switch(i){case TradingView.Series.STYLE_LINE:
return e.lineStyle.color.value();case TradingView.Series.STYLE_LINE_WITH_MARKERS:return e.lineWithMarkersStyle.color.value();case TradingView.Series.STYLE_STEPLINE:return e.steplineStyle.color.value();case TradingView.Series.STYLE_AREA:return e.areaStyle.linecolor.value();case TradingView.Series.STYLE_HLC_AREA:return e.hlcAreaStyle.closeLineColor.value();case TradingView.Series.STYLE_BARS:return e.barStyle.downColor.value();case TradingView.Series.STYLE_CANDLES:return e.candleStyle.downColor.value();case TradingView.Series.STYLE_HOLLOW_CANDLES:return e.hollowCandleStyle.downColor.value();case TradingView.Series.STYLE_HEIKEN_ASHI:return e.haStyle.downColor.value();case TradingView.Series.STYLE_BASELINE:return e.baselineStyle.bottomLineColor.value();case TradingView.Series.STYLE_HILO:return e.hiloStyle.color.value();case TradingView.Series.STYLE_COLUMNS:return e.columnStyle.downColor.value()}switch(i){case TradingView.Series.STYLE_RENKO:return t?e.renkoStyle.downColorProjection.value():e.renkoStyle.downColor.value();case TradingView.Series.STYLE_PB:return t?e.pbStyle.downColorProjection.value():e.pbStyle.downColor.value();case TradingView.Series.STYLE_KAGI:return t?e.kagiStyle.downColorProjection.value():e.kagiStyle.downColor.value();case TradingView.Series.STYLE_PNF:return t?e.pnfStyle.downColorProjection.value():e.pnfStyle.downColor.value()}if(TradingView.Series.STYLE_RANGE===i){const i=e.rangeStyle.barStyle.value()===r.Bars;return t?e.rangeStyle.downColorProjection.value():i?e.rangeStyle.downColor.value():e.rangeStyle.candlesDownColor.value()}throw new Error("Unknown series style")},c.prototype._applyLineStyle=function(e,t,i,s,r){i.barColor=c.upColor(r)},c.prototype._applyAreaStyle=function(e,t,i,s,r){i.barColor=c.upColor(r)},c.prototype._applyHLCAreaStyle=function(e,t,i,s,r){var n,o=this.findBar(e,!1,s),a=this.findPrevBar(e,!1,s);n=this._series.data().first().index!==e?a[TradingView.CLOSE_PLOT]<=o[TradingView.CLOSE_PLOT]:o[TradingView.OPEN_PLOT]<=o[TradingView.CLOSE_PLOT],i.barColor=c.upColor(r,t),i.barBorderColor=n?l:u},c.prototype._applyBarStyle=function(e,t,i,s,r){var n=c.upColor(r),o=c.downColor(r),a=this.findBar(e,!1,s);if(r.barStyle.barColorsOnPrevClose.value()){var l=this.findPrevBar(e,!1,s);i.barColor=l[TradingView.CLOSE_PLOT]<=a[TradingView.CLOSE_PLOT]?n:o,i.barBorderColor=l[TradingView.CLOSE_PLOT]<=a[TradingView.CLOSE_PLOT]?n:o}else i.barColor=a[TradingView.OPEN_PLOT]<=a[TradingView.CLOSE_PLOT]?n:o,i.barBorderColor=a[TradingView.OPEN_PLOT]<=a[TradingView.CLOSE_PLOT]?n:o},c.prototype._applyRangeStyle=function(e,t,i,s,n){
var o=c.upColor(n,t),a=c.downColor(n,t),l=n.rangeStyle.barStyle.value()===r.Bars,u=t?n.rangeStyle.upColorProjection.value():l?o:n.rangeStyle.candlesBorderUpColor.value(),d=t?n.rangeStyle.downColorProjection.value():l?o:n.rangeStyle.candlesBorderDownColor.value(),h=t?n.rangeStyle.upColorProjection.value():l?void 0:n.rangeStyle.candlesWickUpColor.value(),p=t?n.rangeStyle.downColorProjection.value():l?void 0:n.rangeStyle.candlesWickDownColor.value(),_=this.findBar(e,!1,s),m=_[TradingView.OPEN_PLOT]<=_[TradingView.CLOSE_PLOT];i.barColor=m?o:a,i.barBorderColor=m?u:d,i.wickColor=m?h:p,i.barWickColor=m?h:p},c.prototype._applyCandleStyle=function(e,t,i,s,r){var n,o=c.upColor(r,t),a=c.downColor(r,t),l=r.candleStyle.borderUpColor?r.candleStyle.borderUpColor.value():r.candleStyle.borderColor.value(),u=r.candleStyle.borderDownColor?r.candleStyle.borderDownColor.value():r.candleStyle.borderColor.value(),d=r.candleStyle.wickUpColor?r.candleStyle.wickUpColor.value():r.candleStyle.wickColor.value(),h=r.candleStyle.wickDownColor?r.candleStyle.wickDownColor.value():r.candleStyle.wickColor.value(),p=this.findBar(e,!1,s);r.candleStyle.barColorsOnPrevClose.value()&&this._series.data().first().index!==e?n=this.findPrevBar(e,!1,s)[TradingView.CLOSE_PLOT]<=p[TradingView.CLOSE_PLOT]:n=p[TradingView.OPEN_PLOT]<=p[TradingView.CLOSE_PLOT];i.barColor=n?o:a,i.barBorderColor=n?l:u,i.barWickColor=n?d:h},c.prototype._applyHollowCandleStyle=function(e,t,i,s,r){var n,o=c.upColor(r,t),a=c.downColor(r,t),l=r.hollowCandleStyle.borderUpColor?r.hollowCandleStyle.borderUpColor.value():r.hollowCandleStyle.borderColor.value(),u=r.hollowCandleStyle.borderDownColor?r.hollowCandleStyle.borderDownColor.value():r.hollowCandleStyle.borderColor.value(),d=r.hollowCandleStyle.wickUpColor?r.hollowCandleStyle.wickUpColor.value():r.hollowCandleStyle.wickColor.value(),h=r.hollowCandleStyle.wickDownColor?r.hollowCandleStyle.wickDownColor.value():r.hollowCandleStyle.wickColor.value(),p=this.findBar(e,!1,s),_=this.findPrevBar(e,!1,s);n=this._series.data().first().index!==e?_[TradingView.CLOSE_PLOT]<=p[TradingView.CLOSE_PLOT]:p[TradingView.OPEN_PLOT]<=p[TradingView.CLOSE_PLOT],i.barColor=n?o:a,i.barBorderColor=n?l:u,i.barWickColor=n?d:h,i.isBarHollow=p[TradingView.OPEN_PLOT]<=p[TradingView.CLOSE_PLOT]},c.prototype._applyHAStyle=function(e,t,i,s,r){var n,o=c.upColor(r,t),a=c.downColor(r,t),l=r.haStyle.borderUpColor.value(),u=r.haStyle.borderDownColor.value(),d=r.haStyle.wickUpColor.value(),h=r.haStyle.wickDownColor.value(),p=this.findBar(e,t,s);r.haStyle.barColorsOnPrevClose.value()?n=this.findPrevBar(e,t,s)[TradingView.CLOSE_PLOT]<=p[TradingView.CLOSE_PLOT]:n=p[TradingView.OPEN_PLOT]<=p[TradingView.CLOSE_PLOT];i.barColor=n?o:a,i.barBorderColor=n?l:u,i.barWickColor=n?d:h},c.prototype._applyRenkoStyle=function(e,t,i,s,r){
var n=this.findBar(e,t,s),o=n[TradingView.OPEN_PLOT]<=n[TradingView.CLOSE_PLOT],a=c.upColor(r,t),l=c.downColor(r,t),u=t?r.renkoStyle.borderUpColorProjection.value():r.renkoStyle.borderUpColor.value(),d=t?r.renkoStyle.borderDownColorProjection.value():r.renkoStyle.borderDownColor.value(),h=r.renkoStyle.wickUpColor.value(),p=r.renkoStyle.wickDownColor.value();i.barColor=o?a:l,i.barBorderColor=o?u:d,i.barWickColor=o?h:p,i.isBarUp=o},c.prototype._applyPBStyle=function(e,t,i,s,r){i.barColor=c.upColor(r);var n=this.findBar(e,t,s),o=n[TradingView.OPEN_PLOT]<=n[TradingView.CLOSE_PLOT],a=c.upColor(r,t),l=c.downColor(r,t),u=t?r.pbStyle.borderUpColorProjection.value():r.pbStyle.borderUpColor.value(),d=t?r.pbStyle.borderDownColorProjection.value():r.pbStyle.borderDownColor.value();i.barColor=o?a:l,i.barBorderColor=o?u:d,i.isBarUp=o},c.prototype._applyKagiStyle=function(e,t,i,s,r){i.upColor=c.upColor(r,t),i.downColor=c.downColor(r,t);var n=null,o=this.findBar(e,t,s);o[TradingView.LOW_PLOT]<o[TradingView.ADT_PLOT]&&o[TradingView.ADT_PLOT]<o[TradingView.HIGH_PLOT]?(n=o[TradingView.OPEN_PLOT]<=o[TradingView.CLOSE_PLOT],i.isTwoColorBar=!0):(n=o[TradingView.OPEN_PLOT]<=o[TradingView.CLOSE_PLOT]?o[TradingView.OPEN_PLOT]===o[TradingView.ADT_PLOT]:o[TradingView.OPEN_PLOT]!==o[TradingView.ADT_PLOT],i.isTwoColorBar=!1),i.barColor=n?i.upColor:i.downColor,i.isBarUp=o[TradingView.OPEN_PLOT]<=o[TradingView.CLOSE_PLOT]},c.prototype._applyPnfStyle=function(e,t,i,s,r){var n=this.findBar(e,t,s)[TradingView.ADT_PLOT],o=n>0,a=c.upColor(r,t),l=c.downColor(r,t);i.isBarUp=o,i.isMergedBar=2===Math.abs(n),i.upColor=a,i.downColor=l,i.barColor=o?a:l},c.prototype._applyBaseLineStyle=function(e,t,i,s,r){var n=this.findBar(e,t,s),o=r.baselineStyle,a=this._series.priceScale(),l=Math.round(a.height()*(Math.abs(100-o.baseLevelPercentage.value())/100)),u=this._series.firstValue(),d=a.coordinateToPrice(l,u);n[TradingView.CLOSE_PLOT]>d?i.barColor=c.upColor(r,t):i.barColor=c.downColor(r,t)},c.prototype._applyHiLoStyle=function(e,t,i,s,r){i.barColor=c.upColor(r,t),i.barBorderColor=r.hiloStyle.borderColor.value()},c.prototype._applyColumnStyle=function(e,t,i,s,r){var n=c.upColor(r),o=c.downColor(r),a=this.findBar(e,!1,s);if(r.columnStyle.barColorsOnPrevClose.value()){var l=this.findPrevBar(e,!1,s);i.color=l[TradingView.CLOSE_PLOT]<=a[TradingView.CLOSE_PLOT]?n:o}else i.color=a[TradingView.OPEN_PLOT]<=a[TradingView.CLOSE_PLOT]?n:o;i.barColor=i.color},c.prototype.applyBarStyle=function(e,t,i,s){i||(i={}),i.barColor=null,i.barBorderColor=null,i.barWickColor=null,i.isBarHollow=null,i.isBarUp=null,i.upColor=null,i.downColor=null,i.isTwoColorBar=null,i.isMergedBar=null;var r=this._series.properties(),n=r.style.value();switch(n){case TradingView.Series.STYLE_LINE:case TradingView.Series.STYLE_LINE_WITH_MARKERS:case TradingView.Series.STYLE_STEPLINE:this._applyLineStyle(e,t,i,s,r);break;case TradingView.Series.STYLE_AREA:this._applyAreaStyle(e,t,i,s,r);break;case TradingView.Series.STYLE_HLC_AREA:this._applyHLCAreaStyle(e,t,i,s,r);break;case TradingView.Series.STYLE_BARS:
this._applyBarStyle(e,t,i,s,r);break;case TradingView.Series.STYLE_CANDLES:this._applyCandleStyle(e,t,i,s,r);break;case TradingView.Series.STYLE_HOLLOW_CANDLES:this._applyHollowCandleStyle(e,t,i,s,r);break;case TradingView.Series.STYLE_HEIKEN_ASHI:this._applyHAStyle(e,t,i,s,r);break;case TradingView.Series.STYLE_BASELINE:this._applyBaseLineStyle(e,t,i,s,r);break;case TradingView.Series.STYLE_HILO:this._applyHiLoStyle(e,t,i,s,r);break;case TradingView.Series.STYLE_COLUMNS:this._applyColumnStyle(e,t,i,s,r)}switch(n){case TradingView.Series.STYLE_RENKO:this._applyRenkoStyle(e,t,i,s,r);break;case TradingView.Series.STYLE_PB:this._applyPBStyle(e,t,i,s,r);break;case TradingView.Series.STYLE_KAGI:this._applyKagiStyle(e,t,i,s,r);break;case TradingView.Series.STYLE_PNF:this._applyPnfStyle(e,t,i,s,r)}return TradingView.Series.STYLE_RANGE===n&&this._applyRangeStyle(e,t,i,s,r),i},c.prototype.getSeriesBars=function(e){return e?this._series.nsBars():this._series.bars()},c.prototype._findBarFieldValue=function(e,t,i){var s=this.getSeriesBars(i).valueAt(e);if(null!==s)return s[t]},c.prototype.findBar=function(e,t,i){return i?i.value:this.getSeriesBars(t).valueAt(e)||[]},c.prototype.findPrevBar=function(e,t,i){if(i&&i.previousValue)return i.previousValue;var s=this._series.bars().search(e-1,n.NearestLeft,TradingView.CLOSE_PLOT);return null!==s?s.value:[]},inherit(h,d),h.prototype.getBars=function(){return this._study.series().bars()},h.prototype.firstColoredBar=function(e){for(var t=e,i=0;i<this.backColorers.length;i++)t=Math.min(t,this.backColorers[i].firstColoredBar(e));var s=this.getOffset(this._plotIndex);t=Math.min(t,e+s);var r=this.getBars().firstIndex();return Math.max(t,r)},h.prototype.getOffset=function(){var e=this._study.metaInfo().plots[this._plotIndex];return this._study.offset(e.id)},h.prototype.applyBarStyle=function(e,t,i){if(i||(i={}),t)return i;var s=this._study.properties();if(!s.visible.value())return i;var r=this._study.metaInfo(),n=this._study.data();if(!n||0===n.size())return i;var a=r.plots[this._plotIndex],l=this.getOffset();if(this._study.getMinFirstBarIndexForPlot(a.id)>e+l)return i;if(s.styles[a.id].display.value()===o.None)return i;var u=n.valueAt(e-l);if(null===u)return i;var d=u[this._plotIndex+1];if(null==d)return i;if(d=Math.round(d),r.isRGB)i.barColor=this._rgbaFromInteger(d),i.upColor=i.barColor,i.downColor=i.barColor;else{var c=r.plots[this._plotIndex].palette,h=s.palettes[c],p=r.palettes[c].valToIndex?r.palettes[c].valToIndex[d]:d,_=h.colors[p].color.value();i.barColor=_,i.upColor=_.color,i.downColor=_.color}return i},t.SeriesBarColorer=c,t.StudyBarColorer=h},570226:(e,t,i)=>{"use strict";i.d(t,{getPriceValueFormatterForSource:()=>a,shouldBeFormattedAsIndexedTo100:()=>o,shouldBeFormattedAsPercent:()=>n});var s=i(444331),r=i(981107);function n(e){const t=e.priceScale();return!(null===t||!t.isPercentage())&&(!(0,r.isActingAsSymbolSource)(e)||(0,s.isPriceSourceStyle)(e.style()))}function o(e){const t=e.priceScale();return!(null===t||!t.isIndexedTo100())&&(!(0,r.isActingAsSymbolSource)(e)||(0,
s.isPriceSourceStyle)(e.style()))}function a(e){const t=e.priceScale();if(o(e)&&null!==t)return i=>{var s;return t.formatPriceIndexedTo100(i,null!==(s=e.firstValue())&&void 0!==s?s:100)};if(n(e)&&null!==t)return i=>{var s;return t.formatPricePercentage(i,null!==(s=e.firstValue())&&void 0!==s?s:100)};const i=e.formatter();return i.format.bind(i)}},395098:(e,t,i)=>{"use strict";i.d(t,{getIntervalsVisibilitiesForMode:()=>p,isActualInterval:()=>d,makeIntervalsVisibilitiesVisibleAtInterval:()=>l,mergeIntervalVisibilitiesDefaults:()=>h,nonDefaultIntervalsVisibilities:()=>c});var s=i(712433),r=i(822914),n=i(650151),o=i(223699),a=i(808068);function l(e,t){let i=t.multiplier();if(t.isTicks()&&(e.ticks=!0),t.isSeconds()&&(i<60?(e.seconds=!0,e.secondsFrom=Math.min(e.secondsFrom,i),e.secondsTo=Math.max(e.secondsTo,i)):(i=Math.floor(i/60),t=new o.Interval(o.ResolutionKind.Minutes,i))),t.isMinutes())if(i<60)e.minutes=!0,e.minutesFrom=Math.min(e.minutesFrom,i),e.minutesTo=Math.max(e.minutesTo,i);else{const t=Math.floor(i/60);e.hours=!0,e.hoursFrom=Math.min(e.hoursFrom,t),e.hoursTo=Math.max(e.hoursTo,t)}t.isDays()&&(e.days=!0,e.daysFrom=Math.min(e.daysFrom,i),e.daysTo=Math.max(e.daysTo,i)),t.isWeeks()&&(e.weeks=!0,e.weeksFrom=Math.min(e.weeksFrom,i),e.weeksTo=Math.max(e.weeksTo,i)),t.isMonths()&&(e.months=!0,e.monthsFrom=Math.min(e.monthsFrom,i),e.monthsTo=Math.max(e.monthsTo,i)),t.isRange()&&(e.ranges=!0)}function u(e,t,i,s){return e&&s>=t&&s<=i}function d(e,t){const i=t.childs();switch(e.kind()){case o.ResolutionKind.Ticks:return i.ticks.value();case o.ResolutionKind.Seconds:if(e.multiplier()<60)return u(i.seconds.value(),i.secondsFrom.value(),i.secondsTo.value(),e.multiplier());{const t=Math.floor(e.multiplier()/60);return u(i.minutes.value(),i.minutesFrom.value(),i.minutesTo.value(),t)}case o.ResolutionKind.Minutes:if(e.multiplier()<60)return u(i.minutes.value(),i.minutesFrom.value(),i.minutesTo.value(),e.multiplier());{const t=Math.floor(e.multiplier()/60);return u(i.hours.value(),i.hoursFrom.value(),i.hoursTo.value(),t)}case o.ResolutionKind.Days:return u(i.days.value(),i.daysFrom.value(),i.daysTo.value(),e.multiplier());case o.ResolutionKind.Weeks:return u(i.weeks.value(),i.weeksFrom.value(),i.weeksTo.value(),e.multiplier());case o.ResolutionKind.Months:return u(i.months.value(),i.monthsFrom.value(),i.monthsTo.value(),e.multiplier());case o.ResolutionKind.Range:return i.ranges.value()}return(0,n.assert)(!1,`Unsupported resolution: ${e.value()}`),!1}function c(e){const t=Object.keys(e).filter((t=>a.intervalsVisibilitiesDefaults[t]!==e[t]));return 0===t.length?null:t.reduce(((t,i)=>(t[i]=e[i],t)),{})}function h(e){return(0,s.default)((0,r.default)(a.intervalsVisibilitiesDefaults),null!=e?e:{})}function p(e,t){if(0===t||e.isTicks()&&3===t||e.isRange()&&2===t)return h();let i=!1;const s={ticks:!1,seconds:!1,minutes:!1,hours:!1,days:!1,weeks:!1,months:!1,ranges:!1},r=e=>e.multiplier();return[{checker:e=>e.isTicks(),getIntervalMultiplier:r,markIntervalAsVisible:(e,t)=>{s.ticks=!0}},{checker:e=>e.isSeconds()&&e.multiplier()<60,
getIntervalMultiplier:r,markIntervalAsVisible:(e,t)=>{s.seconds=!0,s.secondsFrom=e,s.secondsTo=t}},{checker:e=>e.isSeconds()&&e.multiplier()>=60,getIntervalMultiplier:e=>Math.floor(e.multiplier()/60),markIntervalAsVisible:(e,t)=>{s.minutes=!0,s.minutesFrom=e,s.minutesTo=t}},{checker:e=>e.isMinutes()&&e.multiplier()<60,getIntervalMultiplier:r,markIntervalAsVisible:(e,t)=>{s.minutes=!0,s.minutesFrom=e,s.minutesTo=t}},{checker:e=>e.isMinutes()&&e.multiplier()>=60,getIntervalMultiplier:e=>Math.floor(e.multiplier()/60),markIntervalAsVisible:(e,t)=>{s.hours=!0,s.hoursFrom=e,s.hoursTo=t}},{checker:e=>e.isDays(),getIntervalMultiplier:r,markIntervalAsVisible:(e,t)=>{s.days=!0,s.daysFrom=e,s.daysTo=t}},{checker:e=>e.isWeeks(),getIntervalMultiplier:r,markIntervalAsVisible:(e,t)=>{s.weeks=!0,s.weeksFrom=e,s.weeksTo=t}},{checker:e=>e.isMonths(),getIntervalMultiplier:r,markIntervalAsVisible:(e,t)=>{s.months=!0,s.monthsFrom=e,s.monthsTo=t}},{checker:e=>e.isRange(),getIntervalMultiplier:r,markIntervalAsVisible:(e,t)=>{s.ranges=!0}}].forEach((s=>{if(s.checker(e)){i=!0;const r=s.getIntervalMultiplier(e);1===t?s.markIntervalAsVisible(r,r):3===t?s.markIntervalAsVisible(r,void 0):s.markIntervalAsVisible(void 0,r)}else(!i&&2===t||i&&3===t)&&s.markIntervalAsVisible(void 0,void 0)})),h(s)}},534741:(e,t,i)=>{"use strict";var s;i.d(t,{PlotRowSearchMode:()=>s}),function(e){e[e.NearestLeft=-1]="NearestLeft",e[e.Exact=0]="Exact",e[e.NearestRight=1]="NearestRight"}(s||(s={}))},826989:(e,t,i)=>{"use strict";var s;i.d(t,{SymbolErrorPermissionDeniedReason:()=>s,invalidSymbol:()=>n,permissionDenied:()=>r}),function(e){e.Symbol="symbol",e.GroupPermission="group"}(s||(s={}));const r="permission denied",n="invalid symbol"},364615:(e,t,i)=>{"use strict";i.d(t,{LineToolAnchoredVolumeProfile:()=>S});var s=i(650151),r=i(526075),n=i(827523),o=i(853965),a=i(311862),l=i(389137),u=i(29399),d=i(590713),c=i(964824),h=i(837202);class p extends h.LineToolPriceAxisView{_updateRendererData(e,t,i){super._updateRendererData(e,t,i);const s=this._source.model().properties().childs().scalesProperties.childs(),r=this._source.properties().showLabelsOnPriceScale.value();t.visible=e.visible&&r&&s.showStudyPlotLabels.value(),e.visible=e.visible&&r&&s.showStudyLastValue.value(),t.text=this._data.title}}var _=i(742391),m=i(806960),f=i(932167);class v extends f.StudyPriceAxisView{_showPaneLabel(){const e=this._model.properties().childs().scalesProperties.childs();return this._visible()&&e.showStudyPlotLabels.value()}_showAxisLabel(){const e=this._model.properties().childs().scalesProperties.childs();return this._visible()&&e.showStudyLastValue.value()}_visible(){const e=this._source.properties().childs().styles.childs()[this._data.plotIndex].childs().display.value();return this._source.properties().childs().showLabelsOnPriceScale.value()&&Boolean(4&e)}}const y=(0,n.studyIdString)("VbPAnchored","tv-basicstudies"),g=[{styleId:"pocLines",title:"POC"},{styleId:"vahLines",title:"VAH"},{styleId:"valLines",title:"VAL"}];class S extends m.StudyLineDataSourceWithPlots{
constructor(e,t,i,r,n){const o=i||(0,l.clone)(e.studyMetaInfoRepository().findByIdSync({type:"java",studyId:y})),a=null!=t?t:S.createProperties(e);super(e,o,"vbpanchored_",a,r,n),this._priceAxisPointsInvalidated=!0;const u=(0,s.ensureDefined)(a.childs().graphics.childs().horizlines).childs(),d=this._createPlotPriceAxisViews();this._priceAxisViews=g.map(((e,t)=>new p(this,{pointIndex:t,title:e.title,backgroundPropertyGetter:()=>u[e.styleId].childs().color.value()}))).concat(d),this._priceAxisPoints=g.map(((e,t)=>({price:NaN,index:0}))),this._paneLabelsPaneViews=this._priceAxisViews.map((e=>new _.PanePriceAxisView(e,this,this._model))),this._createPaneViews().then((e=>{this._setPaneViews([...this._paneLabelsPaneViews,...e]),e.forEach((e=>e.update((0,c.sourceChangeEvent)({sourceId:this.id(),clearData:!0}))))}))}pointsCount(){return 1}isForcedDrawPriceAxisLabel(){return!0}isSynchronizable(){return this._ownerSource===this._model.mainSeries()}priceAxisPoints(){return this._priceAxisPointsInvalidated&&(this._updatePriceLabels(),this._priceAxisPointsInvalidated=!1),this._priceAxisPoints}static createProperties(e,t){const i=r.StudyMetaInfo.getStudyPropertyRootNameById(y),n=(0,s.ensureNotNull)(e.studyMetaInfoRepository().findByIdSync({type:"java",studyId:y})),a=(0,o.createDefaultsState)(!0,i,[],e.studyVersioning());return this.createPropertiesFromStudyMetaInfoAndState(n,n,(0,l.merge)((0,l.clone)(a),null!=t?t:{}),e.studyVersioning())}static createPropertiesFromStudyMetaInfoAndState(e,t,i,s){const r=(0,a.prepareStudyPropertiesForLoadChart)(e,t,i,s);return this._configureProperties(r),r}_updateAllPaneViews(e){super._updateAllPaneViews(e),this._updateAnchors(),this._priceAxisPointsInvalidated=!0}_updateAnchors(){var e;if(0===this._points.length)return;const t=this.priceScale();if(!t)return;const i=null===(e=this._ownerSource)||void 0===e?void 0:e.firstValue();if(null==i)return;const r=this.graphics().horizlines();let n=null;const o=(0,s.ensureDefined)(this.properties().childs().graphics.childs().horizlines).childs();for(const e of g)if(o[e.styleId].childs().visible.value()){const t=r.get(e.styleId);(null==t?void 0:t.size)&&(n=t.values().next().value.level);break}if(null===n){const e=t.height()/2;n=t.coordinateToPrice(e,i)}this._points[0].price=n}_updatePriceLabels(){const e=(0,s.ensureDefined)(this.properties().childs().graphics.childs().horizlines).childs(),t=this.graphics().horizlines();g.forEach(((i,s)=>{if(this._priceAxisPoints[s].price=NaN,e[i.styleId].childs().visible.value()){const e=t.get(i.styleId);(null==e?void 0:e.size)&&(this._priceAxisPoints[s].price=e.values().next().value.level)}}))}_studyInputs(e){(0,s.assert)(1===e.length,"the line tool point should be defined");const t=e[0],i=this._getPointTime(t,!0);if(null===i)return this._subscribeApplyInputsOnSeriesCompleted(),null;if(!this._model.mainSeries().data().last())return null;return{...this.properties().childs().inputs.state(),first_bar_time:1e3*i}}async _createPaneViews(){var e;const t=this._metaInfo,s=t.graphics,r=[],n=!0;if(s.hhists){
const{HHistPaneView:t}=await Promise.all([i.e(98081),i.e(20507)]).then(i.bind(i,670751)),s=null===(e=this.properties().childs().graphics.childs().polygons)||void 0===e?void 0:e.childs();r.push(new t(this,this._model,void 0,null==s?void 0:s.histBoxBg,n,!0))}if(s.horizlines){const{HorizLinePaneView:e}=await Promise.all([i.e(98081),i.e(20507)]).then(i.bind(i,722669));r.push(new e(this,this._model,void 0,n))}return t.plots.forEach((e=>{r.push(this._createStudyPlotPaneView(e.id,n))})),r}async _getPropertyDefinitionsViewModelClass(){return(await Promise.all([i.e(88601),i.e(33038),i.e(56894),i.e(68855),i.e(25900),i.e(56386),i.e(47924),i.e(60607)]).then(i.bind(i,762155))).StudyLineDataSourceDefinitionsViewModel}_isReady(){return!(0,d.isStudyGraphicsEmpty)(this.graphics())}_createStudyPlotPaneView(e,t){return new u.StudyPlotPaneView(this,this._model.mainSeries(),this._model,e,t)}_createPlotPriceAxisViews(){return this.metaInfo().plots.map((e=>new v(this,{plotIndex:e.id})))}static _configureProperties(e){super._configureProperties(e),e.removeProperty("showLegendValues")}}},837202:(e,t,i)=>{"use strict";i.d(t,{LineToolPriceAxisView:()=>o});var s=i(650151),r=i(229765),n=i(246733);class o extends r.PriceAxisView{constructor(e,t){super(),this._source=e,this._data=t,this._properties=e.model().properties().childs().scalesProperties}_updateRendererData(e,t,i){e.visible=!1;const s=this._source.model();if(!s.timeScale()||s.timeScale().isEmpty())return;const r=this._source.priceScale();if(null===r||r.isEmpty())return;if(!s.selection().isSelected(this._source)&&!this._source.isForcedDrawPriceAxisLabel())return;if(null===s.timeScale().visibleBarsStrictRange())return;const o=this._source.priceAxisPoints(),a=this._data.pointIndex;if(o.length<=a)return;const l=o[a];if(!isFinite(l.price))return;const u=this._source.ownerSource(),d=null!==u?u.firstValue():null;if(null===d)return;let c=this._data.backgroundPropertyGetter?this._data.backgroundPropertyGetter():null;null===c&&(c=this._getBgColor()),i.background=(0,n.resetTransparency)(c),i.borderColor="#2E84A6",i.textColor=this.generateTextColor(i.background),i.coordinate=r.priceToCoordinate(l.price,d),e.text=this._formatPrice(l.price,d),e.visible=!0}_getBgColor(){return this._active?this._properties.childs().axisLineToolLabelBackgroundColorActive.value():this._properties.childs().axisLineToolLabelBackgroundColorCommon.value()}_formatPrice(e,t){return(0,s.ensureNotNull)(this._source.priceScale()).formatPrice(e,t)}}},821979:(e,t,i)=>{"use strict";i.d(t,{LineDataSource:()=>F});var s=i(86441),r=i(650151),n=i(251954),o=i(201089),a=i(244842),l=i(707957),u=i(103221),d=i(389137),c=i(558793),h=i(695242),p=i(735337),_=i(401580),m=i(877009),f=i(731042),v=i(395098),y=i(808068),g=i(444331),S=i(502141),b=i(223699),P=i(354950),I=i.n(P),w=i(885482),T=i(996986),C=i(312449),A=i(964824),E=i(981107),x=i(68626),L=i(517067),V=i(902214),M=i(837202),N=i(31712),O=i(918208);const D=(0,o.getLogger)("Chart.LineDataSource"),k=a.enabled("datasource_copypaste");class B{constructor(){this._states=[]}start(e){
this._states.push(e)}finish(e){const t=(0,r.ensureDefined)(this._states.pop());return s=t,(i=e).length!==s.length?{indexesChanged:!0,pricesChanged:!0}:i.reduce(((e,t,i)=>{const r=s[i];return e.indexesChanged=e.indexesChanged||t.index!==r.index,e.pricesChanged=e.pricesChanged||t.price!==r.price,e}),{indexesChanged:!1,pricesChanged:!1});var i,s}isEmpty(){return 0===this._states.length}}let R=0;class F extends T.DataSource{constructor(e,t,i,s){if(super(s),this.version=1,this.toolname="",this.customization={forcePriceAxisLabel:!1,disableErasing:!1,disableSave:!1,showInObjectsTree:!0},this._currentPointsetAndSymbolId=null,this._pointChanged=new l.Delegate,this._pointAdded=new l.Delegate,this._priceAxisViews=[],this._timeAxisViews=[],this._timePoint=[],this._points=[],this._lastPoint=null,this._paneViews=new Map,this._normalizedPointsChanged=new l.Delegate,this._fixedPointsChanged=new l.Delegate,this._changeStatesStack=new B,this._startMovingPoint=null,this._currentMovingPoint=null,this._isActualSymbol=!1,this._isActualInterval=!1,this._isActualCurrency=!1,this._isActualUnit=!1,this._isDestroyed=!1,this._sharingMode=new _.WatchedValue(0),this._onTemplateApplying=new l.Delegate,this._onTemplateApplied=new l.Delegate,this._syncStateExclusions=[],this._definitionsViewModel=null,this._syncLineStyleMuted=!1,this._onIsActualIntervalChange=new l.Delegate,this._linkKey=new _.WatchedValue(null),this._serverUpdateTime=null,this._boundCalcIsActualSymbol=this.calcIsActualSymbol.bind(this),this._alertUndoMode=!1,this._model=e,this._properties=t,this._localAndServerAlertsMismatch=!1,this._properties.hasChild("interval")||this._properties.addChild("interval",new(I())(e.mainSeries().interval())),this.calcIsActualSymbol(),this._properties.childs().intervalsVisibilities.listeners().subscribe(this,this.calcIsActualSymbol),this._properties.subscribe(this,(()=>this.propertiesChanged())),this._createPointsProperties(),this.pointsCount()>0)for(let e=0;e<this.pointsCount();e++)this._priceAxisViews.push(this.createPriceAxisView(e)),this._timeAxisViews.push(new V.LineDataSourceTimeAxisView(this,e));this._properties.childs().visible.subscribe(this,(e=>{const t=!1===(0,w.hideAllDrawings)().value();e.value()?e.value()&&t&&n.emit("drawing_event",this._id,"show"):(this._model.selection().isSelected(this)&&this._model.selectionMacro((e=>{e.removeSourceFromSelection(this)})),t&&n.emit("drawing_event",this._id,"hide")),this._onSourceHiddenMayChange()})),(0,w.hideAllDrawings)().subscribe(this,this._onSourceHiddenMayChange),this._definitionsViewModel=null,this._isDestroyed=!1}destroy(){this._paneViews.forEach(((e,t)=>this._destroyPanePaneViews(t))),this.stop(),null!==this._definitionsViewModel&&(this._definitionsViewModel.destroy(),this._definitionsViewModel=null),null!==this._ownerSource&&(this._ownerSource.currencyChanged().unsubscribeAll(this),this._ownerSource.unitChanged().unsubscribeAll(this),(0,E.isSymbolSource)(this._ownerSource)&&(this._ownerSource.symbolResolved().subscribe(this,this._boundCalcIsActualSymbol),
this._ownerSource.isActingAsSymbolSource().unsubscribe(this._boundCalcIsActualSymbol))),this.ownerSourceChanged().unsubscribeAll(this),(0,w.hideAllDrawings)().unsubscribeAll(this),this.deleteAlert(),this._isDestroyed=!0}priceScale(){return this._ownerSource?this._ownerSource.priceScale():null}createPriceAxisView(e){return new M.LineToolPriceAxisView(this,{pointIndex:e})}model(){return this._model}symbol(){return this._properties.childs().symbol.value()}linkKey(){return this._linkKey}serverUpdateTime(){return this._serverUpdateTime}setServerUpdateTime(e){this._serverUpdateTime=e}boundToSymbol(){return!0}isAvailableInFloatingWidget(){return!0}points(){const e=[];for(let t=0;t<this._points.length;t++){const i=this._points[t];e.push({index:i.index,price:i.price,time:i.time})}return this._lastPoint&&e.push(this._correctLastPoint(this._lastPoint)),!this.isFixed()&&this._currentMovingPoint&&this._startMovingPoint&&this._correctPoints(e),e}timeAxisPoints(){return this.points()}priceAxisPoints(){return this.points()}fixedPoint(){var e;let t;const i=this.priceScale();if(this._positionPercents&&null!==i&&!i.isEmpty()){const e=this._positionPercents,r=this._model.timeScale().width()*e.x,n=i.height()*e.y;t=new s.Point(r,n)}else void 0!==this._fixedPoint&&(t=null===(e=this._fixedPoint)||void 0===e?void 0:e.clone());if(this._currentMovingPoint&&this._startMovingPoint&&void 0!==t){const e=this._correctFixedPoint(t);e.didCorrect&&(t=e.point)}return t}positionPercents(){return this._positionPercents}normalizedPoints(){return this._timePoint}normalizedPointsChanged(){return this._normalizedPointsChanged}fixedPointChanged(){return this._fixedPointsChanged}geometry(){const e=(0,r.ensureNotNull)(this.priceScale());return this.points().map((t=>{const i=(0,r.ensureNotNull)(this.pointToScreenPoint(t)),n=i.x/this._model.timeScale().width(),o=i.y/e.height();return new s.Point(n,o)}))}widthsProperty(){var e;return null!==(e=this._properties.childs().linesWidths)&&void 0!==e?e:null}lineColorsProperty(){var e;return null!==(e=this._properties.childs().linesColors)&&void 0!==e?e:null}backgroundColorsProperty(){var e;return null!==(e=this._properties.childs().backgroundsColors)&&void 0!==e?e:null}textColorsProperty(){var e;return null!==(e=this._properties.childs().textsColors)&&void 0!==e?e:null}pointsProperty(){return this._pointsProperty}hasEditableCoordinates(){return!0}startMoving(e,t,i,s){this.isFixed()&&this.restoreFixedPoint(),this._startMovingPoint=e}move(e,t,i,s){if(i&&(i.shiftOnly()||i.modShift()))if(this.isFixed()){const t=this._alignScreenPointHorizontallyOrVertically((0,r.ensureDefined)(e.screen));this._currentMovingPoint={screen:t}}else{const t=this._alignPointHorizontallyOrVertically((0,r.ensureDefined)(e.logical)),i=(0,r.ensureNotNull)(this.pointToScreenPoint(t));this._currentMovingPoint={logical:t,screen:i}}else this._currentMovingPoint=e;this.updateAllViews((0,A.sourceChangeEvent)(this.id()))}endMoving(e,t,i){let s=!1,o=!1;if(this._currentMovingPoint&&this._startMovingPoint){if(this.isFixed()){const e=this._correctFixedPoint((0,
r.ensureDefined)(this._fixedPoint));e.didCorrect&&(this._fixedPoint=e.point,this._fixedPointsChanged.fire())}else{const e=(0,r.ensureDefined)(this._currentMovingPoint.logical),t=(0,r.ensureDefined)(this._startMovingPoint.logical);s=e.index!==t.index,o=e.price!==t.price;if(this._correctPoints(this._points,i)){n.emit("drawing_event",this._id,"move"),n.emit("drawing_event",this._id,"points_changed");for(let e=0;e<this._points.length;e++)this._pointChanged.fire(e)}}this._startMovingPoint=null,this._currentMovingPoint=null}const a={indexesChanged:s,pricesChanged:o};return this.isFixed()?(this.calcPositionPercents(),this.updateAllViews((0,A.sourceChangeEvent)(this.id())),a):(this.updateAllViews((0,A.sourceChangeEvent)(this.id())),s&&!e?(this._properties.childs().interval.setValue(this._model.mainSeries().interval()),this.normalizePoints(),this.createServerPoints()):(this._copyPricesWithoutNormalization(),this._normalizedPointsChanged.fire()),t||!o&&!s||this.synchronizeAlert(!this._alertUndoMode),a)}startMovingPoint(){return this._startMovingPoint?{...this._startMovingPoint}:null}currentMovingPoint(){return this._currentMovingPoint?{...this._currentMovingPoint}:null}startChanging(e,t){void 0!==e&&void 0!==t&&(e<this._priceAxisViews.length&&this._priceAxisViews[e].setActive(!0),e<this._timeAxisViews.length&&this._timeAxisViews[e].setActive(!0)),this._changeStatesStack.start(this.points())}endChanging(e,t,i){const s=this._changeStatesStack.finish(this.points());s.indexesChanged&&this._changeStatesStack.isEmpty()?(this._properties.childs().interval.setValue(this._model.mainSeries().interval()),this.normalizePoints(),t||this.createServerPoints()):(this._copyPricesWithoutNormalization(),this._normalizedPointsChanged.fire()),n.emit("drawing_event",this._id,"points_changed");for(let e=0;e<this._priceAxisViews.length;e++)this._priceAxisViews[e].setActive(!1);for(let e=0;e<this._timeAxisViews.length;e++)this._timeAxisViews[e].setActive(!1);return i||this.synchronizeAlert(!e),s}setPoint(e,t,i,s){if(i&&i.shift()&&this._snapTo45DegreesAvailable()){const i=0===e?1:e-1;this._snapPoint45Degree(t,this.points()[i])}this._setPoint(e,t)}getPoint(e){return this.points()[e]||null}alignCrossHairToAnchor(e){return!0}alignCrossHairToMovePoint(){return!1}setLastPoint(e,t){return this._lastPoint=this._preparePoint(e,t),this.updateAllViews((0,A.sourceChangeEvent)(this.id())),this._lastPoint}lastPoint(){return this._lastPoint}getChangePointForSync(e){return this.getPoint(e)}setPoints(e){this._points=e}isForcedDrawPriceAxisLabel(){return this.customization.forcePriceAxisLabel}clearData(){this._points=[]}denormalizeTimePoints(){let e=[];for(let t=0;t<this._timePoint.length;t++){const i=this._model.timeScale().denormalizeTimePoint(this._timePoint[t]);if(void 0===i){e=[];break}e.push({index:i,price:this._timePoint[t].price})}e.length>0&&(this._points=e)}restorePoints(e,t,i){const s=this._timePoint.length>0&&!(0,d.deepEquals)(this._timePoint,e)[0];this._timePoint=(0,u.deepCopy)(e),this._points=t,i||this.denormalizeTimePoints(),
s&&this._normalizedPointsChanged.fire()}restorePositionPercents(e){this._positionPercents=e}calcIsActualSymbol(){const e=this.ownerSource();if(null===e)this._isActualSymbol=!1;else{const t=(0,r.ensureNotNull)(e.symbolSource());this._migrateSymbolProperty();const i=this._properties.childs().symbol,s=i.value();if(this._isActualSymbol=t.symbolSameAsCurrent(s),this._isActualSymbol){const e=t.symbol();(0,S.areEqualSymbols)(s,e)||(D.logWarn('Possible drawing "migrating" detected from "'+s+'" to "'+e+'"'),D.logWarn("Series symbolInfo: "+JSON.stringify(t.symbolInfo())),D.logWarn(`${(new Error).stack}`)),i.setValue(e)}}this.calcIsActualInterval(),this.calcIsActualCurrency(),this.calcIsActualUnit(),this._onSourceHiddenMayChange()}calcIsActualCurrency(){const e=this.ownerSource();if(null===e)return void(this._isActualCurrency=!1);let t=this._properties.childs().currencyId.value();if(null!==t){const i=e.symbolSource();"pct"===t&&(this._properties.childs().currencyId.setValue(null),t=null),this._isActualCurrency=t===(0,g.symbolCurrency)(i.symbolInfo(),void 0,!0)}else{const t=(0,r.ensureNotNull)(e.symbolSource()).symbolInfo();this._isActualCurrency=null!==t&&(0,g.symbolCurrency)(t)===(0,g.symbolOriginalCurrency)(t)}this._onSourceHiddenMayChange()}calcIsActualUnit(){const e=this.ownerSource();if(null===e)return void(this._isActualUnit=!1);const t=this._properties.childs().unitId.value();if(null!==t)this._isActualUnit=t===(0,r.ensureNotNull)(e.symbolSource()).unit();else{const t=(0,r.ensureNotNull)(e.symbolSource()).symbolInfo(),i=this._model.unitConversionEnabled();this._isActualUnit=null!==t&&(0,g.symbolUnit)(t,i)===(0,g.symbolOriginalUnit)(t,i)}this._onSourceHiddenMayChange()}calcIsActualInterval(){const e=this._isActualInterval,t=this._properties,i=this._model.mainSeries();this._isActualInterval=(0,v.isActualInterval)(b.Interval.parse(i.interval()),t.childs().intervalsVisibilities),!this._isActualInterval&&this._model.selection().isSelected(this)&&this._model.selectionMacro((e=>e.removeSourceFromSelection(this))),this._isActualInterval!==e&&this._onIsActualIntervalChange.fire(),this._onSourceHiddenMayChange()}paneViews(e){if(this.isSourceHidden())return null;const t=this._getPaneViews(this.isMultiPaneAvailable()?e:void 0);if(null===t)return null;if(1===t.length)return[t[0]];const i=[];for(let e=t.length-1;e>=0;--e)i.push(t[e]);return i}priceAxisViews(e,t){if(t!==this.priceScale()||this.isSourceHidden())return null;if(this._model.lineBeingEdited()===this){const e=this._model.linePointBeingEdited();if(null!==e&&e<this._priceAxisViews.length){const t=this._priceAxisViews.slice(),i=t[e];return t.splice(e,1),t.push(i),t}return this._priceAxisViews}return this._priceAxisViews}timeAxisViews(){if(this.isSourceHidden())return null;if(this._model.lineBeingEdited()===this){const e=this._model.linePointBeingEdited();if(null!==e&&e<this._timeAxisViews.length){const t=this._timeAxisViews.slice(),i=t[e];return t.splice(e,1),t.push(i),t}return this._timeAxisViews}return this._timeAxisViews}isSavedInChart(){return!this.customization.disableSave}
isSavedInStudyTemplates(){return!1}setSavingInChartEnabled(e){this.customization.disableSave=!e}shouldBeRemovedOnDeselect(){return!1}getOrderTemplate(){return null}getSourceIcon(){return{type:"loadSvg",svgId:"linetool."+this.toolname}}alertId(){return this._alertId}async waitSettingAlertId(){this._pendingAlertIdPromise&&(this._alertId=await this._pendingAlertIdPromise)}async setAlert(e,t){const i=t&&t.sync;if(!this.canHasAlert())return Promise.reject("Line data source can not has alert");if(this._pendingAlertIdPromise)return void D.logWarn("Setting alert of line data source will be ignored because alert is already being set");if((0,d.isPromise)(e)){this._pendingAlertIdPromise=e;try{await this.waitSettingAlertId()}finally{delete this._pendingAlertIdPromise}}else this._alertId=e;const s=(0,r.ensureDefined)(this._alertId);return this.hasAlert.setValue(!0),this.getAlert().then((e=>{const t=this._model.selection().isSelected(this);return e?(this._removeAlertSubscriptions(),this._addAlertSubscriptions(e),e.setSelected(t),this._onAlertData(e),e):(D.logError("Failed to get alert, alert will not be saved with drawing in chart"),Promise.reject("got_no_alert"))})).then((()=>{const e=this.linkKey().value();null===e||i||(0,w.changeLineStyle)({linkKey:e,model:this._model,state:{},alertId:s})})).catch((e=>{this._removeAlertSubscriptions(),"not_exists"===e?(0,c.getChartAlertsFacade)().then((e=>{e.removeAlertFromAllChartsSilently(this.id(),s)})):D.logError("Getting alert or Saving chart failed: "+e)}))}editAlert(e){this.hasAlert.value()&&(0,c.getChartAlertsFacade)().then((t=>{t.openEditDialog((0,r.ensureDefined)(this._alertId),{actionSource:e,error:e=>{"not_exists"===e&&this.removeAlert()}})}))}getAlert(){return new Promise((async(e,t)=>{(await(0,c.getChartAlertsFacade)()).getAlert((0,r.ensureDefined)(this._alertId),{success:e,error:t})}))}getAlertSync(){var e;if(!this._alertId)return null;const t=(0,c.getChartAlertsFacadeIfCreatedBefore)();return null===t?null:null!==(e=t.getAlertSync(this._alertId))&&void 0!==e?e:null}synchronizeAlert(e){(this.hasAlert.value()||this._pendingAlertIdPromise)&&setTimeout((async()=>{if(!this._isDestroyed)try{await this.waitSettingAlertId(),this._synchronizeAlert(e)}catch(e){}}),0)}syncAlert(e){this.hasAlert.value()||this.setAlert(e,{sync:!0})}stateForAlert(){if(!this.canHasAlert())return null;const e={...this.state(),id:this.idForAlert(),uniqueId:this.idForAlert(),title:this.translatedType(),interval:this._model.mainSeries().interval()},t=this._getAlertPlots();return t&&t.length>0&&(e.plots=t),e}getAlertIsActive(){if(!this._alertId)return!1;const e=this.getAlertSync();return Boolean(e&&e.isActive())}detachAlert(){this._removeAlertSubscriptions(),this.hasAlert.setValue(!1),this._alertId=void 0}removeAlert(){this._alertId=void 0,this.hasAlert.setValue(!1),this._removeAlertSubscriptions()}deleteAlert(){if(!this.hasAlert.value()||void 0===this._alertId)return;const e=(0,c.getChartAlertsFacadeIfCreatedBefore)();e&&e.deleteAlert(this._alertId),this.removeAlert()}areLocalAndServerAlertsMismatch(){
return this._localAndServerAlertsMismatch}showInObjectTree(){return this.customization.showInObjectsTree}setShowInObjectsTreeEnabled(e){this.customization.showInObjectsTree=e}start(){this.createServerPoints()}processHibernate(){this.isSourceHidden()?this.isStarted()&&this.stop():this.isStarted()||this.start()}onData(e){"pointset_error"!==e.method?e.params.customId===this._currentPointsetIdWithPrefix()&&this._onPointsetUpdated(e.params.plots):D.logError(`Error getting pointset: ${e.params[0]} ${e.params[1]}`)}isBeingEdited(){return this===this._model.lineBeingEdited()}isActualSymbol(){return this._isActualSymbol}isActualCurrency(){return this._isActualCurrency}isActualInterval(){return this._isActualInterval}isActualUnit(){return this._isActualUnit}onIsActualIntervalChange(){return this._onIsActualIntervalChange}setOwnerSource(e){null!==this._ownerSource&&(this._ownerSource.currencyChanged().unsubscribeAll(this),this._ownerSource.unitChanged().unsubscribeAll(this)),null!==this._ownerSource&&(0,E.isSymbolSource)(this._ownerSource)&&(this._ownerSource.symbolResolved().unsubscribe(this,this._boundCalcIsActualSymbol),this._ownerSource.isActingAsSymbolSource().unsubscribe(this._boundCalcIsActualSymbol)),super.setOwnerSource(e),e&&(this.setPriceScale(e.priceScale()),e.currencyChanged().subscribe(this,this.calcIsActualCurrency),e.unitChanged().subscribe(this,this.calcIsActualUnit),this.calcIsActualSymbol(),this._migrateZOrder()),(0,E.isSymbolSource)(e)&&(e.symbolResolved().subscribe(this,this._boundCalcIsActualSymbol),e.isActingAsSymbolSource().subscribe(this._boundCalcIsActualSymbol))}dataAndViewsReady(){return this._paneViews.size>0}pointAdded(){return this._pointAdded}pointChanged(){return this._pointChanged}pointToScreenPoint(e){var t;const i=this._model.timeScale(),r=this.priceScale(),n=null===(t=this.ownerSource())||void 0===t?void 0:t.firstValue();if(!r||r.isEmpty()||i.isEmpty()||null==n)return null;const o=i.indexToCoordinate(e.index),a=r.priceToCoordinate(e.price,n);return new s.Point(o,a)}screenPointToPoint(e){var t;const i=this.priceScale(),s=null===(t=this.ownerSource())||void 0===t?void 0:t.firstValue();if(null==s||!isFinite(s)||null===i)return null;const r=this._model.timeScale().coordinateToIndex(e.x);return{price:i.coordinateToPrice(e.y,s),index:r}}calcMiddlePoint(e,t){return new s.Point((e.x+t.x)/2,(e.y+t.y)/2)}addPoint(e,t,i){const s=this._preparePoint(e,t);return this._addPointIntenal(s,t,i)}addFixedPoint(e){return this._fixedPoint=e,this.calcPositionPercents(),!0}calcPositionPercents(){const e=this.priceScale();if(!e||e.isEmpty()||void 0===this._fixedPoint)return;const t=this._fixedPoint.x/this._model.timeScale().width(),i=this._fixedPoint.y/e.height();return this._positionPercents={x:t,y:i},this._positionPercents}restoreFixedPoint(){this._fixedPoint=this.fixedPoint()}propertiesChanged(e){this.calcIsActualInterval(),this.updateAllViewsAndRedraw((0,A.sourceChangeEvent)(this.id())),e||this._syncLineStyleIfNeeded(),
void 0===this._pendingPropertyChangedEvent&&(this._pendingPropertyChangedEvent=setTimeout((()=>{this._pendingPropertyChangedEvent=void 0,n.emit("drawing_event",this._id,"properties_changed")}),0))}state(e){var t,i;const s={type:this.toolname,id:this.id(),state:this.properties().state(null!==(t=this._propertiesStateExclusions())&&void 0!==t?t:void 0),points:(0,u.deepCopy)(this._timePoint),zorder:this.zorder(),ownerSource:null===(i=this.ownerSource())||void 0===i?void 0:i.id()};return this.linkKey().value()&&(s.linkKey=this.linkKey().value()),0!==this._sharingMode.value()&&(s.sharingMode=this._sharingMode.value()),delete s.state.points,e&&(s.indexes=this._points),this.isFixed()&&(s.positionPercents=this._positionPercents||this.calcPositionPercents()),"version"in this&&1!==this.version&&(s.version=this.version),this._saveAlertIdInState()&&this.hasAlert.value()&&void 0!==this._alertId&&(s.alertId=this._alertId),s}updateAllViews(e){this._isActualSymbol&&this._isActualCurrency&&this._isActualUnit&&this._isActualInterval&&this._properties.childs().visible.value()&&(this._updateAllPaneViews(e),this._priceAxisViews.forEach((t=>t.update(e))),this._timeAxisViews.forEach((t=>t.update(e))))}updateAllViewsAndRedraw(e){this.updateAllViews(e),this._model.updateSource(this)}tags(){return[this.toolname]}properties(){return this._properties}restoreExternalPoints(e,t){if(this._timePoint=(0,u.deepCopy)(e.points),t.indexesChanged){if(this.properties().childs().interval.setValue(e.interval),!this.isActualSymbol())return this._clearServerPoints(),void this._normalizedPointsChanged.fire();this.createServerPoints()}else{const t=Math.min(this._points.length,e.points.length);for(let i=0;i<t;i++)this._points[i].price=e.points[i].price}this._normalizedPointsChanged.fire()}restoreExternalState(e){this.properties().mergeAndFire(e)}applyTemplate(e){this._onTemplateApplying.fire(e),this._applyTemplateImpl(e),this.calcIsActualSymbol(),this.updateAllViews((0,A.sourceChangeEvent)(this.id())),this.model().lightUpdate(),this._onTemplateApplied.fire()}template(){return this.properties().preferences()}isFixed(){return!1}isLocked(){const e=this.properties().child("frozen");return void 0!==e&&e.value()}isSourceHidden(){return!this._properties.childs().visible.value()||(0,w.hideAllDrawings)().value()&&this.canBeHidden()||!this._isActualInterval||!this._isActualSymbol||!this._isActualCurrency||!this._isActualUnit}isSynchronizable(){return this.priceScale()===this._model.mainSeries().priceScale()}copiable(){return k}cloneable(){return null!==this._ownerSource&&null!==this._ownerSource.firstValue()}movable(){return!0}async getPropertyDefinitionsViewModel(){if(null===this._definitionsViewModel){const e=await this._getPropertyDefinitionsViewModelClass();return null===e||this._isDestroyed?null:(this._definitionsViewModel=new e(this._model.undoModel(),this),this._definitionsViewModel)}return this._definitionsViewModel}title(){return this.translatedType()}translatedType(){var e;return null!==(e=O.lineToolsLocalizedNames[this.toolname])&&void 0!==e?e:"Line Tool"}
name(){return"Line Tool"}createServerPoints(){if(!this._isActualSymbol)return;if(!this._model.chartApi().isConnected().value())return;if(this._clearServerPoints(),this._model.timeScale().isEmpty())return;if(0===this._timePoint.length&&this._points.length>0&&this.normalizePoints(),!this._readyToCreatePointset())return;const e=this._pointsForPointset();if(0===e.length)return;++R,this._currentPointsetAndSymbolId={pointsetId:R,symbolId:(0,r.ensureNotNull)(this._model.mainSeries().seriesSource().symbolInstanceId())};const t=(0,f.getServerInterval)(this.properties().childs().interval.value());this._model.chartApi().createPointset(this._currentPointsetIdWithPrefix(),"turnaround",this._currentPointsetAndSymbolId.symbolId,t,e,this.onData.bind(this))}finish(){}realign(){var e;this.calcIsActualSymbol(),this.isFixed()||this.isSourceHidden()||this._model.lineBeingCreated()===this||this._model.lineBeingEdited()===this||(null===(e=this._currentPointsetAndSymbolId)||void 0===e?void 0:e.symbolId)===this._model.mainSeries().seriesSource().symbolInstanceId()||this._clearServerPoints(),this.updateAllViews((0,A.sourceChangeEvent)(this.id()))}stop(){this._clearServerPoints()}restart(){this.isFixed()||(this._currentPointsetAndSymbolId=null,this.createServerPoints())}isStarted(){return null!==this._currentPointsetAndSymbolId}convertYCoordinateToPriceForMoving(e,t){var i;const s=(0,r.ensureNotNull)(this.priceScale());if(s.isEmpty())return null;const n=this.ownerSource(),o=(0,r.ensure)(null===(i=n||t)||void 0===i?void 0:i.firstValue());return s.coordinateToPrice(e,o)}syncMultichartState(e){const t={points:this._timePoint,interval:this._model.mainSeries().interval()},i=this.linkKey().value();if(null!==i&&this.isSynchronizable()){const s={model:this._model,linkKey:i,symbol:this._model.mainSeries().symbol(),finalState:t,changes:e};(0,w.finishChangingLineTool)(s)}}enableCurrentIntervalVisibility(){const e=this.properties().childs().intervalsVisibilities.state();void 0!==e&&((0,v.makeIntervalsVisibilitiesVisibleAtInterval)(e,b.Interval.parse(this._model.mainSeries().interval())),this.properties().childs().intervalsVisibilities.mergeAndFire(e))}clonePositionOffset(){return this.isFixed()?{barOffset:0,xCoordOffset:20,yCoordOffset:20}:{barOffset:0,xCoordOffset:0,yCoordOffset:-40}}sharingMode(){return this._sharingMode}share(e){this.isSynchronizable()&&this._sharingMode.setValue(e)}syncLineStyleState(){const e=this.properties().state(this._syncStateExclusions);return delete e.interval,e.intervalsVisibilities=(0,v.mergeIntervalVisibilitiesDefaults)(e.intervalsVisibilities),e}moveLineTool(e){e.forEach(((e,t)=>this._setPoint(t,e))),this.normalizePoints()}_setPoint(e,t){this._points[e].index===t.index?this._points[e].price=t.price:this._points[e]=t,this._pointChanged.fire(e)}_correctLastPoint(e){return(0,d.clone)(e)}_pointsForPointset(){return this._timePoint.map((e=>[e.time_t,e.offset]))}_snapPoint45Degree(e,t,i){const s=this._model.timeScale(),n=s.indexToCoordinate(t.index),o=s.indexToCoordinate(e.index)-n,a=(0,
r.ensureNotNull)(this.priceScale()),l=t.price,u=e.price,d=(0,r.ensureNotNull)((0,r.ensureNotNull)(this.ownerSource()).firstValue()),c=a.priceToCoordinate(l,d),h=a.priceToCoordinate(u,d)-c,p=Math.round(Math.atan2(o,h)/Math.PI*4);if(2===Math.abs(p))i||(e.price=l);else if(0===Math.abs(p)||4===Math.abs(p))i||(e.index=t.index);else{const t=Math.sqrt(o*o+h*h),i=o<0?-1:1,r=h<0?-1:1;let l=Math.max(Math.abs(h),Math.abs(o));l/=l*Math.sqrt(2)/t;const u=Math.round(s.coordinateToIndex(n+l*i)),p=Math.abs(s.indexToCoordinate(u)-n),_=a.coordinateToPrice(c+p*r,d);e.index=u,e.price=_}}normalizePoint(e){return{...this._model.timeScale().normalizeBarIndex(e.index),price:e.price}}normalizePoints(){this._timePoint=[];for(let e=0;e<this._points.length;e++)if(void 0!==this._points[e].index){const t=this.normalizePoint(this._points[e]);if(!t.time_t){this._timePoint=[];break}this._timePoint.push(t)}this._normalizedPointsChanged.fire()}_setPaneViews(e,t,i){if(this._isDestroyed)for(const t of e)t.destroy&&t.destroy();else this._paneViews.set(t,e),void 0!==t&&i&&t.onDestroyed().subscribe(this,(()=>this._destroyPanePaneViews(t))),this._model.lightUpdate()}_getPaneViews(e){return this._paneViews.get(e)||null}_updateAllPaneViews(e){this._paneViews.forEach((t=>{for(const i of t)i.update(e)}))}_alignPointHorizontallyOrVertically(e){const t=(0,r.ensureNotNull)(this.pointToScreenPoint(e)),i=(0,r.ensureDefined)((0,r.ensureNotNull)(this._startMovingPoint).logical),s=(0,r.ensureDefined)((0,r.ensureNotNull)(this._startMovingPoint).screen),n=Math.abs(s.x-t.x),o=Math.abs(s.y-t.y);if(n<10&&o<10)return e;return{index:n<o?i.index:e.index,price:n<o?e.price:i.price}}_alignScreenPointHorizontallyOrVertically(e){const t=(0,r.ensureDefined)((0,r.ensureNotNull)(this._startMovingPoint).screen),i=Math.abs(t.x-e.x),n=Math.abs(t.y-e.y);return i<10&&n<10?e:i<n?new s.Point(t.x,e.y):new s.Point(e.x,t.y)}_correctPoints(e,t){const i=(0,r.ensureDefined)((0,r.ensureNotNull)(this._currentMovingPoint).screen),s=(0,r.ensureDefined)((0,r.ensureNotNull)(this._startMovingPoint).screen),n=i.subtract(s);if(n.length()<1&&!t)return!1;for(let t=0;t<e.length;t++){const i=e[t],s=(0,r.ensureNotNull)(this.pointToScreenPoint(i)).add(n),o=(0,r.ensureNotNull)(this.screenPointToPoint(s));e[t].index=o.index,e[t].price=o.price}return!0}_correctFixedPoint(e){if(void 0===this._fixedPoint)return{didCorrect:!1,point:e};const t=(0,r.ensureDefined)((0,r.ensureNotNull)(this._currentMovingPoint).screen),i=(0,r.ensureDefined)((0,r.ensureNotNull)(this._startMovingPoint).screen),s=t.subtract(i);return s.length()>=1?{didCorrect:!0,point:e.add(s)}:{didCorrect:!1,point:e}}_currentPointsetIdWithPrefix(){return"pointset_"+(0,r.ensureNotNull)(this._currentPointsetAndSymbolId).pointsetId}_clearServerPoints(){null!==this._currentPointsetAndSymbolId&&this._model.chartApi().isConnected().value()&&this._model.chartApi().removePointset(this._currentPointsetIdWithPrefix()),this._currentPointsetAndSymbolId=null}_createPointProperty(e){const t=this._pointsProperty.childs().points;t.addProperty(""+e,{});const i=t[e]
;i.addChild("price",new L.LineDataSourcePointPriceProperty(this,e)),i.addChild("bar",new x.LineDataSourcePointIndexProperty(this,e))}_createPointsProperties(){this._pointsProperty=new(I()),this._pointsProperty.addChild("points",new(I()));for(let e=0;e<this.pointsCount();e++)this._createPointProperty(e)}_alignPointToRangeOfActualData(e){const t=(0,r.ensureNotNull)(this._model.mainSeries().bars().firstIndex()),i=(0,r.ensureNotNull)(this._model.mainSeries().bars().lastIndex());let s=Math.max(e.index,t);return s=Math.min(s,i),{...e,index:s}}_migrateSymbolProperty(){const e=this._properties.childs();if(e.symbolStateVersion.value()<2){const t=(0,r.ensureNotNull)(this.ownerSource()),i=(0,r.ensureNotNull)(t.symbolSource()),s=this._model.mainSeries();if(i===s)return void e.symbolStateVersion.setValueSilently(2);if(null===s.symbolInfo())return;if(null===i.symbolInfo())return;s.symbolSameAsCurrent(e.symbol.value())&&e.symbol.setValueSilently(i.symbol()),e.symbolStateVersion.setValueSilently(2)}}_migrateZOrder(){const e=this._properties.childs();e.zOrderVersion.value()<2&&(this.ownerSource()===this.model().mainSeries()&&this.setZorder(this.zorder()-this.model().mainSeries().obsoleteZOrder()),e.zOrderVersion.setValueSilently(2))}_preparePoint(e,t){const i=e;return t&&t.shift()&&this.points().length>=2&&this._snapTo45DegreesAvailable()&&this._snapPoint45Degree(i,this.points()[this.points().length-2]),i}_addPointIntenal(e,t,i){this._points.push(e);const s=this._points.length===this.pointsCount();return s?(this._lastPoint=null,i||(this.normalizePoints(),this.createServerPoints())):this._lastPoint=e,this._pointAdded.fire(this._points.length-1),s}_onSourceHiddenMayChange(){this._model.invalidate(m.InvalidationMask.validateAction((()=>{this!==this._model.lineBeingCreated()&&(this._isDestroyed||this.processHibernate())})))}_saveAlertIdInState(){return!0}_onPointsetUpdated(e){if(0!==e.length){for(let t=0;t<e.length;t++){const i=e[t],s=this._timePoint[i.index],r={index:i.value[0],time:new Date(1e3*i.value[1]),price:s.price};this._points.length<=i.index?(this._points.push(r),this._pointAdded.fire(this._points.length-1)):(this._points[i.index]=r,this._pointChanged.fire(i.index))}{const e=this;e.recalculateStateByData&&e.recalculateStateByData()}this.updateAllViewsAndRedraw((0,A.sourceChangeEvent)(this.id()))}}_snapTo45DegreesAvailable(){return!1}_onMainSeriesSymbolResolved(){const e=this.ownerSource();null===e||this._model.mainSeries()===e.symbolSource()||this.isSourceHidden()||this.createServerPoints()}_readyToCreatePointset(){return this._timePoint.length>0}_onAlertData(e){}_propertiesStateExclusions(){return null}_syncLineStyleIfNeeded(){const e=this.linkKey().value();!this._syncLineStyleMuted&&e&&(0,w.changeLineStyle)({linkKey:e,state:this.syncLineStyleState(),model:this._model})}_muteSyncLineStyle(){this._syncLineStyleMuted=!0}_unmuteSyncLineStyleWithoutApplyingChanges(){this.propertiesChanged(),this._syncLineStyleMuted=!1}_applyTemplateImpl(e){e.intervalsVisibilities=(0,v.mergeIntervalVisibilitiesDefaults)(e.intervalsVisibilities)
;const t=this.properties();t.mergePreferences(e),t.saveDefaults(),this.propertiesChanged()}_getPropertyDefinitionsViewModelClass(){return Promise.resolve(null)}_getAlertPlots(){return[]}_getUndoHistory(){return this._model.undoModel().undoHistory()}_synchronizeAlert(e){const t=this._getUndoHistory();if(!this._undoCheckpointAlert&&!this._alertUndoMode){const e=t.undoStack().pop();this._undoCheckpointAlert=t.createUndoCheckpoint(),e&&t.undoStack().push(e)}const i=e=>{const t=e.description()!==e.defaultDescription(),i=(0,r.ensureNotNull)(e.seriesState()),s=this._model.mainSeries().stateForAlert();"MainSeries"===i.type&&s.actualSymbol===i.actualSymbol&&e.setSeriesState(s),e.setMainSeriesState(s),e.setSymbol(s.symbolString);const n=(0,r.ensureNotNull)(this.stateForAlert());e.setResolution(n.interval),e.setLineState(n),t||e.resetToDefaultDescription(),this._localAndServerAlertsMismatch=!0},s=()=>{this._alertUndoMode=!0,t.undoToCheckpoint((0,r.ensureDefined)(this._undoCheckpointAlert)),setTimeout((()=>{this._alertUndoMode=!1,this._localAndServerAlertsMismatch=!1}),0)},n=e=>{"not_exists"!==e&&(D.logError("Getting alert failed: "+e),s())},o=async e=>{(await(0,c.getChartAlertsFacade)()).restartAlert(e,{success:()=>this._localAndServerAlertsMismatch=!1,error:n,complete:()=>delete this._undoCheckpointAlert,actionSource:"drawing_sync"})};(0,h.canPlaceAlertOnResolution)(this.stateForAlert().interval)?this.getAlert().then((t=>{t?(i(t),e&&(o(t),this._onAlertData(t))):D.logError("Failed to get alert, drawing and alert are not synchronized")})).catch(n):this._alertUndoMode||((0,p.showGoProAlertsOnSecondsDialog)(),s(),delete this._undoCheckpointAlert)}_linePointsToAlertPlot(e,t,i,s){if(2!==e.length)return D.logError("[Drawing Alert] Wrong points"),null;const n=this._model.timeScale();return!n||n.isEmpty()?null:{type:"LinePlot",title:t||this.translatedType(),timestamp:(0,r.ensureNotNull)(n.indexToTimePoint(0)),offset1:e[0].index,offset2:e[1].index,price1:e[0].price,price2:e[1].price,extendBackward:i||!1,extendForward:s||!1}}static _configureProperties(e){if(this._addCollectedProperties(e),e.hasChild("symbolStateVersion")||e.addChild("symbolStateVersion",new(I())(1)),e.hasChild("zOrderVersion")||e.addChild("zOrderVersion",new(I())(1)),e.hasChild("visible")||e.addChild("visible",new(I())(!0)),e.hasChild("frozen")||e.addChild("frozen",new(I())(!1)),e.hasChild("symbol")||e.addChild("symbol",new(I())("")),e.hasChild("currencyId")||e.addChild("currencyId",new(I())(null)),e.hasChild("unitId")||e.addChild("unitId",new(I())(null)),e.addExclusion("symbolStateVersion"),e.addExclusion("zOrderVersion"),e.addExclusion("visible"),e.addExclusion("frozen"),e.addExclusion("symbol"),e.addExclusion("currencyId"),e.addExclusion("unitId"),e.hasChild("intervalsVisibilities")){const t=(0,d.merge)((0,d.clone)(y.intervalsVisibilitiesDefaults),e.childs().intervalsVisibilities.state());e.removeProperty("intervalsVisibilities"),e.addChild("intervalsVisibilities",new C.IntervalsVisibilitiesProperty(t))
}else e.addChild("intervalsVisibilities",new C.IntervalsVisibilitiesProperty(y.intervalsVisibilitiesDefaults));e.hasChild("title")||e.addChild("title",new(I())("")),e.addExclusion("symbolInfo"),e.addExclusion("points"),e.addExclusion("interval"),e.addExclusion("title"),e.hasChild("singleChartOnly")&&e.removeProperty("singleChartOnly"),e.hasChild("font")&&e.removeProperty("font")}static _addCollectedProperties(e){e.hasChild("linewidth")&&e.addChild("linesWidths",new N.LineToolWidthsProperty([(0,r.ensureDefined)(e.child("linewidth"))])),e.hasChild("linecolor")&&e.addChild("linesColors",new N.LineToolColorsProperty([(0,r.ensureDefined)(e.child("linecolor"))])),e.hasChild("backgroundColor")&&e.addChild("backgroundsColors",new N.LineToolColorsProperty([(0,r.ensureDefined)(e.child("backgroundColor"))])),e.hasChild("textColor")&&e.addChild("textsColors",new N.LineToolColorsProperty([(0,r.ensureDefined)(e.child("textColor"))])),e.addExclusion("linesWidths"),e.addExclusion("linesColors"),e.addExclusion("backgroundsColors"),e.addExclusion("textsColors")}_removeAlertSubscriptions(){var e;null===(e=this._unsubscribeAlertCallbacks)||void 0===e||e.call(this),this._unsubscribeAlertCallbacks=void 0}_addAlertSubscriptions(e){if(void 0!==this._unsubscribeAlertCallbacks)return;const t=this.properties().child("extendLeft"),i=this.properties().child("extendRight"),s=e.destroyed().spawn(),r=e.selected().spawn(),n=e.hovered().spawn();s.subscribe(this.removeAlert.bind(this)),r.subscribe((e=>{this._model.selectionMacro((t=>{e?t.addSourceToSelection(this):t.removeSourceFromSelection(this)}))})),n.subscribe((e=>{const t=this._model.hoveredSource();e&&t!==this?this._model.setHoveredSource(this,null):e||t!==this||this._model.setHoveredSource(null,null)})),void 0!==t&&t.subscribe(this,(()=>this.synchronizeAlert(!1))),void 0!==i&&i.subscribe(this,(()=>this.synchronizeAlert(!1))),this._unsubscribeAlertCallbacks=()=>{s.destroy(),n.destroy(),r.destroy(),void 0!==t&&t.unsubscribeAll(this),void 0!==i&&i.unsubscribeAll(this)}}_destroyPanePaneViews(e){const t=this._paneViews.get(e);if(void 0!==t)for(const e of t)e.destroy&&e.destroy();void 0!==e&&e.onDestroyed().unsubscribeAll(this),this._paneViews.delete(e)}_copyPricesWithoutNormalization(){const e=Math.min(this._points.length,this._timePoint.length);for(let t=0;t<e;t++)this._timePoint[t].price=this._points[t].price}}},968361:(e,t,i)=>{"use strict";t.LineToolFibRetracement=i(498995).LineToolFibRetracement,t.LineToolFibChannel=i(965989).LineToolFibChannel,t.LineToolFibSpeedResistanceArcs=i(974472).LineToolFibSpeedResistanceArcs,t.LineToolProjection=i(506416).LineToolProjection,t.LineToolTrendBasedFibExtension=i(882980).LineToolTrendBasedFibExtension,t.LineToolElliott=i(960690).LineToolElliott,t.LineToolFibCircles=i(953718).LineToolFibCircles,t.LineToolVertLine=i(43653).LineToolVertLine,t.LineToolCrossLine=i(73217).LineToolCrossLine,t.LineToolBarsPattern=i(180148).LineToolBarsPattern,t.LineToolTrendBasedFibTime=i(418219).LineToolTrendBasedFibTime,t.LineToolFibTimeZone=i(958849).LineToolFibTimeZone,
t.LineToolCircleLines=i(236549).LineToolCircleLines,t.LineToolDateRange=i(727264).LineToolDateRange,t.LineToolPriceRange=i(830695).LineToolPriceRange,t.LineToolDateAndPriceRange=i(836843).LineToolDateAndPriceRange,t.LineToolParallelChannel=i(247035).LineToolParallelChannel,t.LineToolTrendAngle=i(167723).LineToolTrendAngle,t.LineToolTrendLine=i(956268).LineToolTrendLine,t.LineToolInfoLine=i(933513).LineToolInfoLine,t.LineToolArrowMark=i(41394).LineToolArrowMark,t.LineToolImage=i(17329).LineToolImage,t.LineToolPitchfan=i(932732).LineToolPitchfan,t.LineToolGannSquare=i(168853).LineToolGannSquare,t.LineToolFibSpeedResistanceFan=i(63491).LineToolFibSpeedResistanceFan,t.LineToolGannComplex=i(833762).LineToolGannComplex,t.LineToolGannFixed=i(839386).LineToolGannFixed,t.LineToolGannFan=i(643442).LineToolGannFan,t.LineToolFibWedge=i(781811).LineToolFibWedge,t.LineToolPitchfork=i(9093).LineToolPitchfork,t.LineToolDisjointAngle=i(709638).LineToolDisjointChannel,t.LineToolFlatBottom=i(634659).LineToolFlatBottom,t.LineToolIcon=i(7295).LineToolIcon,t.LineToolEmoji=i(443361).LineToolEmoji,t.LineToolSticker=i(7948).LineToolSticker,t.LineToolRotatedRectangle=i(605703).LineToolRotatedRectangle,t.LineToolFibSpiral=i(165438).LineToolFibSpiral,t.LineToolHeadAndShoulders=i(336471).LineToolHeadAndShoulders,t.LineToolTriangle=i(287743).LineToolTriangle,t.LineToolTrianglePattern=i(948653).LineToolTrianglePattern,t.LineTool5PointsPattern=i(147985).LineTool5PointsPattern,t.LineToolThreeDrivers=i(521600).LineToolThreeDrivers,t.LineToolABCD=i(78).LineToolABCD,t.LineToolPolyline=i(527342).LineToolPolyline,t.LineToolPath=i(999432).LineToolPath,t.LineToolPrediction=i(240569).LineToolPrediction,t.LineToolPriceLabel=i(729443).LineToolPriceLabel,t.LineToolPriceNote=void 0,t.LineToolArrowMarker=i(683396).LineToolArrowMarker,t.LineToolNote=i(619540).LineToolNote,t.LineToolNoteAbsolute=i(619540).LineToolNoteAbsolute,t.LineToolSignpost=i(812788).LineToolSignpost,t.LineToolBrush=i(271133).LineToolBrush,t.LineToolArc=i(907416).LineToolArc,t.LineToolCallout=i(844295).LineToolCallout,t.LineToolBalloon=i(179180).LineToolBalloon,t.LineToolComment=i(768574).LineToolComment,t.LineToolText=i(520259).LineToolText,t.LineToolHorzLine=i(994761).LineToolHorzLine,t.LineToolHorzRay=i(867716).LineToolHorzRay,t.LineToolRectangle=i(442724).LineToolRectangle,t.LineToolCircle=i(638202).LineToolCircle,t.LineToolEllipse=i(43853).LineToolEllipse,t.LineToolTimeCycles=i(36459).LineToolTimeCycles,t.LineToolSineLine=i(305480).LineToolSineLine,t.LineToolGhostFeed=i(711755).LineToolGhostFeed,t.LineToolBezierQuadro=i(516487).LineToolBezierQuadro,t.LineToolBezierCubic=i(511628).LineToolBezierCubic,t.LineToolArrow=i(548160).LineToolArrow,t.LineToolRay=i(352747).LineToolRay,t.LineToolExtended=i(252598).LineToolExtended,t.LineToolSchiffPitchfork=i(115137).LineToolSchiffPitchfork,t.LineToolSchiffPitchfork2=i(126144).LineToolSchiffPitchfork2,t.LineToolInsidePitchfork=i(478760).LineToolInsidePitchfork,t.LineToolTextAbsolute=i(520259).LineToolTextAbsolute,
t.LineToolArrowMarkLeft=i(41394).LineToolArrowMarkLeft,t.LineToolArrowMarkRight=i(41394).LineToolArrowMarkRight,t.LineToolArrowMarkUp=i(41394).LineToolArrowMarkUp,t.LineToolArrowMarkDown=i(41394).LineToolArrowMarkDown,t.LineToolFlagMark=i(218032).LineToolFlagMark,t.LineToolCypherPattern=i(224777).LineToolCypherPattern,t.LineToolElliottImpulse=i(960690).LineToolElliottImpulse,t.LineToolElliottTriangle=i(960690).LineToolElliottTriangle,t.LineToolElliottTripleCombo=i(960690).LineToolElliottTripleCombo,t.LineToolElliottCorrection=i(960690).LineToolElliottCorrection,t.LineToolElliottDoubleCombo=i(960690).LineToolElliottDoubleCombo,t.LineToolRiskRewardLong=i(864555).LineToolRiskRewardLong,t.LineToolRiskRewardShort=i(864555).LineToolRiskRewardShort,t.LineToolPosition=i(674053).LineToolPosition,t.LineToolOrder=i(778737).LineToolOrder,t.LineToolHighlighter=i(680330).LineToolHighlighter,t.LineToolTweet=i(623336).LineToolTweet,t.LineToolIdea=i(900569).LineToolIdea},806960:(e,t,i)=>{"use strict";i.d(t,{StudyLineDataSourceWithPlots:()=>a});var s=i(203308),r=i(650151),n=i(817724),o=i(534741);class a extends n.StudyLineDataSource{lastValueData(e,t,i){const n={noData:!0},a=this.priceScale();if(this._model.timeScale().isEmpty()||null===this.priceScale()||null===a||a.isEmpty()||this.plots().isEmpty())return n;const l=this._model.timeScale().visibleBarsStrictRange();if(null===l)return n;const u=this._studyProps();if(!u.childs().visible.value())return n;const d=this.plots().search(l.lastBar(),o.PlotRowSearchMode.NearestLeft,1);if(null===d)return n;const c=l.contains(d.index),h=!t&&c?d:(0,r.ensureNotNull)(this.plots().last()),p=this.metaInfo().plots.findIndex((t=>t.id===e));if(p<0||!h||!(0,s.default)(h.value[p+1]))return n;const _=h.value[p+1];if(null==_)return n;const m=(0,r.ensureDefined)(u.childs().styles.child(e)),f=(0,r.ensureNotNull)(this.firstValue()),v=a.priceToCoordinate(_,f);return{...a.getFormattedValues(_,f),noData:!1,price:_,color:m.childs().color.value(),coordinate:v,floatCoordinate:v,index:h.index}}priceLabelText(e){const t=(0,r.ensureDefined)(this._metaInfo.styles);return(0,r.ensureDefined)(t[e]).title}offset(e){return 0}getMinFirstBarIndexForPlot(){return-1/0}isPlotVisibleAt(e,t){return(this._studyProps().childs().styles.childs()[e].childs().display.value()&t)===t}_studyProps(){return this.properties()}}},817724:(e,t,i)=>{"use strict";i.d(t,{StudyLineDataSource:()=>I});var s=i(650151),r=i(389137),n=i(195447),o=i(821979),a=i(853965),l=i(526075),u=i(582533),d=i(62745),c=i(114315),h=i(799567),p=i(989709),_=i(311862),m=i(988124),f=i(242558),v=i(964824),y=i(504101),g=i(985715);class S extends g.StatusProviderBase{constructor(e){super(e.model().properties().childs().scalesProperties.childs().textColor),this._source=e}color(){return"#ff0000"}errorStatus(){const e=this._source.status();return e.type===y.StudyStatusType.Error?{error:this.sourceStatusText(),solutionId:(0,y.studyStatusSolutionId)(e),title:(0,y.studyStatusTitle)(e),studyFeature:(0,y.studyStatusFeature)(e)}:null}getSplitTitle(){return this._source.titleInParts()}
text(){return this._source.translatedType()}sourceStatusText(){return(0,y.convertStudyStatusToString)(this._source.status(),!0)}}var b=i(877009),P=i(855353);class I extends o.LineDataSource{constructor(e,t,s,r,n,o){super(e,r,n,o),this._indexes=null,this._inputs=null,this._definitionsViewModel=null,this._pointsetPoints=null,this._loadedPlots=null,this._loadedGraphics=null,this._beingCreatedPaneView=null,this._anchorsPaneView=null,this._isLegendDisplayed=!1,this._alignerCache=null,Promise.all([Promise.all([i.e(98081),i.e(51583)]).then(i.bind(i,67663)),Promise.all([i.e(98081),i.e(51583)]).then(i.bind(i,199258))]).then((t=>{const{LineToolBeingCreatedPaneView:i}=t[0],{StudyLineDataSourceAnchorsPaneView:s}=t[1];this._beingCreatedPaneView=new i(this,e),this._anchorsPaneView=new s(this,this.model()),this._model.lightUpdate()})),this._metaInfo=t,this._dataSource=new c.ExtendedStudyDataSource(e.chartApi(),e.mainSeries(),s,t),this._dataSource.dataCleared().subscribe(this,this._onDataCleared),this._dataSource.dataUpdated().subscribe(this,this._onDataUpdated),this._dataSource.studyStatusChanged().subscribe(this,this._onStudyStatusChanged),this._statusProvider=new S(this),this._statusView=new P.LineToolStudyStatusView(this),this._showStudyArgumentsProperty=e.properties().childs().paneProperties.childs().legendProperties.childs().showStudyArguments}isDisplayedInLegend(){return this._isLegendDisplayed}titleInParts(){const e=[];if(this._showStudyArgumentsProperty.value()&&this._inputs)for(const t of this._metaInfo.inputs){if(!0===t.isHidden||"bool"===t.type)continue;const i=this._inputs[t.id];e.push(i.toString())}return[this.name(),e]}destroy(){this._dataSource.dataUpdated().unsubscribeAll(this),this._dataSource.dataCleared().unsubscribeAll(this),this._dataSource.studyStatusChanged().unsubscribeAll(this),this._dataSource.destroy(),null!==this._definitionsViewModel&&(this._definitionsViewModel.destroy(),this._definitionsViewModel=null),this._unsubscribeApplyInputsOnSeriesCompleted(),this._isDestroyed=!0,super.destroy()}stop(){super.stop(),this._isDestroyed||(this._dataSource.stop(),this.clearData())}start(){super.start(),this._isDestroyed||null===this._inputs||this._dataSource.start()}metaInfo(){return this._metaInfo}graphicsInfo(){return this._metaInfo.graphics}series(){return this._model.mainSeries()}translatedType(){return this._metaInfo.description}name(){return this._metaInfo.description}studyId(){return this._metaInfo.id}setPoint(e,t,i){super.setPoint(e,this._preparePoint(t,i))}move(e){}clearData(){this._clearAllDataExceptPointsetPoints(),this._pointsetPoints=null,this.updateAllViews((0,v.sourceChangeEvent)({sourceId:this.id(),clearData:!0})),super.clearData()}data(){return this.plots()}plots(){return this._loadedPlots||this._dataSource.plots()}graphics(){return this._loadedGraphics||this._dataSource.graphics()}valueAt(e,t){var i,s;return null!==(s=null===(i=this.ownerSource())||void 0===i?void 0:i.symbolSource().valueAt(e,t))&&void 0!==s?s:null}firstValue(){return this._model.mainSeries().firstValue()}state(e){
const t=super.state(e);let i;this.metaInfo()instanceof l.StudyMetaInfo?i=this.metaInfo().state():(i=(0,r.clone)(this.metaInfo()),i.id=l.StudyMetaInfo.parseIdString(i.id+(i.version?"-"+i.version:"")).fullId);const s={...t,metaInfo:i};return e&&(s.data=this.plots().state(),s.nonseriesindexes=this._indexes,s.graphics=(0,u.saveStudyGraphics)(this.graphics(),null)),s}restoreData(e){var t;void 0!==e.data&&(this._loadedPlots=new n.PlotList((0,p.studyPlotFunctionMap)(this._metaInfo),p.studyEmptyPlotValuePredicate),this._loadedPlots.restoreState(e.data)),this._indexes=null!==(t=e.nonseriesindexes)&&void 0!==t?t:this._indexes,this._loadedGraphics=e.graphics?(0,u.loadStudyGraphics)(e.graphics):this._loadedGraphics}getPropertyDefinitionsViewModel(){return null===this._definitionsViewModel?this._getPropertyDefinitionsViewModelClass().then((e=>null===e||this._isDestroyed?null:(null===this._definitionsViewModel&&(this._definitionsViewModel=new e(this._model.undoModel(),this)),this._definitionsViewModel))):Promise.resolve(this._definitionsViewModel)}paneViews(e){let t=[];if(this.isSourceHidden())return t;if(this._isReady()&&this._changeStatesStack.isEmpty()){const i=super.paneViews(e);null!==i&&(t=t.concat(i))}else null!==this._beingCreatedPaneView&&t.push(this._beingCreatedPaneView);return null!==this._anchorsPaneView&&t.push(this._anchorsPaneView),t}propertiesChanged(e){super.propertiesChanged(e),this._onStudyInputsMayChange()}dataAndViewsReady(){return super.dataAndViewsReady()&&this._isReady()}endChanging(e,t){const i=super.endChanging(e,t);return i.indexesChanged?this.clearData():this._updateAnchorsPrice(!0),i}moveData(e){this._dataSource.moveData(e)}restorePoints(e,t,i){super.restorePoints(e,t,i),this._updateAnchorsPrice(!0)}realign(){super.realign(),null===this._model.mainSeries().symbolInfo()&&(this._alignerCache=null)}statusProvider(e){return this._statusProvider}statusView(){return this._statusView}legendView(){return null}dataProblemModel(){return null}dataUpdatedModeModel(){return null}marketStatusModel(){return null}onStatusChanged(){return this._dataSource.studyStatusChanged()}status(){return this._dataSource.studyStatus()}recalcStudyIfNeeded(){}static createPropertiesFromStudyMetaInfoAndState(e,t,i,s){const r=(0,_.prepareStudyPropertiesForLoadChart)(e,t,i,s);return this._configureProperties(r),r}_onStudyStatusChanged(e,t){let i;switch(t.type){case h.StudyStatusType.Error:i=!0;break;case h.StudyStatusType.Completed:i=!1;break;default:return}if(i===this._isLegendDisplayed)return;this._isLegendDisplayed=i;const s=this._model.paneForSource(this);if(s){const e=this._model.panes().indexOf(s),t=b.InvalidationMask.invalidateLegendWidgetLayout(e);this.model().invalidate(t)}}_studyId(){return this._dataSource.studyId()}_isReady(){return!0}_updateAllPaneViews(e){var t,i;super._updateAllPaneViews(e),null===(t=this._beingCreatedPaneView)||void 0===t||t.update(),null===(i=this._anchorsPaneView)||void 0===i||i.update(e)}_getPointTime(e,t){const i=e.index,s=this._model.timeScale().indexToTimePoint(i);if(null!==s)return s
;if(t||void 0===e.time)return null;const r=this._model.mainSeries().symbolInfo();if(null===r)return null;let n=this._model.properties().childs().timezone.value();"exchange"===n&&(n=r.timezone);const o=(0,m.cal_to_utc)((0,m.get_timezone)(n),e.time);return this._getStartBarAligner()(o)/1e3}_updateAnchorsPrice(e){}_onPointsetUpdated(e){super._onPointsetUpdated(e),this._pointsetPoints=this._points.map((e=>({price:e.price,index:e.index,time:e.time}))),this._onStudyInputsMayChange()}_onDataCleared(){this.updateAllViews((0,v.sourceChangeEvent)({sourceId:this.id(),clearData:!0})),this._model.updateSource(this)}_onDataUpdated(e,t,i){var s;this._updateAnchorsPrice(),this.updateAllViews((0,v.sourceChangeEvent)({sourceId:this.id(),firstUpdatedTimePointIndex:null===(s=e[0])||void 0===s?void 0:s.index})),this._model.updateSource(this)}_onStudyInputsMayChange(){let e=null;if(null!==this._pointsetPoints&&this._pointsetPoints.length===this.pointsCount()&&(e=this._studyInputs(this._pointsetPoints),null===e&&(this._clearAllDataExceptPointsetPoints(),this.updateAllViews((0,v.sourceChangeEvent)(this.id())))),null!==e){const t=this.metaInfo().inputs.map((e=>e.id)),i=Object.keys(e);for(const s of i)t.includes(s)||delete e[s]}this._areInputsEqual(this._inputs,e)||this._applyStudyInputs(e)}_preparePoint(e,t){return super._preparePoint(this._alignPointToRangeOfActualData(e),t)}_getPropertyDefinitionsViewModelClass(){return Promise.resolve(null)}_subscribeApplyInputsOnSeriesCompleted(){this._unsubscribeApplyInputsOnSeriesCompleted(),this._model.mainSeries().dataEvents().completed().subscribe(this,(()=>this._onStudyInputsMayChange()),!0)}_unsubscribeApplyInputsOnSeriesCompleted(){this._model.mainSeries().dataEvents().completed().unsubscribeAll(this)}_onInputsChanged(){this.hasAlert.value()&&(this._localAndServerAlertsMismatch=!0)}static _createPropertiesFromStudyIdAndState(e,t){const i=l.StudyMetaInfo.getStudyPropertyRootNameById(e),s=new a.DefaultProperty(i,t);return this._configureProperties(s),s}static _configureProperties(e){super._configureProperties(e),e.removeExclusion("intervalsVisibilities")}_areInputsEqual(e,t){return null===t?null===e:null!==e&&(0,d.areStudyInputsEqual)(this._metaInfo.inputs,e,t)}_applyStudyInputs(e){const t=this._inputs;this._inputs=e,null!==e&&(this._unsubscribeApplyInputsOnSeriesCompleted(),this._dataSource.setInputs(e),null===t&&this.isStarted()&&!this._dataSource.isStarted()&&this._dataSource.start()),this._onInputsChanged()}_clearAllDataExceptPointsetPoints(){this._inputs=null,this._dataSource.clearData(),this._loadedPlots=null,this._indexes=null,this._loadedGraphics=null}_getStartBarAligner(){const e=this._model.mainSeries().interval();return null!==this._alignerCache&&this._alignerCache.resolution===this._model.mainSeries().interval()||(this._alignerCache={resolution:e,aligner:(0,f.createTimeToBarTimeAligner)(e,(0,s.ensureNotNull)(this._model.mainSeries().symbolInfo()))}),this._alignerCache.aligner}}},477227:(e,t,i)=>{"use strict";const s=i(821979).LineDataSource,r=i(593804).alignToStep;class n extends s{
constructor(e,t){super(e,t),this.customization.forcePriceAxisLabel=!0,this.customization.disableErasing=!0,this.customization.showInObjectsTree=!1,this.setSelectionEnabled(!1)}isSynchronizable(){return!1}pointsCount(){return n.POINTS_COUNT}hasContextMenu(){return!1}state(){return null}startMoving(){super.startMoving.apply(this,arguments),this._cursorMoved=!1}endMoving(){super.endMoving.apply(this,arguments),this._cursorMoved=!1}_correctPoints(e,t){this._currentMovingPoint&&this._startMovingPoint?this._currentMovingPoint.logical.price-this._startMovingPoint.logical.price&&(this._cursorMoved=!0):this._cursorMoved=!1;for(var i=1/this.priceScale().mainSource().base(),s=0;s<e.length;s++){var n=e[s];this._cursorMoved&&(n.price=this._currentMovingPoint.logical.price),n.price=r(n.price,i),e[s]=n}}userEditEnabled(){return!0}movable(){return!1}canBeHidden(){return!1}isUserDeletable(){return!1}showInObjectTree(){return!1}doesMovingAffectsUndo(){return!1}isAvailableInFloatingWidget(){return!1}timeAxisViews(){return null}cloneable(){return!1}copiable(){return!1}}n.POINTS_COUNT=1,e.exports.LineToolTrading=n},178389:(e,t,i)=>{"use strict";i.d(t,{ensureTimePointIndexIndex:()=>n,unpackNonSeriesData:()=>o});var s=i(130551),r=i(133822);function n(e){if(e<0)throw new Error("TimePointIndexIndex should be non-negative integer");return e}async function o(e){if(""===e)return null;const t=JSON.parse(e);if(!(0,s.isObject)(t)||"function"==typeof t)throw new Error("Non-object content in the non-series envelope");if((0,s.hasProperty)(t,"indexes_replace"))return{indexes_replace:!0};const n={indexes_replace:!1};if((0,s.hasProperty)(t,"offsets")&&(n.offsets=t.offsets),(0,s.hasProperty)(t,"isUpdate")){if("boolean"!=typeof t.isUpdate)throw new Error('Invalid type of "isUpdate" field');n.isUpdate=t.isUpdate}if((0,s.hasProperty)(t,"data")&&(n.data=t.data),(0,s.hasProperty)(t,"graphicsCmds")&&(n.graphicsCmds=(0,r.validateGraphicsCommands)(t.graphicsCmds)),(0,s.hasProperty)(t,"dataCompressed")||(0,s.hasProperty)(t,"graphicsCmdsCompressed")){const{default:e}=await Promise.all([i.e(93194),i.e(81578)]).then(i.t.bind(i,593194,23));if((0,s.hasProperty)(t,"dataCompressed")){const i=await(new e).loadAsync(t.dataCompressed,{base64:!0});n.data=JSON.parse(await i.file("").async("text"))}if((0,s.hasProperty)(t,"graphicsCmdsCompressed")){const i=await(new e).loadAsync(t.graphicsCmdsCompressed,{base64:!0});n.graphicsCmds=(0,r.validateGraphicsCommands)(JSON.parse(await i.file("").async("text")))}return n}return n}},195447:(e,t,i)=>{"use strict";i.r(t),i.d(t,{PlotList:()=>h,mergeMinMax:()=>p,mergePlotRows:()=>_});var s=i(650151),r=i(674981),n=i(732149),o=i(201089),a=i(534741);const l=(0,o.getLogger)("Chart.PlotList"),u=30;function d(e){return e.index}function c(e){return e.value[0]}class h{constructor(e=null,t=null){this._items=[],this._start=0,this._end=0,this._shareRead=!1,this._minMaxCache=new Map,this._rowSearchCacheByIndex=new Map,this._rowSearchCacheByIndexWithoutEmptyValues=new Map,this._rowSearchCacheByTime=new Map,
this._rowSearchCacheByTimeWithoutEmptyValues=new Map,this._plotFunctions=e||new Map,this._emptyValuePredicate=t}clear(){this._items=[],this._start=0,this._end=0,this._shareRead=!1,this._minMaxCache.clear(),this._invalidateSearchCaches()}first(){return this.size()>0?this._items[this._start]:null}last(){return this.size()>0?this._items[this._end-1]:null}firstIndex(){return this.size()>0?this._indexAt(this._start):null}lastIndex(){return this.size()>0?this._indexAt(this._end-1):null}size(){return this._end-this._start}isEmpty(){return 0===this.size()}contains(e){return null!==this.search(e,a.PlotRowSearchMode.Exact)}valueAt(e){const t=this.search(e);return null!==t?t.value:null}add(e,t){if(this._shareRead)return l.logDebug("add: readonly collection modification attempt"),!1;const i={index:e,value:t},s=this._nonCachedSearch(e,a.PlotRowSearchMode.Exact,d);return this._invalidateSearchCaches(),null===s?(this._items.splice(this._lowerbound(e,d),0,i),this._start=0,this._end=this._items.length,!0):(this._items[s]=i,!1)}search(e,t=a.PlotRowSearchMode.Exact,i){return this._searchImpl(e,t,this._rowSearchCacheByIndex,this._rowSearchCacheByIndexWithoutEmptyValues,d,i)}searchByTime(e,t=a.PlotRowSearchMode.Exact,i){return this._searchImpl(e,t,this._rowSearchCacheByTime,this._rowSearchCacheByTimeWithoutEmptyValues,c,i)}fold(e,t){let i=t;for(let t=this._start;t<this._end;++t){i=e(this._indexAt(t),this._valueAt(t),i)}return i}findFirst(e,t){const i=void 0!==t&&Math.min(this._start+t,this._end)||this._end;for(let t=this._start;t<i;++t){const i=this._indexAt(t),s=this._valueAt(t);if(e(i,s))return{index:i,value:s}}return null}findLast(e,t){const i=void 0!==t&&Math.max(this._end-t,this._start)||this._start;for(let t=this._end-1;t>=i;--t){const i=this._indexAt(t),s=this._valueAt(t);if(e(i,s))return{index:i,value:s}}return null}each(e){for(let t=this._start;t<this._end;++t){if(e(this._indexAt(t),this._valueAt(t)))break}}reduce(e,t){let i=t;for(let t=this._start;t<this._end;++t){i=e(i,this._indexAt(t),this._valueAt(t))}return i}range(e,t){const i=new h(this._plotFunctions,this._emptyValuePredicate);return i._items=this._items,i._start=this._lowerbound(e,d),i._end=this._upperbound(t),i._shareRead=!0,i}plottableRange(e){const t=new h(this._plotFunctions,this._emptyValuePredicate);return t._items=this._items,t._start=this._upperbound(n.UNPLOTTABLE_TIME_POINT_INDEX),t._end=this._end,t._shareRead=!0,!0===e&&t._start>this._start&&(t._start-=1),t}rangeIterator(e,t){const i=this._lowerbound(e,d),s=this._upperbound(t);return this._rangeIteratorImpl(i,s)}fullRangeIterator(){return this._rangeIteratorImpl(this._start,this._end)}minMaxOnRangeCached(e,t,i){if(this.isEmpty())return null;let s=null;for(const r of i){s=p(s,this._minMaxOnRangeCachedImpl(e-r.offset,t-r.offset,r.name))}return s}minMaxOnRange(e,t,i){if(this.isEmpty())return null;let s=null;for(const r of i){s=p(s,this._minMaxOnRange(e-r.offset,t-r.offset,r.name))}return s}merge(e){return this._shareRead?(l.logDebug("merge: readonly collection modification attempt"),
null):0===e.length?null:this.isEmpty()||e[e.length-1].index<this._items[0].index?this._prepend(e):e[0].index>this._items[this._items.length-1].index?this._append(e):1===e.length&&e[0].index===this._items[this._items.length-1].index?(this._updateLast(e[0]),e[0]):this._merge(e)}addTail(e,t=!1){if(0===e.length)return;let i=0;t&&this._end-this._start>0&&(i=1,this._items[this._end-this._start-1].value=e[0].value);for(let t=i;t<e.length;++t){const i=e[t],s=this.lastIndex();if(null===s){l.logError("Can't add tail to the empty plotlist");break}this.add(s+1,i.value)}this._invalidateSearchCaches()}move(e){if(this._shareRead)return void l.logDebug("move: readonly collection modification attempt");if(0===e.length)return;const t=this._items.slice();for(const i of e){const e=this._bsearch(i.old,d);if(null!==e&&void 0!==t[e])if(i.new===n.INVALID_TIME_POINT_INDEX)t[e]=void 0;else{t[e]={index:i.new,value:t[e].value};const s=this._bsearch(i.new,d);if(null!==s){const e=t[s];void 0!==e&&e.index===i.new&&(t[s]=void 0)}}}this._items=t.filter((e=>void 0!==e)).sort(((e,t)=>e.index-t.index)),this._invalidateSearchCaches(),this._minMaxCache.clear(),this._start=0,this._end=this._items.length}remove(e){if(this._shareRead)return l.logDebug("remove: readonly collection modification attempt"),null;const t=this._nonCachedSearch(e,a.PlotRowSearchMode.NearestRight,d);if(null===t)return null;const i=this._items.splice(t);return this._end=this._items.length,this._minMaxCache.clear(),this._invalidateSearchCaches(),i.length>0?i[0]:null}state(){const e=this._items.slice(this._start,this._end);return{start:0,end:e.length,data:e}}restoreState(e){e?(this._start=e.start,this._end=e.end,this._shareRead=!1,this._items=e.data,this._minMaxCache.clear(),this._invalidateSearchCaches()):this.clear()}_indexAt(e){return this._items[e].index}_valueAt(e){return this._items[e].value}_length(){return this._items.length}_searchImpl(e,t,i,s,r,n){const o=void 0!==n?i:s,a=void 0!==n?1e4*(t+1)+n:t;let l=o.get(e);if(void 0!==l){const e=l.get(a);if(void 0!==e)return e}const u=this._nonCachedSearch(e,t,r,n);if(null===u)return null;const d={index:this._indexAt(u),value:this._valueAt(u)};return void 0===l&&(l=new Map,o.set(e,l)),l.set(a,d),d}_nonCachedSearch(e,t,i,s){const r=this._lowerbound(e,i),n=r===this._end||e!==i(this._items[r]);if(n&&t!==a.PlotRowSearchMode.Exact)switch(t){case a.PlotRowSearchMode.NearestLeft:return this._searchNearestLeft(r,s);case a.PlotRowSearchMode.NearestRight:return this._searchNearestRight(r,s);default:throw new TypeError("Unknown search mode")}if(void 0===s||n||t===a.PlotRowSearchMode.Exact)return n?null:r;switch(t){case a.PlotRowSearchMode.NearestLeft:return this._nonEmptyNearestLeft(r,s);case a.PlotRowSearchMode.NearestRight:return this._nonEmptyNearestRight(r,s);default:throw new TypeError("Unknown search mode")}}_nonEmptyNearestRight(e,t){const i=(0,s.ensure)(this._emptyValuePredicate),r=(0,s.ensure)(t);for(;e<this._end&&i(this._valueAt(e),r);)e+=1;return e===this._end?null:e}_nonEmptyNearestLeft(e,t){const i=(0,
s.ensureNotNull)(this._emptyValuePredicate),r=(0,s.ensure)(t);for(;e>=this._start&&i(this._valueAt(e),r);)e-=1;return e<this._start?null:e}_searchNearestLeft(e,t){if(e===this._start)return null;const i=e-1,s=i!==this._end?i:null;return void 0!==t&&null!==s?this._nonEmptyNearestLeft(s,t):s}_searchNearestRight(e,t){const i=e,s=i!==this._end?i:null;return void 0!==t&&null!==s?this._nonEmptyNearestRight(s,t):s}_bsearch(e,t){const i=this._lowerbound(e,t);return i!==this._end&&e===t(this._items[i])?i:null}_lowerbound(e,t){return(0,r.lowerbound)(this._items,e,((e,i)=>t(e)<i),this._start,this._end)}_upperbound(e){return(0,r.upperbound)(this._items,e,((e,t)=>t.index>e),this._start,this._end)}_plotMinMax(e,t,i){let s=null;const r=this._plotFunctions.get(i);if(void 0===r)throw new Error(`Plot "${i}" is not registered`);for(let i=e;i<t;i++){const e=r(this._items[i].value);null==e||Number.isNaN(e)||(null===s?s={min:e,max:e}:(e<s.min&&(s.min=e),e>s.max&&(s.max=e)))}return s}_invalidateCacheForRow(e){const t=Math.floor(e.index/u);this._minMaxCache.forEach((e=>e.delete(t)))}_prepend(e){return(0,s.assert)(!this._shareRead,"collection should not be readonly"),(0,s.assert)(0!==e.length,"plotRows should not be empty"),this._invalidateSearchCaches(),this._minMaxCache.clear(),this._items=e.concat(this._items),this._start=0,this._end=this._items.length,e[0]}_append(e){return(0,s.assert)(!this._shareRead,"collection should not be readonly"),(0,s.assert)(0!==e.length,"plotRows should not be empty"),this._invalidateSearchCaches(),this._minMaxCache.clear(),this._items=this._items.concat(e),this._start=0,this._end=this._items.length,e[0]}_updateLast(e){(0,s.assert)(!this.isEmpty(),"plot list should not be empty");const t=this._items[this._end-1];(0,s.assert)(t.index===e.index,"last row index should match new row index"),this._invalidateCacheForRow(e),this._invalidateSearchCaches(),this._items[this._end-1]=e}_merge(e){return(0,s.assert)(0!==e.length,"plot rows should not be empty"),this._invalidateSearchCaches(),this._minMaxCache.clear(),this._items=_(this._items,e),this._start=0,this._end=this._items.length,e[0]}_minMaxOnRangeCachedImpl(e,t,i){if(this.isEmpty())return null;let r=null;const n=(0,s.ensureNotNull)(this.firstIndex()),o=(0,s.ensureNotNull)(this.lastIndex()),a=Math.max(e,n),l=Math.min(t,o),d=Math.ceil(a/u)*u,c=Math.max(d,Math.floor(l/u)*u);r=p(r,this._minMaxOnRange(a,Math.min(d,t,l),i));let h=this._minMaxCache.get(i);void 0===h&&(h=new Map,this._minMaxCache.set(i,h));for(let e=Math.max(d+1,a);e<c;e+=u){const t=Math.floor(e/u);let s=h.get(t);if(void 0===s){const e=t*u,r=(t+1)*u-1;s=this._minMaxOnRange(e,r,i),h.set(t,s)}r=p(r,s)}r=p(r,this._minMaxOnRange(c,l,i));return r}_minMaxOnRange(e,t,i){return this._plotMinMax(this._lowerbound(e,d),this._upperbound(t),i)}_rangeIteratorImpl(e,t){let i=e-1;return{[Symbol.iterator](){return this},next:()=>(i+=1,i>=t?{done:!0,value:void 0}:{done:!1,value:this._items[i]})}}_invalidateSearchCaches(){this._rowSearchCacheByIndex.clear(),this._rowSearchCacheByIndexWithoutEmptyValues.clear(),
this._rowSearchCacheByTime.clear(),this._rowSearchCacheByTimeWithoutEmptyValues.clear()}}function p(e,t){if(null===e)return t;if(null===t)return e;return{min:Math.min(e.min,t.min),max:Math.max(e.max,t.max)}}function _(e,t){const i=function(e,t){const i=e.length,s=t.length;let r=i+s,n=0,o=0;for(;n<i&&o<s;)e[n].index<t[o].index?n++:e[n].index>t[o].index?o++:(n++,o++,r--);return r}(e,t),s=new Array(i);let r=0,n=0;const o=e.length,a=t.length;let l=0;for(;r<o&&n<a;)e[r].index<t[n].index?(s[l]=e[r],r++):e[r].index>t[n].index?(s[l]=t[n],n++):(s[l]=t[n],r++,n++),l++;for(;r<o;)s[l]=e[r],r++,l++;for(;n<a;)s[l]=t[n],n++,l++;return s}},974655:(e,t,i)=>{"use strict";i.d(t,{PriceDataSource:()=>a,isPriceDataSource:()=>o});var s=i(996986),r=i(707957),n=i(981107);function o(e){return e instanceof a}class a extends s.DataSource{constructor(e,t){super(t),this._formatterChanged=new r.Delegate,this._priceStepChanged=new r.Delegate,this._currencyChanged=new r.Delegate,this._unitChanged=new r.Delegate,this._priceRangeReadyChanged=new r.Delegate,this._priceStep=null,this._priceRangeReady=!0,this._model=e}base(){return 0}model(){return this._model}currencyChanged(){return this._currencyChanged}isCurrencySource(){return!0}isDisplayedInLegend(){return!0}unitChanged(){return this._unitChanged}isUnitSource(){return!0}priceRange(e,t){return null}isDraggable(){return!0}priceLineColor(e){return e}formatterChanged(){return this._formatterChanged}priceStep(e){return this._priceStep}priceStepChanged(){return this._priceStepChanged}isIncludedInAutoScale(){return!0}correctScaleMargins(e){return e}priceRangeReady(){return this._priceRangeReady}priceRangeReadyChanged(){return this._priceRangeReadyChanged}disablePriceRangeReady(){const e=this.priceScale();null===e||e.isAutoScale()||e.mainSource()!==this||(this._priceRangeReady=!1,e.recalculatePriceRangeOnce()),this._priceRangeReadyChanged.fire(!1)}statusView(){return null}legendView(){return null}marketStatusModel(){return null}dataUpdatedModeModel(){return null}dataProblemModel(){return null}_enablePriceRangeReady(){this._priceRangeReady=!0,this._priceRangeReadyChanged.fire(!0)}_onSourceCurrencyChanged(){(0,n.isActingAsSymbolSource)(this)||this._currencyChanged.fire()}_onSourceUnitChanged(){(0,n.isActingAsSymbolSource)(this)||this._unitChanged.fire()}_onSourcePriceRangeReadyChanged(e){(0,n.isActingAsSymbolSource)(this)||e||this.disablePriceRangeReady()}}},369689:(e,t,i)=>{"use strict";i.d(t,{combineProperty:()=>r});var s=i(152633);function r(e,...t){const i=()=>e(...t.map((e=>e.value()))),r=(0,s.createPrimitiveProperty)(i()),n=()=>r.setValue(i()),o={};for(const e of t)e.subscribe(o,n);return r.destroy=()=>{t.forEach((e=>e.unsubscribeAll(o))),t.forEach((e=>e.release()))},r}},544421:(e,t,i)=>{"use strict";i.d(t,{SeriesData:()=>p,barFunction:()=>d,seriesPlotFunctionMap:()=>u});var s,r=i(650151),n=i(195447),o=i(674981);!function(e){e[e.FromLeft=-1]="FromLeft",e[e.FromRight=1]="FromRight"}(s||(s={}));const a={open:e=>e[1],high:e=>e[2],low:e=>e[3],close:e=>e[4],hl2:e=>(e[2]+e[3])/2,hlc3:e=>(e[2]+e[3]+e[4])/3,
ohlc4:e=>(e[1]+e[2]+e[3]+e[4])/4},l=["open","high","low","close","hl2","hlc3","ohlc4"];function u(){const e=new Map;return l.forEach(((t,i)=>{e.set(t,d(t))})),e}function d(e,t,i){const s=a[null!=t?t:e],r=a[e],n=a[null!=i?i:e];return(e,t)=>{switch(t){case 0:return s(e);case 2:return n(e);default:return r(e)}}}function c(e,t){return null==e[t]}const h=[{barsToMerge:10,forBarspacingLargerThen:.03},{barsToMerge:30,forBarspacingLargerThen:.01},{barsToMerge:100,forBarspacingLargerThen:.003},{barsToMerge:500,forBarspacingLargerThen:0}];class p{constructor(){this._pressedChunks={chunks:new Map,priceSource:"uninitialized"},this.m_bars=new n.PlotList(u(),c),this.m_nsBars=new n.PlotList(u(),c),this._clearPressedChunks()}bars(){return this.m_bars}nsBars(){return this.m_nsBars}pressedChunks(e,t){if(t!==this._pressedChunks.priceSource){this._pressedChunks.priceSource=t;const e=this.m_bars.first();e&&(this._clearPressedChunks(),this._rebuildPressedChunks(e))}const i=(0,r.ensureDefined)(h.find((t=>t.forBarspacingLargerThen<=e)));return(0,r.ensureDefined)(this._pressedChunks.chunks.get(i.barsToMerge))}mergeRegularBars(e){const t=this.m_bars.size(),i=this.m_bars.merge(e);return i&&"uninitialized"!==this._pressedChunks.priceSource&&(t===this.m_bars.size()&&i.index===this.m_bars.lastIndex()?this._updateLatestChunks():this._rebuildPressedChunks(i)),i}size(){return this.m_bars.size()+this.m_nsBars.size()}each(e){this.m_bars.each(e),this.m_nsBars.each(e)}clear(){this.m_bars.clear(),this.m_nsBars.clear(),this.lastProjectionPrice=void 0,this._clearPressedChunks()}isEmpty(){return this.m_bars.isEmpty()&&this.m_nsBars.isEmpty()}first(){return this.m_bars.isEmpty()?this.m_nsBars.first():this.m_bars.first()}last(){return this.m_nsBars.isEmpty()?this.m_bars.last():this.m_nsBars.last()}search(e,t){return this.nsBars().isEmpty()?this.bars().search(e,t):this.bars().isEmpty()||(0,r.ensureNotNull)(this.nsBars().firstIndex())<=e?this.nsBars().search(e,t):this.bars().search(e,t)}valueAt(e){const t=this.search(e);return null!==t?t.value:null}plotValueToTimePointIndex(e,t,i){if(i===s.FromRight){const i=(i,s)=>{const r=s[t];return null!=r&&e>=r},s=this.m_bars.findLast(i);if(null!==s)return s.index;const r=this.m_nsBars.findLast(i);return null!==r?r.index:this.m_bars.firstIndex()}if(i===s.FromLeft){const i=(i,s)=>{const r=s[t];return null!=r&&e<=r},s=this.m_bars.findFirst(i);if(null!==s)return s.index;const r=this.m_nsBars.findFirst(i);return null!==r?r.index:this.m_bars.lastIndex()}throw new Error("plotValueToTimePointIndex: unsupported search mode")}moveData(e){this.m_bars.move(e),this.m_nsBars.move(e),this.m_bars.size()>0&&this._rebuildPressedChunks((0,r.ensureNotNull)(this.m_bars.first()))}_rebuildPressedChunks(e){const t=this._pressedChunks.priceSource;if("uninitialized"===t)return;const i=e.index,s=a[t],n=(e,t,i)=>{let r=null;for(const n of e){const e=s(n.value);r&&n.index-r.startTime>=i.barsToMerge&&(t.push(r),r=null),r?(r.endTime=n.index,r.high=Math.max(r.high,e),r.low=Math.min(r.low,e),r.close=e):r={startTime:n.index,endTime:n.index,open:e,high:e,
low:e,close:e}}r&&t.push(r)};h.forEach((e=>{const t=(0,r.ensureDefined)(this._pressedChunks.chunks.get(e.barsToMerge)),s=(0,o.lowerbound)(t,i,((e,t)=>e.endTime<t));if(0===s&&t.length>0){const i=t[0].startTime-1,s=(0,r.ensureNotNull)(this.m_bars.firstIndex()),o=this.m_bars.rangeIterator(s,i),a=[];n(o,a,e);const l=a.concat(t);this._pressedChunks.chunks.set(e.barsToMerge,l)}else{const i=(0,r.ensureNotNull)(this.m_bars.lastIndex());t.splice(s);let o=(0,r.ensureNotNull)(this.m_bars.firstIndex());t.length&&(o=t[t.length-1].endTime+1);const a=this.m_bars.rangeIterator(o,i);n(a,t,e)}}))}_updateLatestChunks(){const e=(0,r.ensureNotNull)(this.m_bars.last());h.forEach((t=>{const i=(0,r.ensureDefined)(this._pressedChunks.chunks.get(t.barsToMerge)),s=e.value[4],n=i[i.length-1];n.high=Math.max(n.high,s),n.low=Math.min(n.low,s),n.close=s,n.endTime=e.index}))}_clearPressedChunks(){h.forEach((e=>this._pressedChunks.chunks.set(e.barsToMerge,[])))}}},442410:(e,t,i)=>{"use strict";i.d(t,{SeriesDataEvents:()=>r});var s=i(707957);class r{constructor(){this._created=new s.Delegate,this._modified=new s.Delegate,this._loading=new s.Delegate,this._completed=new s.Delegate,this._error=new s.Delegate,this._symbolError=new s.Delegate,this._symbolResolved=new s.Delegate,this._seriesError=new s.Delegate,this._symbolNotPermitted=new s.Delegate,this._symbolInvalid=new s.Delegate,this._symbolGroupNotPermitted=new s.Delegate,this._chartTypeNotPermitted=new s.Delegate,this._intradaySpreadNotPermitted=new s.Delegate,this._intradayExchangeNotPermitted=new s.Delegate,this._customIntervalNotPermitted=new s.Delegate,this._secondsIntervalNotPermitted=new s.Delegate,this._tickMarksRangeChanged=new s.Delegate,this._barReceived=new s.Delegate,this._seriesTimeFrame=new s.Delegate,this._dataUpdated=new s.Delegate}destroy(){this._created.destroy(),this._modified.destroy(),this._loading.destroy(),this._completed.destroy(),this._error.destroy(),this._symbolError.destroy(),this._symbolResolved.destroy(),this._seriesError.destroy(),this._symbolInvalid.destroy(),this._symbolNotPermitted.destroy(),this._symbolGroupNotPermitted.destroy(),this._chartTypeNotPermitted.destroy(),this._intradaySpreadNotPermitted.destroy(),this._intradayExchangeNotPermitted.destroy(),this._customIntervalNotPermitted.destroy(),this._secondsIntervalNotPermitted.destroy(),this._tickMarksRangeChanged.destroy(),this._barReceived.destroy(),this._seriesTimeFrame.destroy(),this._dataUpdated.destroy()}created(){return this._created}modified(){return this._modified}loading(){return this._loading}completed(){return this._completed}error(){return this._error}symbolError(){return this._symbolError}symbolResolved(){return this._symbolResolved}seriesError(){return this._seriesError}symbolInvalid(){return this._symbolInvalid}symbolNotPermitted(){return this._symbolNotPermitted}symbolGroupNotPermitted(){return this._symbolGroupNotPermitted}chartTypeNotPermitted(){return this._chartTypeNotPermitted}intradaySpreadNotPermitted(){return this._intradaySpreadNotPermitted}intradayExchangeNotPermitted(){
return this._intradayExchangeNotPermitted}customIntervalNotPermitted(){return this._customIntervalNotPermitted}secondsIntervalNotPermitted(){return this._secondsIntervalNotPermitted}tickMarksRangeChanged(){return this._tickMarksRangeChanged}barReceived(){return this._barReceived}seriesTimeFrame(){return this._seriesTimeFrame}dataUpdated(){return this._dataUpdated}fireCompleted(e){this._completed.fire(e)}fireCreated(e){this._created.fire(e)}fireModified(){this._modified.fire()}fireLoading(e){this._loading.fire(e)}fireError(){this._error.fire()}fireSymbolError(e){this._symbolError.fire(e),this.fireError()}fireSymbolResolved(e){this._symbolResolved.fire(e)}fireSeriesError(e){this._seriesError.fire(e),this.fireError()}fireSymbolInvalid(){this._symbolInvalid.fire()}fireSymbolNotPermitted(e){this._symbolNotPermitted.fire(e)}fireSymbolGroupNotPermitted(e){this._symbolGroupNotPermitted.fire(e)}fireChartTypeNotPermitted(e){this._chartTypeNotPermitted.fire(e),this.fireError()}fireIntradaySpreadNotPermitted(){this._intradaySpreadNotPermitted.fire(),this.fireError()}fireIntradayExchangeNotPermitted(){this._intradayExchangeNotPermitted.fire(),this.fireError()}fireCustomIntervalNotPermitted(e){this._customIntervalNotPermitted.fire(e),this.fireError()}fireSecondsIntervalNotPermitted(){this._secondsIntervalNotPermitted.fire(),this.fireError()}fireTickMarksRangeChanged(e){this._tickMarksRangeChanged.fire(e)}fireBarReceived(e){this._barReceived.fire(e)}fireSeriesTimeFrame(e,t,i,s,r){this._seriesTimeFrame.fire(e,t,i,s,r)}fireDataUpdated(e,t,i){this._dataUpdated.fire(e,t,i)}}},114315:(e,t,i)=>{"use strict";i.d(t,{ExtendedStudyDataSource:()=>n});var s=i(405721),r=i(311862);class n extends s.StudyDataSource{constructor(e,t,i,s){super(e,t.seriesSource(),i,s),this._series=t}_createStudyError(e){var t;return(0,r.createStudyError)(this._getStudyErrorDescription(e),null===(t=this._series.symbolInfo())||void 0===t?void 0:t.exchange)}}},92245:(e,t,i)=>{"use strict";i.d(t,{DwgExtend:()=>s,convertPointsToScreenDimension:()=>a,doesItemAffectVisibleRange:()=>l,isExtendInSameDirection:()=>o});var s,r=i(650151);function n(e,t){return e===s.None?t:t===s.None?e:e===s.Both||t===s.Both?s.Both:e===t?t:s.Both}function o(e,t){return e===s.Both||e===t}function a(e,t,i,o,a,l,u,d,c,h){let p,_;if(null===e&&null===i){if(a!==s.Right&&a!==s.Both)return null;a=s.Both,p=0,_=d}else null===e?(p=u.indexToCoordinate((0,r.ensureNotNull)(i)-1),a=n(a,s.Left)):p=u.indexToCoordinate(e),null===i?(_=u.indexToCoordinate((0,r.ensureNotNull)(e)-1),a=n(a,s.Right)):_=u.indexToCoordinate(i);const m=p,f=l.priceToCoordinate(t,c),v=_,y=l.priceToCoordinate(o,c);return void 0!==h?(h.x1=m,h.y1=f,h.x2=v,h.y2=y,h.extend=a,h):{x1:m,y1:f,x2:v,y2:y,extend:a}}function l(e,t,i,r,n){let o=!1;switch(i){case s.Both:o=!0;break;case s.Right:o=null===t||null===e||e<=n;break;case s.Left:o=null===t||t>=r;break;default:null!==e&&null!==t?o=(e>=r||t>=r)&&(e<=n||t<=n):null!==e&&null===t?o=e<=n:null===e&&null!==t&&(o=t>=r)}return o}!function(e){e.None="n",e.Left="l",e.Right="r",e.Both="b"}(s||(s={}))},
582533:(e,t,i)=>{"use strict";i.d(t,{LiveStudyGraphics:()=>o.LiveStudyGraphics,createGraphicsPaneViews:()=>c,createGraphicsPriceAxisViews:()=>p,emptyStudyGraphics:()=>n.emptyStudyGraphics,isStudyGraphicsEmpty:()=>r.isStudyGraphicsEmpty,loadStudyGraphics:()=>n.loadStudyGraphics,saveStudyGraphics:()=>n.saveStudyGraphics});var s=i(201089),r=i(590713),n=i(2605),o=i(855428),a=i(280664);const l=(0,s.getLogger)("Chart.StudyGraphics"),u=new Set(["dwgtablecells","tpoBlockSets","tpoLevels","tpoVolumeRows","logs"]);async function d(e,t,s,r){switch(e){case"hlines":return new((await Promise.all([i.e(98081),i.e(20507)]).then(i.bind(i,454112))).LevelPaneView)(t,s,r);case"lines":return new((await Promise.all([i.e(98081),i.e(20507)]).then(i.bind(i,556613))).LinePaneView)(t,s,r);case"shapemarks":return new((await Promise.all([i.e(98081),i.e(20507)]).then(i.bind(i,709329))).ShapeMarkPaneView)(t,s,r);case"textmarks":return new((await Promise.all([i.e(98081),i.e(20507)]).then(i.bind(i,99490))).TextMarkPaneView)(t,s,r);case"trendchannels":return new((await Promise.all([i.e(98081),i.e(20507)]).then(i.bind(i,149284))).TrendChannelPaneView)(t,s,r);case"dwglabels":return new((await Promise.all([i.e(98081),i.e(20507)]).then(i.bind(i,531536))).DwgLabelPaneView)(t,s,r);case"dwglines":return new((await Promise.all([i.e(98081),i.e(20507)]).then(i.bind(i,591393))).DwgLinePaneView)(t,s,r);case"dwgboxes":return new((await Promise.all([i.e(98081),i.e(20507)]).then(i.bind(i,277150))).DwgBoxPaneView)(t,s,r);case"dwgtables":return new((await Promise.all([i.e(98081),i.e(20507)]).then(i.bind(i,760269))).DwgTablePaneView)(t,s,r);case"dwglinefills":return new((await Promise.all([i.e(98081),i.e(20507)]).then(i.bind(i,262831))).DwgLineFillPaneView)(t,s,r);case"tpos":return new((await i.e(769).then(i.bind(i,479868))).TpoPaneView)(t,s,r)}switch(e){case"hhists":return new((await Promise.all([i.e(98081),i.e(20507)]).then(i.bind(i,670751))).HHistPaneView)(t,s,r);case"horizlines":return new((await Promise.all([i.e(98081),i.e(20507)]).then(i.bind(i,722669))).HorizLinePaneView)(t,s,r);case"vertlines":return new((await Promise.all([i.e(98081),i.e(20507)]).then(i.bind(i,652742))).VertLinePaneView)(t,s,r);case"polygons":return new((await Promise.all([i.e(98081),i.e(20507)]).then(i.bind(i,842474))).PolygonPaneView)(t,s,r);case"backgrounds":return new((await Promise.all([i.e(98081),i.e(20507)]).then(i.bind(i,209406))).BackgroundPaneView)(t,s,r)}return null}async function c(e,t,i){const s=[],r=Object.keys(e.graphicsInfo());r.sort(((e,t)=>h(e)-h(t)));for(const n of r){const r=await d(n,e,t,i);null!==r?s.push(r):u.has(n)||l.logWarn(`${n} is not supported by this build of graphics subsystem, skipping`)}return s}function h(e){var t;return null!==(t=r.primitivesZOrders.get(e))&&void 0!==t?t:0}function p(e){const t=Object.keys(e.graphicsInfo()),i=[];for(const s of t)switch(s){case"hlines":e.graphics().hlines().forEach(((t,r)=>{t.forEach((t=>{void 0!==t.level&&i.push(new a.LevelPriceAxisView(e,{line:{level:t.level},styleId:r,lineType:s}))}))}));break;case"horizlines":
e.graphics().horizlines().forEach(((t,r)=>{t.forEach((t=>{void 0!==t.level&&i.push(new a.LevelPriceAxisView(e,{line:{level:t.level},styleId:r,lineType:s}))}))}))}return i}},590713:(e,t,i)=>{"use strict";i.d(t,{isStudyGraphicsEmpty:()=>n,primitiveNames:()=>s,primitivesZOrders:()=>r,splitHHistsByTimePointIndex:()=>o});const s=["horizlines","vertlines","lines","hlines","textmarks","shapemarks","backgrounds","polygons","trendchannels","hhists","dwglabels","dwglines","dwgboxes","dwgtables","dwgtablecells","dwglinefills","tpos","tpoBlockSets","tpoLevels","tpoVolumeRows","logs"],r=new Map([["logs",-4],["polygons",-4],["trendchannels",-3],["textmarks",-2],["shapemarks",-2],["backgrounds",-1],["hlines",1],["horizlines",1],["hhists",1],["dwglinefills",2],["vertlines",3],["lines",3],["dwglines",3],["dwgboxes",4],["dwglabels",5],["dwgtables",6],["dwgtablecells",6],["tpos",7],["tpoBlockSets",7],["tpoLevels",7],["tpoVolumeRows",7]]);function n(e){return!s.some((t=>{const i=e[t]();for(const[,e]of i)if(e.size>0)return!0;return!1}))}function o(e){const t=new Map;return e.forEach(((e,i)=>{e.forEach((e=>{const s={...e,styleId:i},r=e.firstBarTime;let n=t.get(r);void 0===n&&(n=new Set,t.set(r,n)),n.add(s)}))})),t}},133822:(e,t,i)=>{"use strict";i.d(t,{validateGraphicsCommands:()=>n});var s=i(130551),r=i(650151);function n(e){if(!(0,s.isObject)(e))throw new Error("Graphics commands should be wrapped in an object");if((0,s.hasProperty)(e,"create"),(0,s.hasProperty)(e,"erase")){const t=e.erase;(0,r.assert)(Array.isArray(t),"Collection of erase commands should be array");for(const e of t){if(!(0,s.isObject)(e)||!(0,s.hasProperty)(e,"action"))throw new Error("Command should be an object with 'action' property");(0,r.assert)("all"===e.action||"one"===e.action,"Erase command action should be 'all' or 'one'")}}return e}},799567:(e,t,i)=>{"use strict";var s;i.d(t,{StudyStatusType:()=>s}),function(e){e[e.Undefined=0]="Undefined",e[e.Loading=1]="Loading",e[e.Completed=2]="Completed",e[e.Error=3]="Error"}(s||(s={}))},29399:(e,t,i)=>{"use strict";i.d(t,{StudyPlotPaneView:()=>N});var s=i(650151),r=i(86441),n=i(724377),o=i(244842),a=i(678515),l=i(389137),u=i(246733),d=i(103221),c=i(755785),h=i(315801),p=i(413225),_=i(142119),m=i(879617),f=i(627172),v=i(63316),y=i(230058),g=i(574809),S=i(470130),b=i(800275),P=i(793907),I=i(308812),w=i(700562),T=i(368135),C=i(441212),A=i(674981),E=i(534741),x=i(272933);const L=e=>{const t=(0,n.rgbToHsl)((0,n.parseRgb)(e)),i=t[0]+.05;return t[0]=i-Math.floor(i),(0,n.rgbToHexString)((0,n.hslToRgb)(t))},V=(0,c.memoize)(L),M=new Set([T.LineStudyPlotStyle.Line,T.LineStudyPlotStyle.Area,T.LineStudyPlotStyle.Circles,T.LineStudyPlotStyle.Cross,T.LineStudyPlotStyle.StepLine,T.LineStudyPlotStyle.StepLineWithDiamonds]);class N{constructor(e,t,i,s,r=!1){this._histogramBase=null,this._items=[],this._lastConfirmedSeriesBarCoordinate=NaN,this._selectionData=null,this._lineColor="",this._lineWidth=1,this._color1="",this._color2="",this._dataInvalidated=null,this._viewportInvalidated=!1,this._renderer=new _.CompositeRenderer,
this._isMarkersEnabled=o.enabled("source_selection_markers"),this._study=e,this._series=t,this._model=i,this._plotName=s,this._plotIndex=e.metaInfo().plots.findIndex((e=>e.id===s)),this._colorProvider=(0,C.createStudyPlotColorProvider)(e.metaInfo(),e.properties(),s),this._selectionIndexer=new v.SelectionIndexes(i.timeScale()),this._extendStepLineToBarsEndings=r,this._useFirstUnplottableRow=(0,S.isFundamentalStudyMetaInfo)(e.metaInfo())}items(){return this._items}update(e){if("global-change"===e.type)return this._dataInvalidated=(0,x.mergeDataInvalidation)(this._dataInvalidated,{}),void(this._viewportInvalidated=!0);if("data-source-change"!==e.type)this._viewportInvalidated=!0;else{if(e.sourceId===this._study.id()){const t=(0,x.mergeDataInvalidation)(this._dataInvalidated,{firstIndex:e.firstUpdatedTimePointIndex,clearData:e.clearData});this._dataInvalidated=t}}}renderer(){return this._dataInvalidated?this._updateImplFull(this._viewportInvalidated)&&(this._dataInvalidated=null):this._viewportInvalidated&&this._updateImplLight(),this._viewportInvalidated=!1,this._renderer}_getTranspValue(){const e=this._study.properties(),t=e.styles[this._plotName];let i=0;const s=this._study.metaInfo();return"Volume@tv-basicstudies"===s.id&&s.version<=46&&"transparency"in e?(i=e.transparency.value(),i=(0,l.isNumber)(i)?i:0,i):(t.transparency&&(i=t.transparency.value(),i=(0,l.isNumber)(i)?i:0),i)}_updateImplFull(e){var t,i,n,o,l;if(this._renderer.clear(),(null===(t=this._dataInvalidated)||void 0===t?void 0:t.clearData)&&(this._items=[]),!this._study.isPlotVisibleAt(this._plotName,1))return!1;if(!this._study.priceScale())return!1;const d=this._study.firstValue();if(null===d)return!1;const c=this._study.priceScale();if(null===c)return!1;this._histogramBase=null;const h=this._study.properties().styles[this._plotName],p=null===(i=this._study.metaInfo().styles)||void 0===i?void 0:i[this._plotName],_=h.plottype.value(),m=this._useFirstUnplottableRow&&(_===T.LineStudyPlotStyle.StepLine||_===T.LineStudyPlotStyle.StepLineWithDiamonds),f=this._study.plots().plottableRange(m),v=f.size();if(0===v)return!1;const y=this._study.offset(this._plotName);let S=null===(n=this._dataInvalidated)||void 0===n?void 0:n.firstIndex;const b=M.has(_);if(v!==this._items.length){const e=void 0!==S?S+y:void 0;if(void 0===e||0===this._items.length||e<(0,s.ensureDefined)(this._items[0].timePointIndex))this._items=[],f.each(((e,t)=>{const i=t[this._plotIndex+1];if(b&&null==i)return!1;const s=new r.Point(NaN,NaN);return s.origPrices=new r.Point(NaN,NaN),s.timePointIndex=e+y,this._items.push(s),!1})),S=this._items.length?(0,s.ensureDefined)(this._items[0].timePointIndex)-y:void 0;else{const e=this._items[this._items.length-1].timePointIndex,t=(0,s.ensureDefined)(e)-y,i=(0,s.ensureNotNull)(f.lastIndex())+1,n=f.rangeIterator(t+1,i);for(const e of n){const t=e.value[this._plotIndex+1],i=null==t;if(b&&i)continue;const s=new r.Point(NaN,NaN);s.origPrices=new r.Point(NaN,NaN),s.timePointIndex=e.index+y,this._items.push(s)}}}let P=NaN,I=NaN;const w=new Map,C=(e,t)=>{
let i=w.get(e);void 0===i&&(i=new Map,w.set(e,i));let s=i.get(t);if(void 0===s){const r=!this._plotName||"vol"!==this._plotName;s=(0,u.generateColor)(e,t,r),i.set(t,s)}return s},E=(0,g.createEmptyStyle)(),x=(0,a.clamp)(this._getTranspValue(),0,100),L=this._model.timeScale().visibleBarsStrictRange();if(null===L)return!1;const{startBar:V,endBar:N}=this._calculateStartEnd(L);if(null===V||null===N||0===this._items.length)return!1;const O=null!=S?S:(0,s.ensureNotNull)(f.firstIndex()),D=f.rangeIterator(O,(0,s.ensureNotNull)(f.lastIndex())+1),k=(0,A.lowerbound)(this._items,O+y,((e,t)=>e.timePointIndex<t));let B=k;for(const e of D){let t=e.index;const i=e.value;t+=y,t=Math.floor(t);let n=i[this._plotIndex+1];const a=null==n;if(n=a?NaN:n,b&&a){I=n;continue}const d=new r.Point(t,(0,s.ensure)(n));d.timePointIndex=t,d.valIsNotSameAsPrev=n!==I||t-1!==P;if(this._colorProvider.isColorDefined()&&(d.style={color:C(h.color.value(),100),width:h.linewidth.value(),style:h.linestyle.value()},null!=n)){const e=this._colorProvider.getPlotPointStyle(i,E),t=e.colors[0];void 0!==t&&(d.style.color=(0,u.isHexColor)(t)?C(t,x):t),d.style.width=null!==(o=e.lineWidth)&&void 0!==o?o:d.style.width,d.style.style=null!==(l=e.lineStyle)&&void 0!==l?l:d.style.style}if(!b&&!isNaN(P)&&P!==t-1&&B>0){const e=this._items[B-1].timePointIndex,i=new r.Point(t-1,NaN);i.origPrices=new r.Point(t-1,NaN),i.timePointIndex=e,B<this._items.length?this._items[B]=i:this._items.push(i),B++}P=t,I=n;{const e=d;e.origPrices=new r.Point(d.x,d.y),B<this._items.length?this._items[B]=e:this._items.push(e),B++}}if(this._items.length){const t=this._model.mainSeries().data().bars().lastIndex();null!==t&&(this._lastConfirmedSeriesBarCoordinate=this._model.timeScale().indexToCoordinate(t));const i=Math.max(0,(0,A.lowerbound)(this._items,V,((e,t)=>e.timePointIndex<t))),s=Math.min(this._items.length,(0,A.upperbound)(this._items,N,((e,t)=>e<t.timePointIndex))),r=e?i:Math.max(i,k),n=s;for(let e=r;e<n;e++){const t=this._items[e];t.x=t.origPrices.x,t.y=t.origPrices.y}c.pointsArrayToCoordinates(this._items,d,{startItemIndex:r,endItemIndex:n}),this._model.timeScale().timedValuesToCoordinates(this._items,{startItemIndex:r,endItemIndex:n},!0),void 0!==(null==p?void 0:p.histogramBase)&&(this._histogramBase=c.priceToCoordinate(p.histogramBase,d)),this._createSelection(d),this._createRenderer(i,s)}return!0}_updateImplLight(){var e;const t=this._study.firstValue();if(null===t)return this._selectionData=null,void this._createRenderer(0,-1);const i=this._study.priceScale();if(null===i)return this._selectionData=null,void this._createRenderer(0,-1);const s=this._model.timeScale().visibleBarsStrictRange();if(null===s)return this._selectionData=null,void this._createRenderer(0,-1);const{startBar:r,endBar:n}=this._calculateStartEnd(s);if(null===r||null===n||0===this._items.length)return this._selectionData=null,void this._createRenderer(0,-1);const o=Math.max(0,(0,A.lowerbound)(this._items,r,((e,t)=>e.timePointIndex<t))),a=Math.min(this._items.length,(0,
A.upperbound)(this._items,n,((e,t)=>e<t.timePointIndex)));for(let e=o;e<a;e++){const t=this._items[e];t.x=t.origPrices.x,t.y=t.origPrices.y}i.pointsArrayToCoordinates(this._items,t,{startItemIndex:o,endItemIndex:a}),this._model.timeScale().timedValuesToCoordinates(this._items,{startItemIndex:o,endItemIndex:a},!0);const l=null===(e=this._study.metaInfo().styles)||void 0===e?void 0:e[this._plotName];void 0!==(null==l?void 0:l.histogramBase)&&(this._histogramBase=i.priceToCoordinate(l.histogramBase,t)),this._createSelection(t);const u=this._model.mainSeries().data().bars().lastIndex();null!==u&&(this._lastConfirmedSeriesBarCoordinate=this._model.timeScale().indexToCoordinate(u)),this._createRenderer(o,a)}_calculateStartEnd(e){const t=this._study.offset(this._plotName);let i=e.firstBar()-Math.abs(t)-1,s=e.lastBar()+Math.abs(t)+1;const r=this._study.plots(),n=r.search(i,E.PlotRowSearchMode.NearestLeft,this._plotIndex+1),o=r.search(s,E.PlotRowSearchMode.NearestRight,this._plotIndex+1);null!==n&&(i=n.index),null!==o&&(s=o.index);const a=this._study.getMinFirstBarIndexForPlot(this._plotName)+t;return a>s+1?{startBar:null,endBar:null}:(i=Math.max(a,i),{startBar:i,endBar:s})}_createRenderer(e,t){var i,r;this._renderer.clear();const n=this._study.properties().styles.childs()[this._plotName].childs(),o=null===(i=this._study.metaInfo().styles)||void 0===i?void 0:i[this._plotName],c=(0,a.clamp)(this._getTranspValue(),0,100);this._lineColor=(0,u.generateColor)(n.color.value(),c),this._lineWidth=n.linewidth.value();let h=n.color.value();const _=this._colorProvider.getDefaultPlotPointStyle();_&&(h=_.colors[0]||h,this._lineWidth=null!==(r=_.lineWidth)&&void 0!==r?r:this._lineWidth,this._lineColor=h?(0,u.generateColor)(h,c):this._lineColor),this._color2=(0,u.generateColor)(h,c);const v=this._study.metaInfo(),g=v.isRGB?L(h):V(h);this._color1=(0,u.generateColor)(g,c);const C={};C.barSpacing=this._model.timeScale().barSpacing(),C.items=this._items,C.histogramBase=this._histogramBase?this._histogramBase:(0,s.ensureNotNull)(this._study.priceScale()).height(),C.lineIndex=0,C.lineStyle=n.linestyle.value(),C.lineColor=this._lineColor,C.lineWidth=this._lineWidth,C.lineWidth=(0,l.isNumber)(C.lineWidth)?C.lineWidth:1,C.color1=this._color1,C.color2=this._color2,C.bottom=C.histogramBase,C.visibleItemsRange={startItemIndex:e,endItemIndex:t},C.lastConfirmedSeriesBarCoordinate=this._lastConfirmedSeriesBarCoordinate,C.simpleMode=this._colorProvider.singleColor();const A=this._renderer,E=Boolean(null==o?void 0:o.joinPoints);switch(n.plottype.value()){case T.LineStudyPlotStyle.Line:case T.LineStudyPlotStyle.LineWithBreaks:A.append(new m.PaneRendererLine(C));break;case T.LineStudyPlotStyle.Area:case T.LineStudyPlotStyle.AreaWithBreaks:A.append(new p.PaneRendererArea(C));break;case T.LineStudyPlotStyle.Histogram:A.append(new w.PaneRendererHistogram(C));break;case T.LineStudyPlotStyle.Columns:A.append(new P.PaneRendererColumns(C));break;case T.LineStudyPlotStyle.Cross:if(A.append(new I.PaneRendererCross(C)),E){const e=(0,d.deepCopy)(C);e.lineWidth=1,
e.forceLineWidth=!0,A.append(new m.PaneRendererLine(e))}break;case T.LineStudyPlotStyle.Circles:if(A.append(new b.PaneRendererCircles(C)),E){const e=(0,d.deepCopy)(C);e.lineWidth=1,e.ignorePaletteLineWidth=!0,A.append(new m.PaneRendererLine(e))}break;case T.LineStudyPlotStyle.StepLine:case T.LineStudyPlotStyle.StepLineWithBreaks:case T.LineStudyPlotStyle.StepLineWithDiamonds:{C.decoration=n.plottype.value()===T.LineStudyPlotStyle.StepLineWithDiamonds?f.StepLineDecoration.Diamonds:f.StepLineDecoration.None,C.extendToBarsEndings=this._extendStepLineToBarsEndings;const e=new f.PaneRendererStepLine(void 0,(0,S.isFundamentalStudyMetaInfo)(v));e.setData(C),A.append(e);break}default:A.append(new m.PaneRendererLine(C))}this._model.selection().isSelected(this._study)&&this._isMarkersEnabled&&this._selectionData&&A.append(new y.SelectionRenderer(this._selectionData))}_createSelection(e){const t=this._study.priceScale();if(null!==t)if(this._model.selection().isSelected(this._study)){const i=this._selectionIndexer.indexes();this._selectionData={points:[],bgColors:[],visible:!0,hittestResult:h.HitTarget.Regular,barSpacing:this._model.timeScale().barSpacing()};const n=(0,s.ensureNotNull)(this._model.paneForSource(this._study)).height(),o=this._study.offset(this._plotName);for(let s=0;s<i.length;s++){let a=i[s];const l=this._study.plots().valueAt(a);if(a+=o,null===l)continue;const u=l[this._plotIndex+1];if(null==u)continue;const d=this._model.timeScale().indexToCoordinate(Math.floor(a)),c=t.priceToCoordinate(u,e);this._selectionData.points.push(new r.Point(d,c)),this._selectionData.bgColors.push(this._model.backgroundColorAtYPercentFromTop(c/n))}}else this._selectionIndexer.clear()}}},414585:(e,t,i)=>{"use strict";i.d(t,{StudyStatusProviderBase:()=>l});var s=i(985715),r=i(504101),n=i(982217);const o={NONE:"Default"},a=!0;class l extends s.StatusProviderBase{constructor(e,t){super(t),this._source=e}getSplitTitle(){return this._source.titleInParts(n.TitleDisplayTarget.StatusLine,!0,o,void 0,a)}text(){return this._source.isActualInterval()?this._source.isFailed()?`${this._source.title(n.TitleDisplayTarget.StatusLine,!0,o,void 0,a)}: ${this.sourceStatusText()}`:`${this._source.title(n.TitleDisplayTarget.StatusLine,!0,o,void 0,a)} ${this.sourceStatusText()}`:this._source.title(n.TitleDisplayTarget.StatusLine,!0,o,void 0,a)}sourceStatusText(){return(0,r.convertStudyStatusToString)(this._source.status(),!0)}errorStatus(){if(!this._source.isActualInterval()||this._source.isSymbolInvalid())return null;const e=this._source.status();return e.type===r.StudyStatusType.Error?{error:this.sourceStatusText(),solutionId:(0,r.studyStatusSolutionId)(e),title:(0,r.studyStatusTitle)(e),studyFeature:(0,r.studyStatusFeature)(e)}:null}}},504101:(e,t,i)=>{"use strict";i.d(t,{StudyStatusType:()=>c,convertStudyStatusToString:()=>h,isVolumeDataError:()=>a,noVolumeErrorTooltip:()=>o,studyStatusFeature:()=>m,studyStatusSolutionId:()=>p,studyStatusTitle:()=>_});var s=i(444372)
;const r=new Map([["You cannot see this pivot timeframe on this resolution",s.t(null,void 0,i(717126))],["The data vendor doesn't provide volume data for this symbol.",s.t(null,void 0,i(529198))],['Histogram is too large, please increase "Row Size" input.',s.t(null,void 0,i(369085))],["Histogram is too large, please reduce 'Row Size' input.",s.t(null,void 0,i(808122))],["This script is invite-only. To request access, please contact its author.",s.t(null,void 0,i(874986))],["Volume Profile indicator available only on our upgraded plans.",s.t(null,void 0,i(961022))],["VOLUME_BIST_MIXED",s.t(null,void 0,i(482772))]]);var n=i(412304);const o=s.t(null,void 0,i(916971));function a(e){const t=e.toLowerCase();return t.includes("the data vendor doesn't provide volume data for this symbol.")||t.includes("no volume is provided by the data vendor")}const l=new Map([["Pine cannot determine the referencing length of a series. Try using max_bars_back",n.solutionIds.PINE_CANNOT_DETERMINE],["Memory limits exceeded",n.solutionIds.MEMORY_LIMITS_EXCEEDED],["This script is invite-only",n.solutionIds.PUBLIC_INVITE_ONLY_SCRIPTS]]),u=new Map([["Volume Profile indicator available only on our upgraded plans","volumeProfile"]]),d=s.t(null,void 0,i(930295));var c;function h(e,t){if(e.type===c.Loading)return t?d:"loading...";if(e.type===c.Error){const s=e.errorDescription,n=t?(i=s.error,r.get(i)||i):s.error;if(s.ctx){const e={};return Object.entries(s.ctx).forEach((([t,i])=>{e[t]=i.toString()})),n.format(e)}return n}var i;return""}function p(e){if(e.type===c.Error)return e.errorDescription.solution_id?e.errorDescription.solution_id:function(e){for(const t of Array.from(l.keys()))if(e.includes(t))return l.get(t)}(e.errorDescription.error)}function _(e){if(e.type===c.Error)return a(e.errorDescription.error)?o:e.errorDescription.title}function m(e){const{errorDescription:{error:t}}=e;for(const[e,i]of u)if(t.startsWith(e))return i}!function(e){e[e.Undefined=0]="Undefined",e[e.Loading=1]="Loading",e[e.Completed=2]="Completed",e[e.Error=3]="Error"}(c||(c={}))},935219:(e,t,i)=>{"use strict";i.d(t,{StudyStubStatusProvider:()=>n});var s=i(414585),r=i(982217);class n extends s.StudyStatusProviderBase{text(){return this._source.isActualInterval()?`${this._source.title(r.TitleDisplayTarget.StatusLine)} ${this.sourceStatusText()}`:this._source.title(r.TitleDisplayTarget.StatusLine)}}},311862:(e,t,i)=>{"use strict";i.d(t,{StudyBase:()=>Ze,createStudyError:()=>qe,prepareStudyProperties:()=>We,prepareStudyPropertiesForLoadChart:()=>je})
;var s=i(316230),r=i(822914),n=i(712433),o=i(650151),a=i(444372),l=i(201089),u=i(638456),d=i(461794),c=i(173948),h=i(168682),p=i(855611),_=i(764861),m=i(223284),f=i(662080),v=i(960337),y=i(371927),g=i(822122),S=i(255453),b=i(397150),P=i(707957),I=i(178389),w=i(974655),T=i(291784),C=i(195447),A=i(526075),E=i(582533),x=i(534741),L=i(379048),V=i(464633),M=i(885482),N=i(555502),O=i(919892),D=i(173220),k=i(826989),B=i(634005),R=i(509550),F=i(389137),U=i(182436),z=i(982217),H=i(368135),W=i(78456),G=i(412304),X=i(886708),Y=i(62745),j=i(244842),K=i(418804),$=i(502322),q=i(408107),Z=i(490207),J=i(55458),Q=i(330786),ee=i(742391),te=i(29399),ie=i(480311),se=i(1584),re=i(753877),ne=i(544820),oe=i(999615),ae=i(738449),le=i(644164),ue=i(504101),de=i(395098),ce=i(877009),he=i(964824),pe=i(401580),_e=(i(444331),i(261066)),me=i(932167),fe=i(506387),ve=i(158975),ye=i(251954),ge=i(42292),Se=i(458963),be=i(808068),Pe=i(853965),Ie=i(312449),we=i(691639),Te=i(103055),Ce=i(624444),Ae=i(943994),Ee=i(541346);const xe=(0,l.getLogger)("Chart.Study"),Le=a.t(null,void 0,i(814177));const Ve={symbolsForDisplay:!1,symbolsForChartApi:!0,skipHiddenInputs:!1,skipFakeInputs:!1,skipBooleanInputs:!1,asObject:!0,skippedGroups:[],skippedInputs:[],noExchanges:!1,noResolution:!1,keepOptionalSymbolsEmpty:!1,skipColorInputs:!1,skipTimeInputs:!1,skipOptionalEmptySymbolInputs:!1,skipTextareaInputs:!1,priceInputsForDisplay:!1},Me=j.enabled("study_symbol_ticker_description"),Ne=j.enabled("hide_main_series_symbol_from_indicator_legend");function Oe(e,t){const i=e.plots[t];if(!i||!(0,H.isOhlcPlot)(i))return!1;const s=i.target,r=e.defaults.styles&&e.defaults.styles[s],n=e.defaults.ohlcPlots&&e.defaults.ohlcPlots[s],o=e.ohlcPlots&&e.ohlcPlots[s];return r&&(0,H.isOhlcPlotStyleBars)(r)||n&&(0,H.isOhlcPlotStyleBars)(n)||!!o&&(0,H.isOhlcPlotStyleBars)(o)}function De(e,t){const i=e.plots[t];if(!i||!(0,H.isOhlcPlot)(i))return!1;const s=i.target,r=e.defaults.styles&&e.defaults.styles[s],n=e.defaults.ohlcPlots&&e.defaults.ohlcPlots[s],o=e.ohlcPlots&&e.ohlcPlots[s];return r&&(0,H.isOhlcPlotStyleCandles)(r)||n&&(0,H.isOhlcPlotStyleCandles)(n)||!!o&&(0,H.isOhlcPlotStyleCandles)(o)}function ke(e,t){(0,o.assert)(void 0!==e,"zOrder must be defined"),(0,o.assert)(!t.has(e),"zOrder must be unique")}function Be(e,t){return e.plots.some((e=>((0,H.isColorerPlot)(e)||(0,H.isDataPlot)(e))&&e.target===t))}function Re(e){const t={};if(e.plots)for(let i=0;i<e.plots.length;i++){const s=e.plots[i],r=s.id;if((0,H.isColorerPlot)(s))continue;const n={display:15,color:"#0496FF",linestyle:Se.LINESTYLE_SOLID,linewidth:2,plottype:H.LineStudyPlotStyle.Line,transparency:50,trackPrice:!1};(0,H.isBarColorerPlot)(s)&&(n.transparency=0),n.plottype=s.type,n.title=r,t[r]=n}return{styles:t}}function Fe(){const e=(0,F.clone)((0,ge.defaults)("study"));return e.intervalsVisibilities=(0,F.clone)(be.intervalsVisibilitiesDefaults),e}function Ue(e,t,i){let s=(0,F.clone)((0,ge.defaults)(i,t));return"Overlay"!==e.shortId&&"Compare"!==e.shortId||(s.currencyId=null,s.unitId=null),
e.isTVScript&&e.TVScriptSourceCode!==s.TVScriptSourceCode&&(s=(0,F.clone)((0,ge.factoryDefaults)(i))),s}function ze(e,t){var i;const s={};return we.StudyVersioning.mergeInputsObjPart(s,null!==(i=e.inputs)&&void 0!==i?i:{}),we.StudyVersioning.mergeInputsObjPart(s,t.inputs),{inputs:s}}function He(e,t,i,s){if(A.StudyMetaInfo.versionOf(e)<1)throw new Error("This function cannot work with metainfo of the old format version. Required format version >= 1");const r=A.StudyMetaInfo.getStudyPropertyRootName(e),o=(0,F.clone)(e.defaults),a=Fe();if((0,n.default)(a,Re(e)),(0,n.default)(a,o),(0,n.default)(a,(0,ge.factoryDefaults)(r)),(0,n.default)(a,Ue(e,s,r)),(0,n.default)(a,t),(0,n.default)(a,ze(o,a)),null!==i){const t=i.model().studiesColorRotatorFactory().getColorRotator(e);null!==t&&("Overlay@tv-basicstudies"===e.id?a.lineStyle.color=t.getColor(a.lineStyle.color):(0,n.default)(a,function(e,t){for(const i of Object.keys(e.styles)){const s=e.styles[i];if(s&&"color"in s){const e=s.color;s.color=t.getColor(e)}}return e}(a,t)))}return a}function We(e,t,i,s,r){return function(e,t,i,s,r,n){const o=He(e,t,i,s);return A.StudyMetaInfo.getSourceInputIds(e).forEach(((e,t)=>{const i=o.inputs[e];t<n.length?o.inputs[e]=`${n[t].id()}$0`:(0,F.isString)(i)&&i.includes("$")&&(o.inputs[e]="close")})),Xe(e,r,o)}(e,t,i,s,A.StudyMetaInfo.getStudyPropertyRootName(e),r)}const Ge=["id","description","description_localized","shortDescription","_metainfoVersion","is_price_study","is_hidden_study","priceScale","fullId","shortId","scriptIdPart","version","packageId","productId","isTVScriptStub","defaults","symbolSource","historyCalculationMayChange","format","linkedToSeries","isTVLibrary","docs","exports","exportTypes","extra","usesPrivateLib","financialPeriod","groupingKey","pine","isRGB","isTVScript","TVScriptMetaInfoExprs","usePlotsZOrder","isTVScriptStrategy","TVScriptSourceCode","lookaheadFutureData","hasAlertFunction","defaultStrategyAlertMessage","tags","canBeChild","canNotBeChild","_serverMetaInfoVersion","warnings"];function Xe(e,t,i){for(const e of Ge)delete i[e];const s=new Pe.DefaultProperty(t,i,!0);s.removeProperty("intervalsVisibilities"),s.addChild("intervalsVisibilities",new Ie.IntervalsVisibilitiesProperty(i&&i.intervalsVisibilities)),s.addExclusion("visible"),s.addExclusion("precision"),s.addExclusion("minTick"),s.addExclusion("intervalsVisibilities");for(let t=0;t<e.inputs.length;++t){const i=e.inputs[t];i.isHidden&&(s.addExclusion("inputs."+t.toString()),s.addExclusion("inputs."+i.id))}return"PivotPointsStandard@tv-basicstudies"!==e.id&&"PivotPointsHighLow@tv-basicstudies"!==e.id||!s.hasChild("font")||s.removeProperty("font"),s}function Ye(e,t,i,s,r,o){const a=function(e,t,i,s,r){var o;e.version&&i.version&&e.version!==i.version&&xe.logWarn("Serialized metaInfo version "+e.version+" is not equal to the saved state version "+i.version);const a=t||e,l=null!==(o=(0,F.clone)(a.defaults))&&void 0!==o?o:{},u=A.StudyMetaInfo.getStudyPropertyRootName(a),d=A.StudyMetaInfo.getStudyPropertyRootName(e);let c=Fe();return(0,n.default)(c,Re(e)),(0,
n.default)(c,(0,F.clone)(e.defaults)),(0,n.default)(c,l),(0,n.default)(c,(0,ge.factoryDefaults)(u)),(0,n.default)(c,(0,ge.factoryDefaults)(d)),(0,n.default)(c,Ue(a,s,u)),(0,n.default)(c,Ue(e,s,d)),(0,n.default)(c,i),c=s.updateStudyState(c,e,t),void 0!==r&&t&&(c=r(i,c,e,t)),A.StudyMetaInfo.versionOf(a)>=1&&(0,n.default)(c,ze(l,c)),c}(e,t,i,s,o);return Xe(t||e,r,a)}function je(e,t,i,s,r){return Ye(e,t,i,s,A.StudyMetaInfo.getStudyPropertyRootName(e),r)}function Ke(e,t,i){let s=0,r=0;return e.inputs.filter((e=>"source"===e.type)).forEach((e=>{(0,Y.getInputValue)(i[e.id]).includes("$")&&s++,(0,Y.getInputValue)(t[e.id]).includes("$")&&r++})),Math.sign(r)-Math.sign(s)}function $e(e){const t=new Set;for(const i of e.parentSources())for(const e of $e(i))t.add(e);return t.add(e),Array.from(t)}function qe(e,t){return"BISTMIXED"===t&&(0,ue.isVolumeDataError)(e.error)&&(e.error="VOLUME_BIST_MIXED",e.solution_id=G.solutionIds.BIST_MIXED_SUBSCRIPTION,e.title=ue.noVolumeErrorTooltip),{type:ue.StudyStatusType.Error,errorDescription:e}}class Ze extends w.PriceDataSource{constructor(e,t,i,s){var r,n,a;super(e),this._onStart=new P.Delegate,this._onHibernationStateChange=new P.Delegate,this._symbolsResolved=new P.Delegate,this._statusChanged=new P.Delegate,this._restarting=!1,this._paneViews=[],this._legendView=null,this._priceAxisViews=[],this._inputsAnchorsPaneView=null,this._inputsLinesPaneView=null,this._inputsTimeAxisPaneViews=[],this._inputsPriceAxisPaneViews=[],this._resolvedSymbols={},this._resolvedSymbolsByInput={},this._sources=[],this._status={type:ue.StudyStatusType.Undefined},this._wasCompletedBefore=!1,this._studyId=null,this._isSubscribedToSessionId=!1,this._titleStrCache={},this._titleInPartsCache={},this._children=[],this._numericFormatter=new U.NumericFormatter,this._priceAxisViewsBase=[],this._priceLinesAxisViews=[],this._graphicsPriceAxisViews=[],this._labelPaneViews=[],this._ownFirstValue=null,this._plotOffsets={},this._formatter=null,this._ongoingDataUpdate=Promise.resolve(),this._studyModified=!1,this._isDestroyed=!1,this._dataUpdated=new P.Delegate,this._tagsChanged=new P.Delegate,this._studyName="",this._turnaround="st0",this._currencySourceSymbolInputProperty=null,this._pendingResolveSymbols=new Map,this._onIsActualIntervalChange=new P.Delegate,this._childStudyByRebind=new P.Delegate,this._lastNonEmptyPlotRowCache={},this._startMovingPoint=null,this._processHibernateBound=this.processHibernate.bind(this,1),this._maxOffset=new pe.WatchedValue(0),this._currencySourceSymbolInfo=null,this._graphicsPriceRangeGroups=null,this._graphicsViewsReady=!1,this._turnaroundCounter=0,this._deferredPinePatchProps=!1,this._chartApi=e.chartApi(),this._properties=t,this._metaInfo=s,this._series=this._model.mainSeries(),this._series.onIntervalChanged().subscribe(this,this._calcIsActualInterval),this._showStudyArgumentsProperty=e.properties().childs().paneProperties.childs().legendProperties.childs().showStudyArguments,e.collapsed().subscribe(this._processHibernateBound),this._sources=i,
A.StudyMetaInfo.setChildStudyMetaInfoPropertiesSourceId(s,null===(r=this._sources[0])||void 0===r?void 0:r.id(),t),i.forEach((e=>{e.setChild(this)})),[this._series,...i].forEach((e=>{e.currencyChanged().subscribe(this,this._onSourceCurrencyChanged),e.unitChanged().subscribe(this,this._onSourceUnitChanged),e.priceRangeReadyChanged().subscribe(this,this._onSourcePriceRangeReadyChanged),e.formatterChanged().subscribe(this,this._onSourceFormatterChanged),e.priceStepChanged().subscribe(this,this._onSourcePriceStepChanged)})),Me&&this._model.mainSeries().properties().childs().statusViewStyle.childs().symbolTextSource.listeners().subscribe(this,(()=>{this.invalidateTitleCache(!0)}));const l=this._properties.childs();for(const e of A.StudyMetaInfo.getSourceInputIds(s))null===(n=l.inputs.childs()[e])||void 0===n||n.subscribe(this,this._onSourceInputChanged);this._properties.subscribe(this,this._onPropertiesChanged),l.visible.subscribe(this,this._visibleChanged),l.visible.subscribe(this,(()=>this.processHibernate())),l.intervalsVisibilities.subscribe(this,this._calcIsActualInterval),l.inputs.listeners().subscribe(this,this._updateMaxOffsetValue),void 0!==l.offsets&&l.offsets.listeners().subscribe(this,this._updateMaxOffsetValue),void 0!==l.offset&&l.offset.listeners().subscribe(this,this._updateMaxOffsetValue),M.hideAllIndicators().subscribe(this,this._visibleChanged);for(let e=0;e<this._metaInfo.plots.length;e++){const t=this._metaInfo.plots[e].id,i=this._properties.childs().styles.childs()[t];null==i||i.childs().display.subscribe(this,(()=>this.processHibernate()))}for(const e of Object.keys(this._metaInfo.graphics))for(const t of Object.keys(this._metaInfo.graphics[e])){const i=null===(a=l.graphics.childs()[e])||void 0===a?void 0:a.childs()[t];i&&i.childs().visible&&(0,o.ensureDefined)(i.childs().visible).subscribe(this,(()=>this.processHibernate()))}this._isActualInterval=(0,de.isActualInterval)(this._series.intervalObj(),this._properties.childs().intervalsVisibilities),this._initializeStudyInputsPaneViews(),this._handler=e=>this.onData(e),this._handler.isTVScriptStrategy=this._metaInfo.isTVScriptStrategy,this._valuesProvider=new Te.StudyValuesProvider(this,e),this._graphicsPriceRangeGroups=(0,W.getGraphicsPriceRangeGroups)(this),this._graphics=new E.LiveStudyGraphics(s.graphics)}destroy(){var e;this.parentSources().forEach((e=>{e.currencyChanged().unsubscribeAll(this),e.unitChanged().unsubscribeAll(this),e.priceRangeReadyChanged().unsubscribeAll(this),e.formatterChanged().unsubscribeAll(this),e.priceStepChanged().unsubscribeAll(this)})),this._series.properties().childs().statusViewStyle.childs().symbolTextSource.unsubscribeAll(this),this._series.onIntervalChanged().unsubscribeAll(this),this.formatterChanged().unsubscribe(this,this.invalidateTitleCache),M.hideAllIndicators().unsubscribe(this,this._visibleChanged),this._model.collapsed().unsubscribe(this._processHibernateBound),null!==this._currencySourceSymbolInputProperty&&this._currencySourceSymbolInputProperty.unsubscribeAll(this),
null===(e=this._legendView)||void 0===e||e.destroy()}properties(){return this._properties}isDraggable(){return!this._metaInfo.linkedToSeries}logs(){return this._metaInfo.graphics.logs&&this._graphics instanceof E.LiveStudyGraphics?(0,o.ensureDefined)(this._graphics.observableLogs().get("logs")):null}logLevelMask(){const e=this._properties.childs().inputs.childs().__log_level.value();if(!(0,F.isNumber)(e)||e<0||e>7)throw new Error(`Value of log level is unexpected, current value is ${e}, but expected values from 0 to 7`);return{error:Boolean(1&e),warning:Boolean(2&e),info:Boolean(4&e)}}setLogLevelMask(e){const t=(Number(e.error)&&1)|(Number(e.warning)&&2)|(Number(e.info)&&4);this._properties.childs().inputs.childs().__log_level.setValue(t)}lastValueData(e,t,i){const s={noData:!0},r=this.priceScale();if(this._model.timeScale().isEmpty()||null===r||r.isEmpty()||this.data().isEmpty())return s;const n=this._model.timeScale().visibleBarsStrictRange(),o=this.firstValue(!0);if(null===n||null===o)return s;if(!this._properties.childs().visible.value())return s;const a=this._properties.childs().styles,l=this._properties.childs().ohlcPlots;let u,d;if(a&&a.childs()[e]&&(u=a.childs()[e]),l&&l.childs()[e]&&(u=l.childs()[e]),!u||0===u.childs().display.value())return s;const c=this.metaInfo().plots;for(d=0;d<c.length;d++){const t=c[d];if(t.id===e||(0,H.isOhlcClosePlot)(t)&&t.target===e)break}const h=d+1,p=this.offset(e),_=this.nearestIndex(n.lastBar()-p,x.PlotRowSearchMode.NearestLeft,h);if(void 0===_)return s;const m=this._lastNonEmptyPlotRow(h),f=null!==m&&n.contains(m.index),v=null!==m?m.value:null,y=t||f?v:this.data().valueAt(_);if(!y||!(0,F.isNumber)(y[h]))return s;const g=y[h],S=this._valuesProvider.getPlotColor(d,y),b=r.priceToCoordinate(g,o),P={...r.getFormattedValues(g,o),noData:!1,color:S,floatCoordinate:b,coordinate:b};return i&&(P.price=g),P}isFailed(){return this._status.type===ue.StudyStatusType.Error}isLoading(){return this._status.type===ue.StudyStatusType.Loading}isSymbolInvalid(){return this._status.type===ue.StudyStatusType.Error&&this._status.errorDescription.error===Le}state(e,t){var i,s;const r=(0,o.ensureNotNull)((0,u.className)(this.constructor)),n=this.metaInfo();let a;n instanceof A.StudyMetaInfo?a=(0,F.clone)(n.state()):(a=(0,F.clone)(this.metaInfo()),a.id=A.StudyMetaInfo.parseIdString(a.id+(a.version?"-"+a.version:"")).fullId);const l={type:r,id:this.id(),state:this.properties().state(),zorder:this.zorder(),ownFirstValue:this.isVisible()?null:this._ownFirstValue,metaInfo:a},d=this._sources.map((e=>e.id()));if(d.length&&(l.parentSources=d),e){let e=this.data();const t=this._model.timeScale(),i=this._seriesDataRangeToSave(e);null!==i&&(e=e.range(i.firstBar(),i.lastBar())),l.data=e.state(),l.data.symbols=this._resolvedSymbols,l.data.graphics=(0,E.saveStudyGraphics)(this.graphics(),t.visibleBarsStrictRange()),l.data.plotOffsets=this._plotOffsets}this.ownerSource()&&(l.ownerSource=null===(i=this.ownerSource())||void 0===i?void 0:i.id());for(let e=0;e<n.inputs.length;e++)if("bar_time"===n.inputs[e].type){
const t=n.inputs[e].id,i=l.state.inputs[t];if(i<0){const e=this._rightOffsetToUnixTime(-i);l.state.inputs[t]=e&&e>=0?e:0}}if(null===(s=l.state)||void 0===s?void 0:s.inputs){const e=l.metaInfo.inputs.find((e=>"ILScript"===e.name));e&&delete l.state.inputs[e.id]}const c=this.stateCustomFields();var h;return c&&(l.customFields=c),t&&(h=l).metaInfo&&h.metaInfo.scriptIdPart&&h.metaInfo.scriptIdPart.startsWith("USER;")&&(function(e){if(!e.metaInfo)return;const t=e.metaInfo.scriptIdPart;if(!t)return;const i=t.split(";")[0],s=e.metaInfo;s.id=(s.id||"").replace(t,i),s.fullId=(s.fullId||"").replace(t,i),s.name=(s.name||"").replace(t,i),s.shortId=(s.shortId||"").replace(t,i),s.scriptIdPart=(s.scriptIdPart||"").replace(t,i),e.state&&(e.state.id=(e.state.id||"").replace(t,i),e.state.name=(e.state.name||"").replace(t,i),e.state.scriptIdPart=(e.state.scriptIdPart||"").replace(t,i))}(h),function(e){const t=(e.metaInfo&&e.metaInfo.inputs||[]).find((e=>"ILScript"===e.name));t&&(t.defval="",e.state&&e.state.inputs&&(e.state.inputs[t.id]=""),e.metaInfo.defaults.inputs&&(e.metaInfo.defaults.inputs[t.id]=""))}(h)),l}stateCustomFields(){}restoreStateCustomFields(e){}restoreData(e){var t,i;this._invalidateLastNonEmptyPlotRowCache(),this.data().restoreState(e),this._resolvedSymbols=null!==(t=e.symbols)&&void 0!==t?t:{},this._graphics=e.graphics?(0,E.loadStudyGraphics)(e.graphics):(0,E.emptyStudyGraphics)(),this._postProcessGraphics(),this._plotOffsets=null!==(i=e.plotOffsets)&&void 0!==i?i:{},this._setStatus({type:ue.StudyStatusType.Completed},!0)}hasStateForAlert(){return j.enabled("alerts")&&!this.isFailed()&&(this._hasAlertConditions()||this._hasAvailableAlertPlots()||this._hasAlertFunction())}stateForAlert(){const e=(0,o.ensureNotNull)(this._alertMetaInfo()),t=this._plotsForAlert(),i=this._collectDepsForAlert(),s=i.idForAlert,r=i.studyDependencies,n=i.inputsForAlert,a=(this.priceScale()||this.model().mainSeries().priceScale()).formatter(),l=a?p.FormattersSerializer.serialize(a):null,u={id:s,uniqueId:s,type:(0,o.ensureNotNull)(window.TradingView.className(this.constructor)),title:(0,d.clean)(this._title(z.TitleDisplayTarget.StatusLine,!1,{},!1),!0),shortTitle:(0,d.clean)(this._title(z.TitleDisplayTarget.StatusLine,!0,{},!1),!0),shortDescription:(0,d.clean)(e.shortDescription||"Study",!0),fullId:e.fullId,isTVScript:Boolean(e.isTVScript),isTVScriptStrategy:Boolean(e.isTVScriptStrategy),isTVLibrary:Boolean(e.isTVLibrary),hasAlertFunction:Boolean(e.hasAlertFunction),plots:t,inputs:n,alerts:e.alerts,scriptIdPart:e.scriptIdPart,scriptVersion:e.pine?e.pine.version:"-1",callStudyDependencies:(0,c.formatCallstudyArg)(this._dependenciesForAlerts()),studyDependencies:r,formatter:l},h=(0,_.getStudyDangerReason)(this);h&&(u.dangerReason=h);const m=e.defaultStrategyAlertMessage;return m&&(u.defaultStrategyAlertMessage=(0,d.clean)(m,!0)),u}idForAlert(){return this._collectDepsForAlert().idForAlert}alertCreationAvailable(){const e=this._alertMetaInfo();return new pe.WatchedValue(null!==e&&!e.isTVLibrary&&super.alertCreationAvailable().value()).readonly()
}hasBarColorer(){return(0,o.ensureNotNull)(this._metaInfo).plots.some(H.isBarColorerPlot)}barColorer(){const e=this._metaInfo.plots;let t=null;for(let i=0;i<e.length;++i)if((0,H.isBarColorerPlot)(e[i])){const e=new ve.StudyBarColorer(this,i);null===t?t=e:t.pushBackBarColorer(e)}return t}restart(e){this._restarting=!0,this.clearData(),(e||j.enabled("stop_study_on_restart"))&&this.stop(),setTimeout(this.start.bind(this),0)}stop(e,t){if(!0===e&&this._children)for(const e of this._children)e.stop(!0);this._stopStudyOnServer(),this.clearData(),this._unsubscribeToSessionId(),this.recalculate()}disconnect(){this._studyId=null,this._model.isSnapshot()||(this._resolvedSymbols={},this._resolvedSymbolsByInput={})}sourceId(){return this._studyId}parentSources(){return this._sources}symbolSource(){return this._firstSourceOrSeries().symbolSource()}valueAt(e,t){return this.symbolSource().valueAt(e,t)}barsProvider(){return this._firstSourceOrSeries().barsProvider()}ownerSource(){return this.isChildStudy()?this._sources[0]:super.ownerSource()}isChildStudy(){return this._sources.length>0}hasChildren(){return this._children.length>0}isStarted(){return Boolean(this._studyId)}isRestarting(){return this._restarting}isActualInterval(){return this._isActualInterval}onIsActualIntervalChange(){return this._onIsActualIntervalChange}isVisible(){var e,t,i;const s=this._properties.childs();if(this._model.collapsed().value()||!s.visible.value()||!this.isActualInterval())return!1;const r=this.metaInfo();if(r.plots.length>0)for(let e=0;e<r.plots.length;e++){const t=r.plots[e].id,i=s.styles.childs()[t];if(void 0===i)continue;if(0!==i.childs().display.value())return!0}if(r.bands)for(let e=0;e<r.bands.length;e++)if(s.bands.childs()[e].childs().visible.value())return!0;for(const n of Object.keys(r.graphics))for(const o of Object.keys(r.graphics[n])){const r=null===(e=s.graphics.childs()[n])||void 0===e?void 0:e.childs()[o];if(void 0!==r&&(null===(i=null===(t=r.child("visible"))||void 0===t?void 0:t.value())||void 0===i||i))return!0}if(r.filledAreas)for(let e=0;e<r.filledAreas.length;e++)if(s.filledAreasStyle.childs()[r.filledAreas[e].id].childs().visible.value())return!0;return!(!r.isTVScriptStrategy&&!r.hasAlertFunction)}async start(e,t,i){const s=this._model.mainSeries();s.isStarted()||await s.startedAndCompleted(),await Promise.all(this._sources.filter((e=>e.isHibernated())).map((e=>e.start())));const r=!(this.isHibernationAllowed()&&!this.isVisible())||!0===t;if(this._chartApi&&this._chartApi.isConnected().value()&&r)try{await this._allSymbolsAreResolved(),await this._startAfterSymbolsResolved(e,t)}catch(e){const t=`ERROR: ${this._debugId()} start failed, ${e}`;xe.logError(t),this._restarting=!1,"TooManyStudies"===(null==e?void 0:e.cause)&&(0,b.showTooManyStudiesNotice)(this._chartApi.getStudyCounter())}}replaceData(e,t,i){this._invalidateLastNonEmptyPlotRowCache(),this.data().remove(e+1),this.data().addTail(i,t)}inputs(e){const t=(0,n.default)((0,F.clone)(Ve),e||{});t.skipOptionalEmptySymbolInputs&&(t.keepOptionalSymbolsEmpty=!0);const i=(0,
r.default)(this._buildInputs(t));return t.patchSosInputs&&A.StudyMetaInfo.patchSoSInputs(i,(e=>{var t,i;return null!==(i=null===(t=this._sources.find((t=>t.id()===e)))||void 0===t?void 0:t.sourceId())&&void 0!==i?i:null})),i}plots(){return this.data()}metaInfo(){return this._metaInfo}status(){return this._status}name(e){return e?this.metaInfo().shortDescription||"Study":this.metaInfo().description||"Study"}title(e,t,i,s,r){s=void 0===s?!this._showStudyArgumentsProperty.value():s;const n=JSON.stringify([e,t,i,s,r]);if(this._titleStrCache[n])return this._titleStrCache[n];if(this._titleInPartsCache[n])return this._joinTitlesParts(this._titleInPartsCache[n]);const o=this._title(e,t,i,s,r);return this._titleStrCache[n]=o,o}titleInParts(e,t,i,s,r){s=void 0===s?!this._showStudyArgumentsProperty.value():s;const n=JSON.stringify([e,t,i,s,r]);if(this._titleInPartsCache[n])return this._titleInPartsCache[n];const o=this._titleInParts(e,t,i,s,r);return this._titleInPartsCache[n]=o,o}invalidateTitleCache(e){if(this._titleStrCache={},this._titleInPartsCache={},!0===e&&this._children)for(let t=0;t<this._children.length;++t)this._children[t].invalidateTitleCache(e)}graphicsInfo(){return this._metaInfo.graphics}setOwnFirstValue(e){this._ownFirstValue=e}firstValue(e){if(!this.isChildStudy()&&"Compare@tv-basicstudies"===this._metaInfo.id||!this._metaInfo.is_price_study){const t=this._model.timeScale().visibleBarsStrictRange();if(null===t)return null;const i=this.properties().childs();if(!i.visible.value()||!this.isActualInterval()||null!==this._startMovingPoint)return this._ownFirstValue;const s=t.firstBar(),r=t.lastBar();let n=this._graphicsPriceRangeGroups?(0,W.studyGraphicsFirstValue)(this,this._graphicsPriceRangeGroups):null;const a=this._metaInfo.plots||[];if(null===n){const t=new Set,l=this._metaInfo.filledAreas||[];for(let e=0;e<l.length;e++){const s=l[e];i.filledAreasStyle.childs()[s.id].childs().visible.value()&&(t.add(s.objAId),t.add(s.objBId))}for(const l of this.data().rangeIterator(s,r)){const s=l.value;for(let r=0;r<a.length;++r){if((0,H.isColorerPlot)(a[r]))continue;const l=s[r+1];if(null==l)continue;const u=a[r].id;if((0!==(0,o.ensureDefined)(i.styles.childs()[u]).childs().display.value()||t.has(u))&&!(e&&Math.abs(l)<1e-10)){n=l;break}}if(null!==n)break}}return this._ownFirstValue=n,null!==n?n:this._bandsFirstValue(e)}if(this.isChildStudy()){const e=this._getNonPriceParent();if(e&&this.priceScale()===e.priceScale())return null!==e._ownFirstValue?e._ownFirstValue:e.firstValue()}return this._series.firstValue()}priceRange(e,t){let i=null;const s=this._metaInfo,r=this._fillPrecalculatedAutoscaleInfo(e,t);let n=this.data().minMaxOnRangeCached(e,t,r.fields);if(n=(0,C.mergeMinMax)(r.baseValueMinMax,n),r.useMainSeriesRange){const i=[{name:"low",offset:0},{name:"high",offset:0}],s=this.series().data().bars().minMaxOnRangeCached(e,t,i);n=(0,C.mergeMinMax)(n,s)}if(null!==n&&(i=new T.PriceRange(n.min,n.max)),s.bands)for(let e=0;e<s.bands.length;e++){const t=(0,o.ensureDefined)(this._properties.childs().bands.childs()[e]).childs()
;if(t.visible.value()){const e=t.value.value();if(!(0,F.isNumber)(e))continue;i?i.apply(e,e):i=new T.PriceRange(e,e)}}if(this._graphicsPriceRangeGroups){const s=(0,W.studyGraphicsPriceRange)(this._graphicsPriceRangeGroups,e,t);s&&(i=i?i.merge(s):s)}return this._postProcessPriceRange(i)}autoScaleInfo(e,t){const i=this.priceRange(e,t),s=this._graphicsPriceRangeGroups?(0,W.studyGraphicsPixelsMargins)(this._graphicsPriceRangeGroups,e,t):{topPixelMargin:0,bottomPixelMargin:0};return{range:i,topPixelMargin:s.topPixelMargin,bottomPixelMargin:s.bottomPixelMargin}}formatter(){return this._formatter?this._formatter:this._firstSourceOrSeries().formatter(!1)}updateAllViews(e){var t,i,s,r,n;this._paneViews.forEach((t=>t.update(e))),this._labelPaneViews.forEach((t=>t.update(e))),null===(t=this._dataWindowView)||void 0===t||t.update(),null===(i=this._legendView)||void 0===i||i.update(),null===(s=this._statusView)||void 0===s||s.update(),this._priceAxisViews.forEach((t=>t.update(e))),this._priceLinesAxisViews.forEach((t=>t.update(e))),null===(r=this._inputsLinesPaneView)||void 0===r||r.update(e),null===(n=this._inputsAnchorsPaneView)||void 0===n||n.update(e),this._inputsTimeAxisPaneViews.forEach((t=>t.update(e))),this._inputsPriceAxisPaneViews.forEach((t=>t.update(e)))}getStudyName(){return this._studyName}getMinFirstBarIndexForPlot(e){var t,i,s,r,n,o,a,l,u,d,c,h,p,_,m;const f=this._properties.childs(),v=this._metaInfo,y=null!==(m=null!==(h=null!==(u=null!==(o=null!==(s=null===(i=null===(t=f.styles.childs()[e])||void 0===t?void 0:t.child("showLast"))||void 0===i?void 0:i.value())&&void 0!==s?s:null===(n=null===(r=f.filledAreasStyle.childs()[e])||void 0===r?void 0:r.child("showLast"))||void 0===n?void 0:n.value())&&void 0!==o?o:null===(l=null===(a=v.styles)||void 0===a?void 0:a[e])||void 0===l?void 0:l.showLast)&&void 0!==u?u:null===(c=null===(d=f.ohlcPlots.childs()[e])||void 0===d?void 0:d.child("showLast"))||void 0===c?void 0:c.value())&&void 0!==h?h:null===(_=null===(p=v.ohlcPlots)||void 0===p?void 0:p[e])||void 0===_?void 0:_.showLast)&&void 0!==m?m:null;if(null===y)return-1/0;const g=this.data().lastIndex();return null===g?-1/0:g-y+1}guiPlotName(e,t){var i,s,r;return null!==(r=null===(s=null===(i=this._metaInfo.styles)||void 0===i?void 0:i[t])||void 0===s?void 0:s.title)&&void 0!==r?r:this.title(e)}childStudyByRebind(){return this._childStudyByRebind}isPine(){return void 0!==this._metaInfo.pine}isStandardPine(){return this.isPine()&&A.StudyMetaInfo.isStandardPine(this._metaInfo.id)}isLinkedToSeries(){return!0===this._metaInfo.linkedToSeries}defaultPlotIdForAlert(){return this._metaInfo.plots.length?this._metaInfo.plots[0].id:null}resolvedSymbolInfoBySymbol(e){return this._resolvedSymbols&&e&&this._resolvedSymbols[this._getSymbolForResolve(e)]||null}currency(){const e=this.metaInfo();return Boolean(e)&&e.is_price_study?this._firstSourceOrSeries().currency():null}currencySourceSymbolInfo(){var e,t,i
;return null!==(e=this._currencySourceSymbolInfo)&&void 0!==e?e:null!==(i=null===(t=this.symbolSource())||void 0===t?void 0:t.symbolInfo())&&void 0!==i?i:null}unit(){const e=this.metaInfo();return Boolean(e)&&e.is_price_study?this._firstSourceOrSeries().unit():null}dataWindowView(){return this._dataWindowView}statusView(){return this._statusView}legendView(){return this._legendView}inputsForAlertState(){return this.inputs()}sessionId(){return this._firstSourceOrSeries().sessionId()}sessionIdChanged(){return this._firstSourceOrSeries().sessionIdChanged()}getSymbolString(e){return""===e?"":(0,O.encodeExtendedSymbolOrGetSimpleSymbolString)(this._getSymbolObject(e))}onStatusChanged(){return this._statusChanged}symbolsResolved(){return this._symbolsResolved}onHibernationStateChange(){return this._onHibernationStateChange}valuesProvider(){return new B.StudyLegendValuesProvider(this,this.model())}statusProvider(e){return new R.StudyStatusProvider(this,this._model.properties().childs().scalesProperties.childs().textColor)}correctScaleMargins(e){if("Volume"===this.metaInfo().shortId){const t=this.model().paneForSource(this);return null!==t&&t.isOverlay(this)&&t.containsMainSeries()?{top:.75,bottom:0}:{top:e.top,bottom:0}}return e}canBeHiddenByGlobalFlag(){return!0}isSourceHidden(){return!this.isVisible()||this.canBeHiddenByGlobalFlag()&&M.hideAllIndicators().value()}paneViews(e){if(this.isSourceHidden()||!e.hasPriceDataSource(this))return null;const t=[];return!this._startMovingPoint&&this._wasCompletedBefore&&t.push(...this._paneViews),this._inputsLinesPaneView&&(this._startMovingPoint||this._model.selection().isSelected(this))&&t.push(this._inputsLinesPaneView),this._inputsAnchorsPaneView&&t.push(this._inputsAnchorsPaneView),t}labelPaneViews(){return this.isSourceHidden()?null:this._labelPaneViews}timeAxisViews(){return this._model.selection().isSelected(this)?this._inputsTimeAxisPaneViews:null}priceAxisViews(e,t){const i=this._properties.childs().oldShowLastValue;if(i&&!i.value())return null;let s=this._priceAxisViews.slice();return this._model.selection().isSelected(this)&&(s=s.concat(this._inputsPriceAxisPaneViews)),e.findTargetPriceAxisViews(this,t,s,this._priceLinesAxisViews)}movable(){return null!==this._inputsAnchorsPaneView}startMoving(e,t,i,s){this._startMovingPoint=e,this.stop()}move(e,t,i,s){if(void 0!==e.logical&&null!==this._startMovingPoint){if(Array.isArray(t)){const i=t;this._updateInputValue(e.logical,i[0]),this._updateInputValue(e.logical,i[1])}else this._updateInputValue(e.logical,t);this.updateAllViews((0,he.sourceChangeEvent)(this.id()))}}endMoving(e,t){return this._startMovingPoint=null,this.start(),{indexesChanged:!1,pricesChanged:!1}}clearData(){var e;this._invalidateLastNonEmptyPlotRowCache(),this.data().clear(),this._graphics instanceof E.LiveStudyGraphics&&(null===(e=this._graphics)||void 0===e||e.clear()),this._plotOffsets={},this.hasBarColorer()&&this._model.mainSeries().invalidateBarStylesCache(),this.updateAllViews((0,he.sourceChangeEvent)({sourceId:this.id(),clearData:!0}))}
convertYCoordinateToPriceForMoving(e,t){const i=this.priceScale();if(!t||!i||i.isEmpty())return null;const s=t.firstValue();return null===s?null:i.coordinateToPrice(e,s)}processHibernate(e){const t=this.isVisible();if(!this.isStarted()&&t&&(this._sources.forEach((e=>{e.processHibernate()})),this.start(void 0,void 0,e),this._onHibernationStateChange.fire(!1)),this.isHibernationAllowed()&&this.isStarted()&&!t){for(const e of this._children)e.processHibernate();this.stop(void 0,e),this._onHibernationStateChange.fire(!0)}}isHibernationAllowed(){return!this.metaInfo().historyCalculationMayChange&&(!this.hasChildren()||!!this._model.collapsed().value()&&this._children.every((e=>e.isHibernationAllowed())))}isPlotVisibleAt(e,t){let i;const s=this.metaInfo().plots.find((t=>t.id===e));if(i=void 0!==s?(0,H.isOhlcPlot)(s)?this._properties.childs().ohlcPlots.childs()[s.target]:this._properties.childs().styles.childs()[e]:this._properties.childs().ohlcPlots.childs()[e],void 0===i)throw new Error(`Study does not contain ${e} plot`);const r=i.childs().display.value();return null!==r&&(r&t)===t}recalculate(){const e=this._model.paneForSource(this);this._model.recalculatePane(e,(0,he.sourceChangeEvent)(this.id())),this._model.updateSource(this)}maxOffset(){return this._maxOffset}onStart(){return this._onStart}isHibernated(){return!this.isVisible()&&!this.isStarted()}graphicsViewsReady(){return this._graphicsViewsReady}turnaround(e){if(!e)return this._turnaround;const t=this._series.seriesSource().turnaround(),i=(0,X.buildTreeForStudy)(this);return(0,X.buildTurnaround)(t,i)}canHaveChildren(){var e;return this._canHaveChildren=null!==(e=this._canHaveChildren)&&void 0!==e?e:A.StudyMetaInfo.canHaveChildren(this._metaInfo),this._canHaveChildren}setChild(e){-1===this._children.indexOf(e)&&this._children.push(e)}unsetChild(e){const t=this._children.indexOf(e);~t&&this._children.splice(t,1)}getAllChildren(){const e=this._children.slice();for(let t=0;t<e.length;++t){const i=e[t].getAllChildren();for(let t=0;t<i.length;++t)~e.indexOf(i[t])||e.push(i[t])}return e}parentSourceForInput(e){var t;if(e.includes("$")){const i=e.split("$")[0];return null!==(t=this._sources.find((e=>e.id()===i)))&&void 0!==t?t:null}return this._series}priceStep(){return this._priceStep||this._firstSourceOrSeries().priceStep(!1)}_alertMetaInfo(){return this.metaInfo()}_incrementTurnaround(){this._turnaround="st"+ ++this._turnaroundCounter}_checkTurnaround(e){return e===this._turnaround||e===this._model.mainSeries().seriesSource().turnaround()||e===this.turnaround(!0)}_createStudyOnServer(){if(this._isDestroyed)return;const e=this._getStudyIdWithLatestVersion();this._studyId=(0,D.makeNextStudyId)(),this._incrementTurnaround(),this._studyName=e;const t=(0,F.clone)((0,o.ensureDefined)(this._inputs));A.StudyMetaInfo.patchSoSInputs(t,(e=>{var t,i;return null!==(i=null===(t=this._sources.find((t=>t.id()===e)))||void 0===t?void 0:t.sourceId())&&void 0!==i?i:null})),this._chartApi.createStudy(this._studyId,this._turnaround,(0,
o.ensureNotNull)(this._series.seriesSource().instanceId()),this._studyName,t,this._handler,this.isChildStudy()),this._deferredPinePatchProps&&this._pinePatchPropsAllowed()&&this._pinePatchProps()}_stopStudyOnServer(){this._chartApi&&this._chartApi.isConnected().value()&&this.isStarted()&&(this._chartApi.removeStudy((0,o.ensureNotNull)(this._studyId),this.isChildStudy()),this._setStatus({type:ue.StudyStatusType.Undefined})),this._studyId=null}_modifyStudyOnServer(e,t){const i=(0,F.clone)((0,o.ensureDefined)(e));A.StudyMetaInfo.patchSoSInputs(i,(e=>{var t,i;return null!==(i=null===(t=this._sources.find((t=>t.id()===e)))||void 0===t?void 0:t.sourceId())&&void 0!==i?i:null})),this._chartApi.modifyStudy((0,o.ensureNotNull)(this._studyId),this._turnaround,i,this._handler,t)}_transformData(e){}_updateMaxOffsetValue(){let e=-1/0;for(const t of this._metaInfo.plots)e=Math.max(this.offset(t.id),e);this._maxOffset.setValue(e)}_rightOffsetToUnixTime(e){if(this._series.bars().size()>=e){const t=(0,o.ensureNotNull)(this._series.bars().lastIndex())-e;return(0,o.ensureNotNull)(this._series.bars().valueAt(t))[0]}return null}_invalidateLastNonEmptyPlotRowCache(){this._lastNonEmptyPlotRowCache={}}_collectDepsForAlert(){const e=[this,...this._getAllOwnerSources().filter((e=>e instanceof Ze))];return(0,m.collectDepsForAlert)(e)}_allInputsAreValid(){for(const e of this._metaInfo.inputs)if("bar_time"===e.type){const t=e.id;if(null==this._properties.childs().inputs.childs()[t].value())return!1}return!0}async _startAfterSymbolsResolved(e,t){await Promise.all(this._sources.map((e=>!e.isStarted()||e.isRestarting()?new Promise((t=>{e.onStart().subscribe(this,t,!0)})):Promise.resolve()))),this.isStarted()&&!this._restarting||(this._restarting=!1,this._allInputsAreValid()&&(this._inputs=this._apiInputs(),this._createStudyOnServer(),this._subscribeToSessionId(),this._onStart.fire(),!0===e&&this._children&&await this._children.map((e=>e.start(!0,t)))))}async _changeInputsImpl(e,t){const s=this._calcSources();let r=!0;const n=Ke(this._metaInfo,e,t);{const r=()=>{for(const i of this._metaInfo.inputs){if("source"!==i.type)continue;const s=e[i.id].v,r=t[i.id].v;if(s!==r){(0,o.ensureDefined)(this._properties.childs().inputs.child(i.id)).setValue(r)}}};if(this.isStarted()&&this._chartApi.isConnected().value()&&n>0&&!this._chartApi.canCreateStudy(!0)){const e=window.user.pro_plan;return(0,v.createGoProDialog)({feature:"studyOnStudy",actions:e&&[g.ExpertPlans.PremiumExpert,g.ExpertPlans.PremiumExpert+S.TRIAL_SUFFIX].includes(e)?[{text:a.t(null,void 0,i(875139)),action:y.PredefinedAction.Close}]:void 0}),void r()}this._inputs=e;let l=!1;const u=Object.values(Y.RangeDependentStudyInputNames);for(const i of Object.keys(e))if(JSON.stringify(e[i])!==JSON.stringify(t[i])&&!u.includes(i)){l=!0;break}this._incrementTurnaround(),l&&this.disablePriceRangeReady();try{await this._updateParentSources(s,n,!0),this._modifyStudyOnServer(e,n)}catch(e){xe.logError(`Error applying parent sources: ${e}`),r()}}this.invalidateTitleCache(),r&&(this._studyModified=r)}
createPriceAxisView(e){return new me.StudyPriceAxisView(this,{plotIndex:e})}createPriceLineAxisView(e){return new fe.StudyPriceLineAxisView(this,e)}_createStudyPlotPaneView(e){return new te.StudyPlotPaneView(this,this._series,this._model,e)}_createViews(){var e,t,i,s;this._priceAxisViewsBase=[],this._priceLinesAxisViews=[],this._paneViews=[],this._labelPaneViews=[];const r=new Set,n=this.metaInfo(),a=Boolean(n.usePlotsZOrder),l=new Map,u=this._properties.childs();if(u.filledAreasStyle&&n.filledAreas)for(let e=0;e<n.filledAreas.length;++e){const t=n.filledAreas[e],i=(0,o.ensureDefined)(u.filledAreasStyle.childs()[t.id]),s=Be(n,t.id);let r;if("plot_plot"===t.type||s?r=new re.PlotFillPaneView(this,this.model(),t,i):"hline_hline"===t.type?r=new le.HlineFillPaneView(this,t,i):xe.logWarn("Unsupported filledArea type: "+t.type),void 0!==r){const e=a?(0,o.ensureDefined)(t.zorder):l.size;ke(e,l),l.set(e,{paneViews:[r]})}}{let s=-1e5;for(let u=0;u<n.plots.length;u++){const d=n.plots[u];let c,h,p,_,m;if((0,H.isNonVisualPlot)(d))continue;let f=d.id,v=n.styles;const y=(0,H.isBgColorerPlot)(d);if(y)c=new K.StudyBackgroundPaneView(this,this._series,this._model,f);else if((0,H.isShapesPlot)(d))c=new $.StudyPlotShapesPaneView(this,this._series,this._model,f);else if((0,H.isCharsPlot)(d))c=new q.StudyPlotCharsPaneView(this,this._series,this._model,f);else if((0,H.isArrowsPlot)(d))c=new Z.StudyPlotArrowsPaneView(this,this._series,this._model,f);else if((0,H.isOhlcPlot)(d)){const e=d.target;if(r.has(e))continue;if(r.add(e),Oe(n,u))c=new J.StudyPlotBarsPaneView(this,this._series,this._model,e);else{if(!De(n,u)){xe.logError(`plot ${d.id} looks to be invalid`);continue}c=new Q.StudyPlotCandlesPaneView(this,this._series,this._model,e)}_=this.createPriceAxisView(e),p=new ee.PanePriceAxisView(_,this,this._model),f=e,v=n.ohlcPlots}else(0,H.isDataPlot)(d)||(_=this.createPriceAxisView(f),m=this.createPriceLineAxisView(f),c=this._createStudyPlotPaneView(f),(null===(t=null===(e=this._properties.childs().styles.childs()[f])||void 0===e?void 0:e.child("trackPrice"))||void 0===t?void 0:t.value())&&(h=new ie.StudyTrackPricePaneView(this,f)),p=new ee.PanePriceAxisView(_,this,this._model));const g=a?y?s++:(0,o.ensureDefined)(null===(i=null==v?void 0:v[f])||void 0===i?void 0:i.zorder):l.size;ke(g,l);const S={paneViews:void 0!==c?[c]:[],labelView:p,priceAxisView:_,priceLineAxisView:m};void 0!==h&&S.paneViews.push(h),l.set(g,S)}}(null!==(s=this._metaInfo.bands)&&void 0!==s?s:[]).forEach(((e,t)=>{const i=u.bands.childs()[t];if(i&&i.childs().visible.value()){const t=new oe.BandPaneView(i,this),s=a?(0,o.ensureDefined)(e.zorder):l.size;ke(s,l),l.set(s,{paneViews:[t]})}})),u.bandsBackground&&((0,o.assert)(!a,"'usePlotsZOrder' flag does not supported"),l.set(l.size,{paneViews:[new ae.BandBackgroundPaneView(this)]}));const d=this._paneViews;this._createGraphicsPaneViews().then((e=>{for(let t=0;t<e.length;t++)d.push(e[t]);this._model.lightUpdate(),this._graphicsViewsReady=!0})),u.areaBackground&&((0,o.assert)(!a,"'usePlotsZOrder' flag does not supported"),
l.set(l.size,{paneViews:[new se.AreaBackgroundPaneView(this,this.model())]}));const c=Array.from(l.keys()).sort(((e,t)=>e-t));for(let e=0;e<c.length;e++){const t=(0,o.ensureDefined)(l.get(c[e]));this._paneViews.push(...t.paneViews),t.labelView&&this._labelPaneViews.push(t.labelView),t.priceAxisView&&this._priceAxisViewsBase.push(t.priceAxisView),t.priceLineAxisView&&this._priceLinesAxisViews.push(t.priceLineAxisView)}this._dataWindowView||(this._dataWindowView=new ne.StudyDataWindowView(this,this._model)),this._legendView||(this._legendView=new V.StudyLegendView(this,this._model)),this._statusView||(this._statusView=new N.StudyStatusView(this)),this._concatPriceAxisViews()}_concatPriceAxisViews(){this._priceAxisViews=[...this._priceAxisViewsBase,...this._graphicsPriceAxisViews]}onData(e){switch(e.method){case"study_loading":this._onStudyLoading();break;case"study_error":this._onStudyError(e.params[2]);break;case"study_completed":if(!this._checkTurnaround(e.params[1]))return;this._onStudyCompleted(e.params[e.params.length-1]);break;case"data_update":if(e.params.customId!==this.sourceId()||!this._checkTurnaround(e.params.turnaround))return;(0,o.assert)(!!e.params.nonseries,"data.params.nonseries is missing"),this._onDataUpdate(e.params.plots,(0,o.ensureDefined)(e.params.nonseries),e.params.lastBar);break;case"clear_data":this._checkTurnaround(e.params.turnaround)&&this.clearData()}}_onStudyLoading(){var e;this._setStatus({type:ue.StudyStatusType.Loading,startTime:Date.now()}),null===(e=this._statusView)||void 0===e||e.update(),this._model.updateSource(this)}_getTelemetryObjectName(){return"study"}_handleStudyError(e){var t,i,s;this.clearData(),this._setStatus(e);{const s=(0,ue.convertStudyStatusToString)(e),r=this._getTelemetryAdditionalData(),n=s.indexOf("Command info");r.reason=n>=0?s.slice(0,n).trim():s;if(!/study in error state|the data vendor doesn\'t provide volume data for this symbol.|error in series|unsupported resolution/gi.test(null!==(i=null===(t=r.reason)||void 0===t?void 0:t.toLowerCase())&&void 0!==i?i:"")){const e=this._getTelemetryObjectName();this._sendTelemetryCounter(e+"_error",r)}}null===(s=this._statusView)||void 0===s||s.update(),this._model.updateSource(this)}_onStudyError(e){this._handleStudyError(this._createStudyError(e)),this._enablePriceRangeReady()}_createStudyError(e){var t;return qe("string"==typeof e?{error:this._getStudyErrorText(e)}:e,null===(t=this.symbolSource().symbolInfo())||void 0===t?void 0:t.exchange)}_onStudyCompleted(e){var t;this._studyModified&&(this.clearData(),this._studyModified=!1),this._sendTelemetryCounter(this._getTelemetryObjectName()+"_loaded"),this._setStatus({type:ue.StudyStatusType.Completed}),null===(t=this._statusView)||void 0===t||t.update();const i=this._model.paneForSource(this);this._model.recalculatePane(i,(0,he.sourceChangeEvent)(this.id())),this._updateSources();const s=ce.InvalidationMask.full();null!==this._model.appliedTimeFrame().value()&&s.lockVisibleTimeRangeOnResize(),this._model.invalidate(s)}_onDataUpdated(e,t,i,s){
if(this.hasBarColorer()&&e.length>0){const t=(0,o.ensureNotNull)(this.barColorer()).firstColoredBar(e[0].index);this._model.mainSeries().invalidateBarStylesCache(t)}null!==t&&this._postProcessGraphics();const r=this._model.paneForSource(this);this._model.recalculatePane(r,(0,he.sourceChangeEvent)({sourceId:this.id(),firstUpdatedTimePointIndex:null!=s?s:void 0})),this._updateSources()}_updateSources(){this._model.updateSource(this),this.hasBarColorer()&&this._model.updateSource(this._model.mainSeries())}_titleInputs(e,t,i){return this.inputs(this._titleInputsOptions(e,t,i))}_titleInputsOptions(e,t,i){return{symbolsForDisplay:!0,skipHiddenInputs:!0,skipFakeInputs:!1,fakeInputsForDisplay:!0,asObject:!0,skippedGroups:[],noExchanges:t,noResolution:i,priceInputsForDisplay:!0,skipOptionalEmptySymbolInputs:Ne,displayMask:e}}_postProcessGraphics(){this._graphicsPriceAxisViews=this._createGraphicsPriceAxisViews(),this._concatPriceAxisViews()}async _createGraphicsPaneViews(){return(0,E.createGraphicsPaneViews)(this,this.model())}_createGraphicsPriceAxisViews(){return(0,E.createGraphicsPriceAxisViews)(this)}_subscribeToSessionId(){!this._isSubscribedToSessionId&&this.hasSymbolInputs()&&(this.sessionIdChanged().subscribe(this,this._onSessionIdChanged),this._isSubscribedToSessionId=!0)}_unsubscribeToSessionId(){this._isSubscribedToSessionId&&(this.sessionIdChanged().unsubscribe(this,this._onSessionIdChanged),this._isSubscribedToSessionId=!1)}_onSessionIdChanged(){this.restart(!0)}_recreateFormatter(){this._formatter=this._tryCreateFormatter(),this._formatterChanged.fire();const e=this.priceScale();null!==e&&e.updateFormatter(),this._model.fullUpdate()}_recreatePriceStep(){var e;let t=null;const i=null!==(e=this._priceScaleByProperties())&&void 0!==e?e:this._priceScaleByMetaInfo();null!==i&&(t=1/i),this._priceStep!==t&&(this._priceStep=t,this._priceStepChanged.fire())}_recreatePriceFormattingDependencies(){this._recreateFormatter(),this._recreatePriceStep()}_title(e,t,i,s,r){const n=this._titleInParts(e,t,i,s,r);return this._joinTitlesParts(n)}_formatterByProperties(){const e=this.metaInfo().format,t=this._priceScaleByProperties();if(null!==t)switch(e.type){case"inherit":case"price":return new Ce.PriceFormatter(t);case"volume":return new Ae.VolumeFormatter(Math.log10(t));case"percent":return new Ee.PercentageFormatter(t)}return null}_formatterByMetaInfo(){const e=this.metaInfo().format;if("inherit"===e.type)return null;const t=this.series().symbolInfo(),i=(0,F.isNumber)(e.precision)?Math.pow(10,e.precision):void 0;switch(e.type){case"price":return new Ce.PriceFormatter(i);case"volume":{let i=e.precision;return void 0===i&&(i=t&&(0,F.isNumber)(t.volume_precision)?t.volume_precision:0),new Ae.VolumeFormatter(i)}case"percent":return new Ee.PercentageFormatter(i);default:return xe.logWarn(`Unsupported format type: ${e.type}`),null}}_postProcessPriceRange(e){if(e&&e.minValue()===e.maxValue()&&!this.metaInfo().is_price_study){const t=.005*e.minValue();e=new T.PriceRange(e.minValue()-t,e.maxValue()+t)}const t=this.priceScale()
;return t&&t.isLog()&&e?new T.PriceRange(t.priceToLogical(e.minValue()),t.priceToLogical(e.maxValue())):e}_joinTitlesParts(e){const t=e[1]?e[1].join(", "):"";return e[0]+(t.length>0?" ("+t+")":"")}_titleInParts(e,t,s,r,n){var l;const u=this.name(t);s=s||{};const d=[a.t(u,{context:"study"},i(168716))];let c=[];if(!r){const i=this._getMTFResolutionInputTitle();null!==i&&i.length>0&&d.push(i);const r=this.metaInfo(),a=this._titleInputs(e,n,!0),u=r.inputs.filter((e=>a.hasOwnProperty(e.id))).map((e=>({meta:e,value:a[e.id]})));if(u.length>0){const i={};if(this.isChildStudy())for(let s=0;s<r.inputs.length;++s){const a=r.inputs[s];if(!A.StudyMetaInfo.isSourceInput(a))continue;const u=a.id,d=(0,o.ensureDefined)(this._properties.childs().inputs.child(u)).value();if(d.indexOf("$")>=0){const s=this.parentSourceForInput(d);if(s instanceof Ze){const r=s.metaInfo(),o=s.title(e,t,{},!0,n);if(1===r.plots.length)i[d]=o;else{const e=d.split("$")[1],t=null===(l=r.plots[parseInt(e)])||void 0===l?void 0:l.id,s=r.styles&&r.styles[t],n=s&&s.title||t;i[d]=o+": "+n}}}}c=u.map((({meta:e,value:t})=>{if("time"===e.type)return new Date(t).toISOString();let r=(0,F.isNumber)(t)?this._numericFormatter.format(t):i&&i[t.toString()]||t.toString();return s&&s[r.toString()]&&(r=s[r.toString()]),r}))}}return[d.join(" · "),c]}_getMTFResolutionInputTitle(){const e=this.metaInfo();for(let t=0;t<e.inputs.length;t++){const i=e.inputs[t];if("resolution"===i.type&&i.isMTFResolution)return(0,o.ensureDefined)(this._properties.childs().inputs.child(i.id)).value()}return null}_seriesDataRangeToSave(e){return this._model.timeScale().visibleExtendedDataRange(e,0)}_onDataUpdate(e,t,i){this._studyModified&&(this.clearData(),this._studyModified=!1);const s=(0,I.unpackNonSeriesData)(t.d);return this._ongoingDataUpdate=this._ongoingDataUpdate.then((()=>s),(()=>s)).then(this._onDataUnpacked.bind(this,e,t.indexes,i)),this._ongoingDataUpdate}_mergeData(e){return this._invalidateLastNonEmptyPlotRowCache(),this.data().merge(e)}_getSymbolForResolve(e){return this.getSymbolString(this._getSymbolForApi(e))}_allSymbolsAreResolved(){const e=this._inputSymbols(),t=[];let i=!1;for(const s of e){const e=this._getSymbolForResolve(s);if(""!==e)if(this._resolvedSymbols[e])i=!0;else{const i=this._resolveSymbol(e,s);t.push(i)}}if(0===t.length){const e=Promise.resolve();return i?e.then((()=>this._symbolsResolved.fire())):e}return Promise.all(t).catch((e=>{this._setStatus({type:ue.StudyStatusType.Error,errorDescription:{error:Le}});return this._inputSymbols().includes(e)&&this.stop(!0),this._model.updateSource(this),Promise.reject("Invalid symbol, "+e)})).then((()=>{this._symbolsResolved.fire(),this._recheckLineToolsActuality()}))}_getSymbolForApi(e){return e}_resolveSymbol(e,t){if(""===e)return Promise.resolve();let i=this._pendingResolveSymbols.get(e);return void 0!==i||(i=new Promise(((i,s)=>{this._onSymbolResolvingStart(),this._chartApi.resolveSymbol((0,D.makeNextSymbolId)(),e,(r=>{switch(this._pendingResolveSymbols.delete(e),r.method){case"symbol_resolved":this._setStatus({
type:ue.StudyStatusType.Undefined}),this._resolvedSymbols[e]=r.params[1],this._resolvedSymbolsByInput[t]=r.params[1],this._onSymbolResolved(e,t,r.params[1]),this.invalidateTitleCache(!0),i();break;case"symbol_error":if(this._setStatus({type:ue.StudyStatusType.Error,errorDescription:{error:r.params[1]}}),this._onSymbolError(),r.params[1]===k.permissionDenied&&r.params[2]){if(r.params[2]!==k.SymbolErrorPermissionDeniedReason.Symbol)return void this._resolveSymbol(r.params[2],t).then(i);if(r.params[3])return void this._resolveSymbol(r.params[3],t).then(i)}this._sendTelemetryCounter("symbol_error",Object.assign(this._getTelemetryAdditionalData(),{symbol:e,reason:r.params[1]})),s(t)}}))})),this._pendingResolveSymbols.set(e,i)),i}_recheckLineToolsActuality(){const e=this._model.paneForSource(this);null!==e&&e.sourcesByGroup().lineSourcesForAllSymbols().forEach((e=>{e.ownerSource()===this&&e.calcIsActualSymbol()}))}_getSymbolObject(e){const t={symbol:e},i=this.currency();return null!==this._currencySourceSymbolInputProperty&&null!==this._currencySourceSymbolInfo&&this._getSymbolForApi(this._currencySourceSymbolInputProperty.value())===e&&(t["currency-id"]=i),t.session=this.sessionId(),t}_onSymbolResolved(e,t,i){{const e=(0,o.ensureNotNull)(this._model.alertsWatcher());e.syncSourceAlertLabels(this);const t=this.getAllChildren();for(const i of t)e.syncSourceAlertLabels(i)}this._onCurrencyMayChange()}_onSymbolResolvingStart(){}_onSymbolError(){}_setStatus(e,t){var i;this._status=e,e.type===ue.StudyStatusType.Completed?this._wasCompletedBefore=!0:e.type!==ue.StudyStatusType.Error&&e.type!==ue.StudyStatusType.Undefined||(this._wasCompletedBefore=!1),t||(null===(i=this._statusView)||void 0===i||i.update(),this._model.updateSource(this),this._statusChanged.fire(e))}_onPropertiesChanged(){this._restarting||(this._inputs?this._tryChangeInputs():this._chartApi&&this._chartApi.isConnected().value()&&this.restart()),this._metaInfo.isTVScript&&this._metaInfo.TVScriptMetaInfoExprs&&(this._pinePatchPropsAllowed()?this._pinePatchProps():this._deferredPinePatchProps=!0),this._recreatePaneViews(),(0,ye.emit)("study_properties_changed",this._id)}_bandsFirstValue(e){const t=this._metaInfo;if(!t.bands)return null;for(let i=0;i<t.bands.length;i++){const t=(0,o.ensureDefined)(this._properties.childs().bands).childs()[i];if(t.childs().visible.value()){const i=t.childs().value.value();if(e&&0===i)continue;return i}}return null}_prepareInputs(e){(0,o.assert)(!!e,"options not set");const t=this.metaInfo(),i={},s=e.allowedInputTypes?new Set(e.allowedInputTypes):null;for(let r=0;r<t.inputs.length;r++){const n=t.inputs[r];if(null!==s&&!s.has(n.type))continue;if(n.isFake&&e.skipFakeInputs)continue;if(n.isMTFResolution&&e.noResolution)continue;if(void 0!==e.displayMask&&!((0,o.ensureDefined)(n.display)&e.displayMask))continue;if(e.skipHiddenInputs&&(!e.doNotSkipHiddenWithMigrate||!n.migrate)){let t=!1;switch(n.type){case"bool":t=e.skipBooleanInputs;break;case"color":t=e.skipColorInputs;break;case"time":t=e.skipTimeInputs;break;case"text_area":
t=e.skipTextareaInputs;break;default:t=Boolean(n.isHidden)}if(t)continue}if(void 0!==n.groupId&&-1!==e.skippedGroups.indexOf(n.groupId))continue;if(-1!==e.skippedInputs.indexOf(n.id))continue;const a=this._prepareInput(n,e);"symbol"===n.type&&e.skipOptionalEmptySymbolInputs&&""===a||(i[n.id]=(0,F.clone)(a))}return i}_getAllOwnerSources(){return $e(this).reverse().slice(1)}_getStudyIdWithLatestVersion(){return A.StudyMetaInfo.getStudyIdWithLatestVersion(this.metaInfo())}_lastNonEmptyPlotRow(e){var t;if(!(0,F.isInteger)(e))return xe.logDebug("_lastNonEmptyPlotRow: incorrect plotIndex"),null;let i=null!==(t=this._lastNonEmptyPlotRowCache[e])&&void 0!==t?t:null;if(null!==i)return i;return i=this.data().findLast(((t,i)=>void 0!==i[e]),1e3),null===i?null:(this._lastNonEmptyPlotRowCache[e]=i,i)}_onCurrencyChanged(){"alwaysOff"!==(0,_e.currencyUnitVisibilityProperty)().value()&&this._model.fullUpdate(),this.isStarted()&&this._tryChangeInputs(),this._currencyChanged.fire()}_apiInputs(){return this.inputs({keepOptionalSymbolsEmpty:!0})}async _tryChangeInputs(){const e=this.isStarted()&&this._chartApi.isConnected().value(),t=this._allInputsAreValid(),i=(0,o.ensureDefined)((0,F.clone)(this._inputs)),s=this._apiInputs(),r=JSON.stringify(s),n=r!==JSON.stringify(this._inputs);if(e&&t)try{if(await this._allSymbolsAreResolved(),r!==JSON.stringify(this._apiInputs()))return this._tryChangeInputs();if(this._isStopped())return void(n&&this.disablePriceRangeReady());n&&(await this._changeInputsImpl(s,(0,o.ensureDefined)((0,F.clone)(this._inputs))),(0,o.ensureNotNull)(this.model().alertsWatcher()).syncSourceAlertLabels(this))}catch(e){xe.logError(`ERROR: ${this._debugId()} _tryChangeInputs: cannot modify study, ${e}`)}else if(e&&!t&&this.stop(!0),!e&&t&&this.start(!0),n){const e=this._calcSources();{const t=Ke(this._metaInfo,s,i);this._updateParentSources(e,t,!0)}this._inputs=s}this._tagsChanged.fire()}_debugId(){const e=[];return this._studyId&&e.push(this._studyId),e.push(this._metaInfo.fullId),e.push(this._metaInfo.description),JSON.stringify({study:e})}_onCurrencyMayChange(){if(null!==this._currencySourceSymbolInputProperty){const e=this.currency();this._updateCurrencySourceSymbolInfo(),e!==this.currency()&&this._onCurrencyChanged()}}_fillPrecalculatedAutoscaleInfo(e,t){const i=this._metaInfo,s=this.properties().childs(),r=new Set,n=this._metaInfo.filledAreas||[];for(let e=0;e<n.length;e++){const t=n[e];s.filledAreasStyle.childs()[t.id].childs().visible.value()&&(r.add(t.objAId),r.add(t.objBId))}return i.plots.filter((e=>!(0,H.isPlotWithTechnicalValues)(e))).filter((e=>r.has(e.id)||this.isPlotVisibleAt(e.id,1))).reduce(((i,s)=>this._applyPlotToPrecalculatedAutoscaleInfo(e,t,i,s)),{fields:[],useMainSeriesRange:!1,baseValueMinMax:null})}_firstSourceOrSeries(){var e;return null!==(e=this._sources[0])&&void 0!==e?e:this._series}_skipHistogramBaseOnAutoScale(){return!1}_tryCreateFormatter(){let e=this._formatterByProperties();return null===e&&(e=this._formatterByMetaInfo()),e}_hasAvailableAlertPlots(){
if(null===this._alertMetaInfo())return!1;const e=this.stateForAlert(),t=h.alertBandFactory.create(e).getPlots();return null!=t&&t.length>0}_hasAlertConditions(){const e=this._alertMetaInfo();if(null===e)return!1;if(e.plots.some(H.isAlertConditionPlot))return!0;const t=this.stateForAlert();return Boolean(t.alerts&&t.alerts.conditions)}_hasAlertFunction(){const e=this._alertMetaInfo();return Boolean(null!==e&&e.hasAlertFunction)}async _updateParentSources(e,t,i){if(this._sources.forEach((e=>e.unsetChild(this))),i&&await Promise.all(e.map((e=>e.isStarted()?Promise.resolve():e.start(!1,!0)))),e.forEach((e=>e.setChild(this))),this._sources=e,0!==t&&this._sources.length<=1){const e=this._firstSourceOrSeries(),t=this._priceScale,i=(0,o.ensureNotNull)(e.priceScale());if(t!==i){const t=this._model.paneForSource(this),s=(0,o.ensureNotNull)(this._model.paneForSource(e));t===s&&s.move(this,i,!0)}}}_calcSources(){const e=this._properties.childs().inputs.state();return A.StudyMetaInfo.getSourceIdsByInputs(this._metaInfo.inputs,e).map((e=>{if("high"===e||"open"===e||"low"===e||"close"===e||"hl2"===e||"ohl3"===e||"ohlc4"===e)return null;{const t=this._model.allStudies().find((t=>t.canHaveChildren()&&t.id()===e));return null!=t?t:null}})).filter(F.notNull)}_isStopped(){return!this.isStarted()}_onDataUnpacked(e,t,i,s){if(this._isDestroyed)return;"nochange"!==t&&this._processPlotOffsets(s),this._transformData(e);const r=this._mergeData(e);null!==s&&(s.indexes_replace?((0,o.assert)("nochange"!==t),this._graphics.replaceIndexesTo(t)):("nochange"!==t&&this._graphics.replaceIndexesTo(t),void 0!==s.graphicsCmds&&this._graphics.processCommands(s.graphicsCmds))),this._onDataUpdated(e,s,t,r&&r.index),this.priceRangeReady()||this._enablePriceRangeReady(),this._dataUpdated.fire(i,!1,r)}_processPlotOffsets(e){if(e&&e.indexes_replace)return;const t=this._plotOffsets;this._plotOffsets=e&&e.offsets||{},(0,s.default)(t,this._plotOffsets)||this.updateAllViews((0,he.sourceChangeEvent)({sourceId:this.id(),clearData:!0})),this._updateMaxOffsetValue()}_applyPlotToPrecalculatedAutoscaleInfo(e,t,i,s){var r,n,a;const l=s.id,u=this._properties.childs().styles.childs()[l],d=(0,H.isShapesPlot)(s)||(0,H.isCharsPlot)(s);i.useMainSeriesRange=i.useMainSeriesRange||(0,H.isArrowsPlot)(s);let c=(0,H.isLinePlot)(s)||(0,H.isOhlcPlot)(s);if(d){const e=(0,o.ensureDefined)(u).childs().location.value(),t=[L.MarkLocation.Absolute,L.MarkLocation.Top,L.MarkLocation.Bottom].indexOf(e)<0;i.useMainSeriesRange=i.useMainSeriesRange||d&&t,c=c||e===L.MarkLocation.Absolute}if(!c)return i;const h={name:l,offset:this.offset(l)},p=u.childs().plottype.value();if(!this._skipHistogramBaseOnAutoScale()&&[H.LineStudyPlotStyle.Histogram,H.LineStudyPlotStyle.Columns,H.LineStudyPlotStyle.Area].indexOf(p)>=0){const s=null===(a=null===(n=null!==(r=this._metaInfo.styles)&&void 0!==r?r:{})||void 0===n?void 0:n[l])||void 0===a?void 0:a.histogramBase;if(void 0===s)return i;const o=this.data().minMaxOnRangeCached(e,t,[h]);return(0,F.isNumber)(s)&&null!==o&&(i.baseValueMinMax=(0,
C.mergeMinMax)(i.baseValueMinMax,{min:s,max:s}),i.baseValueMinMax=(0,C.mergeMinMax)(i.baseValueMinMax,o)),i}return i.fields.push(h),i}async _onSourceInputChanged(){if(!this.isStarted()){const e=this._calcSources();{const t=1===e.length&&e[0]!==this._sources[0]?1:0;this._updateParentSources(e,t,!1)}}}async _rebindToSourceOrRestorePreviousValue(e,t,i){let s=!0;if(!await this._rebindToSource(e,t)){const e=this._properties.childs().inputs.state(),r=A.StudyMetaInfo.getSourceIdsByInputs(this._metaInfo.inputs,e)[0];for(const e of Object.keys(i)){const n=(0,Y.getInputValue)(i[e]),a=(0,Y.getInputValue)(t[e]);if(i.hasOwnProperty(e)&&n!==a&&r&&(0,F.isString)(a)&&0===a.indexOf(r)){const t=(0,o.ensureDefined)(this._properties.childs().inputs.child(e)),r=(0,Y.getInputValue)(i[e]);t.setValue(r),s=!1;break}}}return s}async _rebindToSource(e,t){const s=this.isStarted()&&this._chartApi.isConnected().value();s&&e instanceof Ze&&!e.isStarted()&&await e.start(!1,!0);const r=this._firstSourceOrSeries();let n;const l=(0,F.clone)((0,o.ensureDefined)(t)),u=e instanceof Ze?[e,...this._sources]:this._sources;if(s&&A.StudyMetaInfo.patchSoSInputs(l,(e=>{var t,i;return null!==(i=null===(t=u.find((t=>t.id()===e)))||void 0===t?void 0:t.sourceId())&&void 0!==i?i:null})),this.isChildStudy()){let t;this._sources[0].unsetChild(this);let i=null;if(e===this._model.mainSeries())this._sources=[],this._ownerSource=null,t=this._series.seriesSource().instanceId(),i=2;else{if(!(e instanceof Ze))return xe.logError("Unable to rebind study to source of this type"),!1;this._ownerSource=e,this._sources=[e],t=e.sourceId(),e.setChild(this),null===t&&(n=e)}s&&null!==t&&(this._incrementTurnaround(),this.disablePriceRangeReady(),this._chartApi.rebindStudy((0,o.ensureNotNull)(this._studyId),this._turnaround,t,this._studyName,l,this._handler,i))}else{if(!(e instanceof Ze))return xe.logError("Unable to rebind study to source of this type"),!1;if(s){if(!this._chartApi.canCreateStudy(!0)){const e=window.user.pro_plan;return(0,v.createGoProDialog)({feature:"studyOnStudy",actions:e&&[g.ExpertPlans.PremiumExpert,g.ExpertPlans.PremiumExpert+S.TRIAL_SUFFIX].includes(e)?[{text:a.t(null,void 0,i(875139)),action:y.PredefinedAction.Close}]:void 0}),!1}const t=e.sourceId();if(null!==t){this._incrementTurnaround(),this.disablePriceRangeReady();const e=this._chartApi.rebindStudy((0,o.ensureNotNull)(this._studyId),this._turnaround,t,this._studyName,l,this._handler,1);(0,o.assert)(e)}else n=e}this._ownerSource=e,this._sources=[e],e.setChild(this),this._childStudyByRebind.fire()}n&&(this.isStarted()&&this.stop(),n.start(!0)),r instanceof Ze&&r.processHibernate();const d=this._priceScale,c=(0,o.ensureNotNull)(e.priceScale());if(d!==c){const t=this._model.paneForSource(this),i=(0,o.ensureNotNull)(this._model.paneForSource(e));t===i&&i.move(this,c,!0)}const h=this._firstSourceOrSeries();return r.formatterChanged().unsubscribe(this,this._onSourceFormatterChanged),h.formatterChanged().subscribe(this,this._onSourceFormatterChanged),
r.priceStepChanged().unsubscribe(this,this._onSourcePriceStepChanged),h.priceStepChanged().subscribe(this,this._onSourcePriceStepChanged),r.currencyChanged().unsubscribeAll(this),h.currencyChanged().subscribe(this,this._onSourceCurrencyChanged),r.unitChanged().unsubscribeAll(this),h.unitChanged().subscribe(this,this._onSourceUnitChanged),r.priceRangeReadyChanged().unsubscribeAll(this),h.priceRangeReadyChanged().subscribe(this,this._onSourcePriceRangeReadyChanged),this._recreatePriceFormattingDependencies(),!0}_buildInputs(e){(0,o.assert)(!!e,"options not set");let t={};try{t=this._prepareInputs(e)}catch(e){xe.logWarn("Failed to prepare study inputs: "+e)}if(e.asObject){const e={};return Object.keys(t).forEach((i=>{null!=t[i]&&(e[i]=t[i])})),e}{const e=[];return Object.keys(t).forEach((i=>{null!=t[i]&&e.push(t[i])})),e}}_prepareInput(e,t){const i=this._prepareInputValue(e,t);return!e.isFake||t.fakeInputsForDisplay||t.onlyAtomValues?i:{v:i,f:!0,t:e.type}}_plotsForAlert(){return(0,m.plotsForAlert)(this.metaInfo(),this.offset.bind(this))}_dependenciesForAlerts(){const e=this._getAllOwnerSources().filter((e=>e instanceof Ze));return(0,m.dependenciesForAlerts)(e,this._model.studyMetaInfoRepository())}_calcIsActualInterval(){const e=this._isActualInterval;this._isActualInterval=(0,de.isActualInterval)(this._series.intervalObj(),this._properties.childs().intervalsVisibilities),e!==this._isActualInterval&&(this._onIsActualIntervalChange.fire(),this._visibleChanged(),this.processHibernate())}_visibleChanged(){this._series.invalidateBarColorerCache()}_getNonPriceParent(){const e=this._sources;for(const t of e)if(t instanceof Ze){const e=t.metaInfo();return e.is_price_study&&"Compare@tv-basicstudies"!==e.id?t._getNonPriceParent():t}return null}_updateInputValue(e,t){const i=this._properties.childs().inputs.childs();if(i[t.id])if("price"===t.type)i[t.id].setValue(e.price);else if("time"===t.type){const s=this._model.timeScale().indexToTimePoint(e.index);null!==s&&i[t.id].setValue(1e3*s)}}_initializeStudyInputsPaneViews(){const e=(0,Y.editableStudyInputs)(this._metaInfo.inputs);if(0===e.length)return;const t={convertPriceToCoordinate:e=>{const t=this.priceScale();if(null!==t&&!t.isEmpty()){const i=this.firstValue();if(null!==i)return t.priceToCoordinate(e,i)}return null},formatPrice:e=>{const t=this.priceScale();if(null!==t&&!t.isEmpty()){const i=this.firstValue();if(null!==i)return t.formatPrice(e,i)}return""},getInputValue:e=>{var t,i;return null!==(i=null===(t=this._properties.childs().inputs.child(e))||void 0===t?void 0:t.value())&&void 0!==i?i:null},isSelected:()=>this._model.selection().isSelected(this),isHovered:()=>this===this._model.hoveredSource()};Promise.all([i.e(62183).then(i.bind(i,781929)),i.e(62183).then(i.bind(i,141361)),i.e(62183).then(i.bind(i,286125)),i.e(62183).then(i.bind(i,180861))]).then((i=>{const[s,r,n,o]=i;this._inputsAnchorsPaneView=new s.StudyInputsAnchorsPaneView(e,this._model,t);const a=e.filter((e=>!Array.isArray(e)));this._inputsLinesPaneView=new r.StudyInputsLinesPaneView(a,this._model,t);let l=!1
;e.forEach((e=>{if(Array.isArray(e)){const i="time"===e[0].type?e[0]:e[1],s="price"===e[0].type?e[0]:e[1];this._inputsTimeAxisPaneViews.push(new n.StudyInputTimeAxisPaneView(i,this._model,t.getInputValue)),this._inputsPriceAxisPaneViews.push(new o.StudyInputPriceAxisPaneView(s,t)),l=!0}else"time"===e.type?this._inputsTimeAxisPaneViews.push(new n.StudyInputTimeAxisPaneView(e,this._model,t.getInputValue)):(this._inputsPriceAxisPaneViews.push(new o.StudyInputPriceAxisPaneView(e,t)),l=!0)})),l&&this.formatterChanged().subscribe(this,this.invalidateTitleCache)}))}_updateCurrencySourceSymbolInfo(){}_initializeCurrencySource(){var e,t;const i=this.metaInfo(),s="symbolInputSymbolSource"===(null===(e=i.symbolSource)||void 0===e?void 0:e.type)&&(null===(t=i.symbolSource)||void 0===t?void 0:t.inputId),r=i.inputs.find((e=>e.id===s)),n="symbol"===(null==r?void 0:r.type);if("string"==typeof s&&n&&i.is_price_study){const e=this._properties.childs().inputs.childs()[s];void 0!==e&&(e.subscribe(this,this._onCurrencyMayChange),this._currencySourceSymbolInputProperty=e)}}_recreatePaneViews(){this.hasBarColorer()&&this._model.mainSeries().invalidateBarStylesCache(),this._createViews(),this.recalculate(),this.updateAllViews((0,he.sourceChangeEvent)(this.id()))}_pinePatchPropsAllowed(){return(this.isStarted()||this._metaInfo.inputs.some((e=>"symbol"===e.type)))&&!this._restarting}_pinePatchProps(){this._deferredPinePatchProps=!1;const e=this._prepareInputs({fakeInputsForDisplay:!1,symbolsForDisplay:!1,symbolsForChartApi:!0,skipHiddenInputs:!0,doNotSkipHiddenWithMigrate:!1,skipFakeInputs:!1,onlyAtomValues:!0,skipBooleanInputs:!1,skipColorInputs:!1,skipTimeInputs:!1,skipOptionalEmptySymbolInputs:!1,skippedGroups:[],skippedInputs:[],noExchanges:!1,noResolution:!1,keepOptionalSymbolsEmpty:!1,skipTextareaInputs:!1,priceInputsForDisplay:!1,patchSosInputs:!1});if(!this._areStudyInputsModified(e))return;this._oldStudyInputs=e;const t=(0,f.patchPropertiesAsync)(this._properties,this._metaInfo,e),i=this._allSymbolsAreResolved();Promise.all([t,i]).then((()=>{this._createViews(),this.recalculate(),this.updateAllViews((0,he.sourceChangeEvent)(this.id())),this.invalidateTitleCache()})).catch((e=>{xe.logError(`ERROR: ${this._debugId()} pine inputs patching failed, reason: ${e}`)}))}_areStudyInputsModified(e){if(0===Object.keys(e).length)return!1;if(void 0===this._oldStudyInputs)return!0;const t=Object.keys(this._oldStudyInputs);(0,o.assert)(t.length===Object.keys(e).length,"keys quantity should be equal");for(const i of t)if((0,o.assert)(e.hasOwnProperty(i),`key '${i}' should exist in study inputs`),(0,o.ensureDefined)(this._oldStudyInputs)[i]!==e[i])return!0;return!1}_getStudyErrorText(e){var t;switch(null===(t=e.match(/^study_not_auth:(.*)?@.*/))||void 0===t?void 0:t[1]){case"Script":case"StrategyScript":return"This script is invite-only. To request access, please contact its author.";case"VbPSessions":case"VbPPeriodic":case"VbPVisible":return"Volume Profile indicator available only on our upgraded plans."}return e.split(":",2)[0]}
_priceScaleByProperties(){if("default"===this.properties().childs().precision.value())return null;const e=parseInt(this.properties().childs().precision.value());return isFinite(e)?Math.pow(10,e):null}_priceScaleByMetaInfo(){const e=this.metaInfo().format,t="inherit"!==e.type?e.precision:void 0,i=(0,F.isNumber)(t)?Math.pow(10,t):void 0;if("price"===e.type||"percent"===e.type)return i||100;if("volume"===e.type){if(void 0===e.precision){const e=this.series().symbolInfo();if(null!==e&&(0,F.isNumber)(e.volume_precision))return Math.pow(10,e.volume_precision)}return 1}return"inherit"===e.type||xe.logWarn("Unsupported format type: "+e.type),null}_inputSymbols(){return this.metaInfo().inputs.filter((e=>"symbol"===e.type)).map((e=>(0,o.ensureDefined)(this._properties.childs().inputs.child(e.id)).value()))}}},932167:(e,t,i)=>{"use strict";i.d(t,{StudyPriceAxisView:()=>o});var s=i(650151),r=i(229765),n=i(246733);class o extends r.PriceAxisView{constructor(e,t){super(),this._model=e.model(),this._source=e,this._data=t}_updateRendererData(e,t,i){e.visible=!1,t.visible=!1;const r=this._source.model(),o=this._source.priceScale();if(null===o)return;if(!r.isPriceScaleVisible(o))return;const a=this._source.lastValueData(this._data.plotIndex,!1);if(a.noData)return;const l=r.timeScale().visibleBarsStrictRange(),u=r.mainSeries().bars().lastIndex();if(null!==l&&null!==u){if(u<=l.lastBar()){i.background=(0,n.resetTransparency)(a.color);let s=a.color;"transparent"===s&&(s=this._model.properties().childs().scalesProperties.childs().backgroundColor.value()),i.textColor=this.generateTextColor(s),i.borderColor=void 0,e.borderVisible=!1,t.borderVisible=!1}else{const o=r.backgroundColorAtYPercentFromTop(a.coordinate/(0,s.ensureNotNull)(r.paneForSource(this._source)).height());i.background=o,i.textColor=(0,n.resetTransparency)(a.color),i.borderColor=(0,n.resetTransparency)(i.textColor),e.borderVisible=!0,t.borderVisible=!0}i.coordinate=a.coordinate,i.floatCoordinate=a.floatCoordinate,this._showAxisLabel()&&(e.text=a.text,e.visible=!0),this._updatePaneRendererData(t)}}_showPaneLabel(){const e=this._model.properties().childs().scalesProperties.childs();return(e.showStudyPlotLabels.value()||e.showFundamentalNameLabel.value())&&this._source.properties().childs().showLabelsOnPriceScale.value()&&this._source.isPlotVisibleAt(this._data.plotIndex,4)}_showAxisLabel(){const e=this._model.properties().childs().scalesProperties.childs();return(e.showStudyLastValue.value()||e.showFundamentalLastValue.value())&&this._source.properties().childs().showLabelsOnPriceScale.value()&&this._source.isPlotVisibleAt(this._data.plotIndex,4)}_updatePaneRendererData(e){e.text="",this._showPaneLabel()&&(e.text=this._source.priceLabelText(this._data.plotIndex),e.visible=!0)}}},30574:(e,t,i)=>{"use strict";i.d(t,{translateSessionDescription:()=>n,translateSessionExtendedDescription:()=>l,translateSessionShortDescription:()=>a});var s=i(444372);const r=new Map([["Premarket",s.t(null,{context:"sessions"},i(156935))],["Postmarket",s.t(null,{context:"sessions"
},i(798801))],["Regular Trading Hours",s.t(null,{context:"sessions"},i(824380))],["Extended Trading Hours",s.t(null,{context:"sessions"},i(897442))],["Electronic Trading Hours",s.t(null,{context:"sessions"},i(475610))]]);function n(e){var t;return null!==(t=r.get(e))&&void 0!==t?t:e}const o=new Map([["Premarket",s.t(null,{context:"sessions"},i(556137))],["Postmarket",s.t(null,{context:"sessions"},i(332929))],["Regular Trading Hours",s.t(null,{context:"sessions"},i(663798))],["Extended Trading Hours",s.t(null,{context:"sessions"},i(333021))],["Electronic Trading Hours",s.t(null,{context:"sessions"},i(333021))]]);function a(e){var t;return null!==(t=o.get(e))&&void 0!==t?t:e}function l(e){var t;return null!==(t=r.get(e))&&void 0!==t?t:e}},732149:(e,t,i)=>{"use strict";i.d(t,{INVALID_TIME_POINT_INDEX:()=>s,UNPLOTTABLE_TIME_POINT_INDEX:()=>r});const s=-2e6,r=-1e6},949307:(e,t,i)=>{"use strict";i.d(t,{getPriceAlertsDispatcher:()=>r});i(659863);let s=null;function r(){return new Promise((e=>{null===s?Promise.all([i.e(58194),i.e(17447),i.e(43077),i.e(25977),i.e(68647),i.e(75692),i.e(41414),i.e(17022),i.e(86922),i.e(37619),i.e(48158)]).then(i.bind(i,998213)).then((t=>{null===s&&(s=new t.AlertsDispatcher),e(s)})):e(s)}))}},781310:(e,t,i)=>{"use strict";i.d(t,{canPlaceAlertOnResolution:()=>r.canPlaceAlertOnResolution,isAlertResolutionEqual:()=>n});var s=i(223699),r=i(695242);function n(e,t){return e.get("crossInterval")||s.Interval.isEqual(e.get("resolution"),t)}},992854:(e,t,i)=>{"use strict";i.r(t),i.d(t,{getChartSymbolPageUrl:()=>r,maybeRunWithConfirmation:()=>n});var s=i(779923);function r(e,t){const i=new URL("chart",window.location.origin);return i.searchParams.append("symbol",e),t&&i.searchParams.append("interval",t),i.toString()}function n(e,t){return t?new Promise((i=>{(0,s.showConfirm)({...t,onConfirm:({dialogClose:t})=>{const s=e();return s.finally((()=>{t(),i()})),s},onClose:()=>i()})})):e()}},582665:(e,t,i)=>{"use strict";i.r(t),i.d(t,{bulkClearLogConfirmation:()=>m,bulkRemoveConfirmation:()=>h,bulkRemoveInactiveConfirmation:()=>p,bulkRemoveInactiveLabel:()=>u,bulkRemoveLabel:()=>l,bulkRestartConfirmation:()=>c,bulkRestartLabel:()=>a,bulkStopConfirmation:()=>d,bulkStopLabel:()=>o,selectedRemoveConfirmation:()=>_});var s=i(444372),r=i(83691),n=i(937994);const o=e=>e?s.t(null,void 0,i(293786)):s.t(null,void 0,i(507991)),a=e=>e?s.t(null,void 0,i(517520)):s.t(null,void 0,i(377152)),l=e=>e?s.t(null,void 0,i(898098)):s.t(null,void 0,i(168710)),u=()=>s.t(null,void 0,i(508702)),d=e=>e?{title:s.t(null,void 0,i(742692)),text:s.t(null,void 0,i(528183))}:{title:s.t(null,void 0,i(73016)),text:s.t(null,void 0,i(343860))},c=e=>e?{title:s.t(null,void 0,i(733946)),text:s.t(null,void 0,i(548111))}:{title:s.t(null,void 0,i(639901)),text:s.t(null,void 0,i(530147))},h=e=>e?{title:s.t(null,void 0,i(830930)),text:s.t(null,void 0,i(764123))}:{title:s.t(null,void 0,i(879698)),text:s.t(null,void 0,i(597411))},p=()=>({title:s.t(null,void 0,i(447537)),text:s.t(null,void 0,i(669387))}),_=e=>{if(1!==e.length)return{
title:s.t(null,void 0,i(558519)),text:s.t(null,void 0,i(260920))};const t=e[0],o=t.name||t.message||(0,r.getWidgetItemTitle)(t);return{title:s.t(null,void 0,i(588511)),text:s.t(null,void 0,i(974834)).format({alert:(0,n.cutString)(o,100)})}},m=()=>({title:s.t(null,void 0,i(431402)),text:s.t(null,void 0,i(172101))})},526698:(e,t,i)=>{"use strict";i.d(t,{AggregateError:()=>v,ApiError:()=>f,accumulateErrors:()=>n,checkPhoneCode:()=>u,fetchPost:()=>o,firstLoginData:()=>a,firstLoginDataUrl:()=>r,recoverPassword:()=>g,recoverPasswordUrl:()=>y,recoveryPassword:()=>d,resendLink:()=>l,signin:()=>p,signinUrl:()=>c,signup:()=>m,signupUrl:()=>_});var s=i(120780);const r="/accounts/first_login_data/";function n(e,t){return Object.entries(e).map((e=>new f(e[1].join("\n"),t,e[0])))}function o(e,t){return(0,s.fetch)(e,{method:"POST",credentials:"include",mode:"same-origin",body:t})}function a(e){return o(r,e).then((e=>e.ok?e.json():e.json().then((t=>{throw new v(n(t.errors,e.status))}))))}function l(){return o("/api/v1/users/anon/change-email/resend/").then((e=>e.ok?e.json():e.json().then((e=>{throw Error(e.error)}))))}function u(e){return o("/api/v1/recover_password/check_phone_code/",e).then((e=>e.ok?e.json():e.json().then((e=>{throw Error(e.error)}))))}function d(e){return o("/api/v1/recover_password/",e).then((e=>e))}const c="/accounts/signin/";function h(e){return e.json().then((t=>{if("error"in t&&""!==t.error||"code"in t||!e.ok)throw new f(t.error||t.detail,e.status,t.code,t.two_factor_types);return t}))}function p(e){return o(c,e).then(h)}const _="/accounts/signup/";function m(e){return o(_,e).then((e=>e.json().then((t=>{if("errors"in t&&""!==t.errors)throw new v(n(t.errors,e.status))}))))}class f extends Error{constructor(e,t,i,s){super(e),this.type=i,this.status=t,this.secondFactorTypes=s}}class v extends Error{constructor(e){super(e.map((e=>e.message)).join("\n")),this.errors=[],this.errors=e}}const y="/api/v1/recover_password/search/";function g(e){return o(y,e).then(h)}},781666:(e,t,i)=>{"use strict";i.d(t,{isShowPromoVideo:()=>c,isSignModalOpen:()=>d,showSignModal:()=>u});var s=i(586240),r=i(901896),n=i(490778);const o=s["media-mf-tablet-landscape"],a=s["media-mf-tablet-vertical"];let l=()=>!1;async function u(e){const t=Object.assign({},e,{isShowVideo:c()});if(window.TVD&&window.TVD.signIn)return window.TVD.signIn(t);{!function(){const e=window.matchMedia(s["media-mf-tablet-landscape"]).matches?n:r,t=document.createElement("link");t.rel="preload",t.as="image",t.href=e,document.head.appendChild(t)}();const e=await Promise.all([i.e(24975),i.e(22666),i.e(62253),i.e(92108),i.e(9817),i.e(92191),i.e(34465),i.e(69121),i.e(66639),i.e(88194),i.e(76592),i.e(93502),i.e(72639),i.e(32109),i.e(36884),i.e(87845),i.e(6209),i.e(8740),i.e(542),i.e(57285),i.e(7098),i.e(50690),i.e(55325),i.e(40619),i.e(150),i.e(745),i.e(53549),i.e(98277),i.e(36123)]).then(i.bind(i,735894));return l=e.isSignModalOpen,e.showSignModal(t)}}function d(){return l()}function c(){
const e=window.matchMedia(o).matches,t=window.matchMedia(a).matches,i=window.innerWidth,s=window.innerHeight;return!!e||!!t&&!(!e&&s<i)}},290576:(e,t,i)=>{"use strict";i.d(t,{getProPlanDetailsForUser:()=>n});i(822122),i(778016),i(255453);var s=i(120780),r=i(526698);async function n(){const e=await(0,s.fetch)("/pro-plans/profile/"),t=await e.json();if(e.ok)return t;if(403===e.status){const i=t;throw new r.ApiError(i.detail,e.status,i.code)}throw new Error(`Unable to handle unexpected response: ${String(e.text())}`)}},167975:(e,t,i)=>{"use strict";function s(e){return e+"…"}i.d(t,{appendEllipsis:()=>s})},449628:(e,t,i)=>{"use strict";i.d(t,{disable:()=>u,enable:()=>d,pushBackListener:()=>l});var s=i(541558);const r=[];let n=null;function o(e){for(let t=0;t<r.length;t++)if(r[t].name===e)return t;return-1}function a(e){if(!n)for(let t=r.length-1;t>=0&&!0!==r[t].func(e);t--);}function l(e,t){const i={name:e,func:t},s=o(i.name);s>-1&&r.splice(s,1),r.unshift(i)}function u(){return n?null:(n=(0,s.randomHashN)(4),n)}function d(e){if(e!==n)throw Error("Lock id is outdated");n=null}window.addEventListener("keypress",a,!1)}}]);